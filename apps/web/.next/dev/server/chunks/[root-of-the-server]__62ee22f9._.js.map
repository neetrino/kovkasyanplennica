{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/packages/db/client.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nconst globalForPrisma = globalThis as any;\n\n// Ensure UTF-8 encoding for PostgreSQL connection\n// This fixes encoding issues with Armenian and other UTF-8 characters\nconst databaseUrl = process.env.DATABASE_URL || '';\nlet urlWithEncoding = databaseUrl;\n\nif (!databaseUrl.includes('client_encoding')) {\n  urlWithEncoding = databaseUrl.includes('?') \n    ? `${databaseUrl}&client_encoding=UTF8`\n    : `${databaseUrl}?client_encoding=UTF8`;\n  \n  // Temporarily override DATABASE_URL for Prisma Client\n  process.env.DATABASE_URL = urlWithEncoding;\n}\n\nexport const db =\n  globalForPrisma.prisma ??\n  new PrismaClient({ \n    log: process.env.NODE_ENV === \"development\" ? [\"query\", \"error\", \"warn\"] : [\"error\"],\n    errorFormat: \"pretty\",\n  });\n\n// Prisma Client connects automatically on first query (lazy connection)\n// No need to call $connect() explicitly as it can cause issues in Next.js API routes\n// Connection will be established automatically when the first database query is made\n\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = db;\n\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAExB,kDAAkD;AAClD,sEAAsE;AACtE,MAAM,cAAc,QAAQ,GAAG,CAAC,YAAY,IAAI;AAChD,IAAI,kBAAkB;AAEtB,IAAI,CAAC,YAAY,QAAQ,CAAC,oBAAoB;IAC5C,kBAAkB,YAAY,QAAQ,CAAC,OACnC,GAAG,YAAY,qBAAqB,CAAC,GACrC,GAAG,YAAY,qBAAqB,CAAC;IAEzC,sDAAsD;IACtD,QAAQ,GAAG,CAAC,YAAY,GAAG;AAC7B;AAEO,MAAM,KACX,gBAAgB,MAAM,IACtB,IAAI,6IAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;QAAS;KAAO,GAAG;IAC3E,aAAa;AACf;AAEF,wEAAwE;AACxE,qFAAqF;AACrF,qFAAqF;AAErF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/packages/db/index.ts"],"sourcesContent":["export * from \"./client\";\r\n\r\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/api/v1/contact/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { db } from \"@white-shop/db\";\r\n\r\n/**\r\n * POST /api/v1/contact\r\n * Submit contact form\r\n */\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const body = await req.json();\r\n    const { name, email, subject, message } = body;\r\n\r\n    // Validation\r\n    if (!name || typeof name !== 'string' || name.trim().length === 0) {\r\n      return NextResponse.json(\r\n        {\r\n          type: \"https://api.shop.am/problems/validation-error\",\r\n          title: \"Validation Error\",\r\n          status: 400,\r\n          detail: \"Field 'name' is required\",\r\n          instance: req.url,\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (!email || typeof email !== 'string' || email.trim().length === 0) {\r\n      return NextResponse.json(\r\n        {\r\n          type: \"https://api.shop.am/problems/validation-error\",\r\n          title: \"Validation Error\",\r\n          status: 400,\r\n          detail: \"Field 'email' is required\",\r\n          instance: req.url,\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (!subject || typeof subject !== 'string' || subject.trim().length === 0) {\r\n      return NextResponse.json(\r\n        {\r\n          type: \"https://api.shop.am/problems/validation-error\",\r\n          title: \"Validation Error\",\r\n          status: 400,\r\n          detail: \"Field 'subject' is required\",\r\n          instance: req.url,\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    if (!message || typeof message !== 'string' || message.trim().length === 0) {\r\n      return NextResponse.json(\r\n        {\r\n          type: \"https://api.shop.am/problems/validation-error\",\r\n          title: \"Validation Error\",\r\n          status: 400,\r\n          detail: \"Field 'message' is required\",\r\n          instance: req.url,\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Email validation\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(email)) {\r\n      return NextResponse.json(\r\n        {\r\n          type: \"https://api.shop.am/problems/validation-error\",\r\n          title: \"Validation Error\",\r\n          status: 400,\r\n          detail: \"Invalid email format\",\r\n          instance: req.url,\r\n        },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Create contact message\r\n    const contactMessage = await db.contactMessage.create({\r\n      data: {\r\n        name: name.trim(),\r\n        email: email.trim(),\r\n        subject: subject.trim(),\r\n        message: message.trim(),\r\n      },\r\n    });\r\n\r\n    console.log(\"✅ [CONTACT] Message created:\", contactMessage.id);\r\n\r\n    return NextResponse.json(\r\n      {\r\n        data: {\r\n          id: contactMessage.id,\r\n          name: contactMessage.name,\r\n          email: contactMessage.email,\r\n          subject: contactMessage.subject,\r\n          message: contactMessage.message,\r\n          createdAt: contactMessage.createdAt,\r\n        },\r\n      },\r\n      { status: 201 }\r\n    );\r\n  } catch (error: any) {\r\n    console.error(\"❌ [CONTACT] Error:\", error);\r\n    return NextResponse.json(\r\n      {\r\n        type: \"https://api.shop.am/problems/internal-error\",\r\n        title: \"Internal Server Error\",\r\n        status: 500,\r\n        detail: error.message || \"An error occurred while submitting the contact form\",\r\n        instance: req.url,\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAMO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG;QAE1C,aAAa;QACb,IAAI,CAAC,QAAQ,OAAO,SAAS,YAAY,KAAK,IAAI,GAAG,MAAM,KAAK,GAAG;YACjE,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,MAAM;gBACN,OAAO;gBACP,QAAQ;gBACR,QAAQ;gBACR,UAAU,IAAI,GAAG;YACnB,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,CAAC,SAAS,OAAO,UAAU,YAAY,MAAM,IAAI,GAAG,MAAM,KAAK,GAAG;YACpE,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,MAAM;gBACN,OAAO;gBACP,QAAQ;gBACR,QAAQ;gBACR,UAAU,IAAI,GAAG;YACnB,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,CAAC,WAAW,OAAO,YAAY,YAAY,QAAQ,IAAI,GAAG,MAAM,KAAK,GAAG;YAC1E,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,MAAM;gBACN,OAAO;gBACP,QAAQ;gBACR,QAAQ;gBACR,UAAU,IAAI,GAAG;YACnB,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,CAAC,WAAW,OAAO,YAAY,YAAY,QAAQ,IAAI,GAAG,MAAM,KAAK,GAAG;YAC1E,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,MAAM;gBACN,OAAO;gBACP,QAAQ;gBACR,QAAQ;gBACR,UAAU,IAAI,GAAG;YACnB,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,mBAAmB;QACnB,MAAM,aAAa;QACnB,IAAI,CAAC,WAAW,IAAI,CAAC,QAAQ;YAC3B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,MAAM;gBACN,OAAO;gBACP,QAAQ;gBACR,QAAQ;gBACR,UAAU,IAAI,GAAG;YACnB,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,yBAAyB;QACzB,MAAM,iBAAiB,MAAM,gIAAE,CAAC,cAAc,CAAC,MAAM,CAAC;YACpD,MAAM;gBACJ,MAAM,KAAK,IAAI;gBACf,OAAO,MAAM,IAAI;gBACjB,SAAS,QAAQ,IAAI;gBACrB,SAAS,QAAQ,IAAI;YACvB;QACF;QAEA,QAAQ,GAAG,CAAC,gCAAgC,eAAe,EAAE;QAE7D,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,MAAM;gBACJ,IAAI,eAAe,EAAE;gBACrB,MAAM,eAAe,IAAI;gBACzB,OAAO,eAAe,KAAK;gBAC3B,SAAS,eAAe,OAAO;gBAC/B,SAAS,eAAe,OAAO;gBAC/B,WAAW,eAAe,SAAS;YACrC;QACF,GACA;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,MAAM;YACN,OAAO;YACP,QAAQ;YACR,QAAQ,MAAM,OAAO,IAAI;YACzB,UAAU,IAAI,GAAG;QACnB,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}