{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/packages/ui/Button.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { ButtonHTMLAttributes, forwardRef, ReactElement } from 'react';\r\n\r\ninterface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {\r\n  variant?: 'primary' | 'secondary' | 'outline' | 'ghost';\r\n  size?: 'sm' | 'md' | 'lg';\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const Button = forwardRef<HTMLButtonElement, ButtonProps>(\r\n  function Button(\r\n    { variant = 'primary', size = 'md', className = '', children, ...props },\r\n    ref\r\n  ): ReactElement {\r\n    const baseStyles = 'font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed';\r\n    \r\n    const variantStyles = {\r\n      primary: 'bg-gray-900 text-white hover:bg-gray-800 focus:ring-gray-900',\r\n      secondary: 'bg-white text-gray-900 border border-gray-300 hover:bg-gray-50 focus:ring-gray-500',\r\n      outline: 'bg-transparent text-gray-900 border border-gray-300 hover:bg-gray-50 focus:ring-gray-500',\r\n      ghost: 'bg-transparent text-gray-900 hover:bg-gray-100 focus:ring-gray-500',\r\n    };\r\n    \r\n    const sizeStyles = {\r\n      sm: 'px-3 py-1.5 text-sm',\r\n      md: 'px-4 py-2 text-base',\r\n      lg: 'px-6 py-3 text-lg',\r\n    };\r\n    \r\n    return (\r\n      <button\r\n        ref={ref}\r\n        className={`${baseStyles} ${variantStyles[variant]} ${sizeStyles[size]} ${className}`}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </button>\r\n    );\r\n  }\r\n);\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAUO,MAAM,uBAAS,IAAA,2KAAU,OAC9B,SAAS,OACP,EAAE,UAAU,SAAS,EAAE,OAAO,IAAI,EAAE,YAAY,EAAE,EAAE,QAAQ,EAAE,GAAG,OAAO,EACxE,GAAG;IAEH,MAAM,aAAa;IAEnB,MAAM,gBAAgB;QACpB,SAAS;QACT,WAAW;QACX,SAAS;QACT,OAAO;IACT;IAEA,MAAM,aAAa;QACjB,IAAI;QACJ,IAAI;QACJ,IAAI;IACN;IAEA,qBACE,6LAAC;QACC,KAAK;QACL,WAAW,GAAG,WAAW,CAAC,EAAE,aAAa,CAAC,QAAQ,CAAC,CAAC,EAAE,UAAU,CAAC,KAAK,CAAC,CAAC,EAAE,WAAW;QACpF,GAAG,KAAK;kBAER;;;;;;AAGP"}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/packages/ui/Card.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { HTMLAttributes, forwardRef, ReactElement } from 'react';\r\n\r\ninterface CardProps extends HTMLAttributes<HTMLDivElement> {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const Card = forwardRef<HTMLDivElement, CardProps>(\r\n  function Card({ className = '', children, ...props }, ref): ReactElement {\r\n    return (\r\n      <div\r\n        ref={ref}\r\n        className={`bg-white border border-gray-200 rounded-lg shadow-sm ${className}`}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAQO,MAAM,qBAAO,IAAA,2KAAU,OAC5B,SAAS,KAAK,EAAE,YAAY,EAAE,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,GAAG;IACvD,qBACE,6LAAC;QACC,KAAK;QACL,WAAW,CAAC,qDAAqD,EAAE,WAAW;QAC7E,GAAG,KAAK;kBAER;;;;;;AAGP"}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/packages/ui/Input.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { InputHTMLAttributes, forwardRef } from 'react';\r\n\r\ninterface InputProps extends InputHTMLAttributes<HTMLInputElement> {\r\n  label?: string;\r\n  error?: string;\r\n}\r\n\r\nexport const Input = forwardRef<HTMLInputElement, InputProps>(\r\n  function Input({ label, error, className = '', onKeyDown, ...props }, ref) {\r\n    // Ensure pipe character (|) works in all input fields\r\n    const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n      // Allow pipe character (|) - key code 220 or Shift+Backslash\r\n      if (e.key === '|' || e.keyCode === 220 || (e.shiftKey && e.key === '\\\\')) {\r\n        // Allow the default behavior for pipe character\r\n        return;\r\n      }\r\n      \r\n      // Call original onKeyDown if provided\r\n      if (onKeyDown) {\r\n        onKeyDown(e);\r\n      }\r\n    };\r\n\r\n    return (\r\n      <div className=\"w-full\">\r\n        {label && (\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n            {label}\r\n          </label>\r\n        )}\r\n        <input\r\n          ref={ref}\r\n          className={`w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent disabled:bg-gray-50 disabled:cursor-not-allowed ${\r\n            error ? 'border-error focus:ring-error' : 'border-gray-300'\r\n          } ${className}`}\r\n          onKeyDown={handleKeyDown}\r\n          {...props}\r\n        />\r\n        {error && (\r\n          <p className=\"mt-1 text-sm text-error\">{error}</p>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n);\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AASO,MAAM,sBAAQ,IAAA,2KAAU,OAC7B,SAAS,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,YAAY,EAAE,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,GAAG;IACvE,sDAAsD;IACtD,MAAM,gBAAgB,CAAC;QACrB,6DAA6D;QAC7D,IAAI,EAAE,GAAG,KAAK,OAAO,EAAE,OAAO,KAAK,OAAQ,EAAE,QAAQ,IAAI,EAAE,GAAG,KAAK,MAAO;YACxE,gDAAgD;YAChD;QACF;QAEA,sCAAsC;QACtC,IAAI,WAAW;YACb,UAAU;QACZ;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;YACZ,uBACC,6LAAC;gBAAM,WAAU;0BACd;;;;;;0BAGL,6LAAC;gBACC,KAAK;gBACL,WAAW,CAAC,gKAAgK,EAC1K,QAAQ,kCAAkC,kBAC3C,CAAC,EAAE,WAAW;gBACf,WAAW;gBACV,GAAG,KAAK;;;;;;YAEV,uBACC,6LAAC;gBAAE,WAAU;0BAA2B;;;;;;;;;;;;AAIhD"}},
    {"offset": {"line": 149, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/packages/ui/index.ts"],"sourcesContent":["export { Button } from './Button';\r\nexport { Card } from './Card';\r\nexport { Input } from './Input';\r\n\r\n"],"names":[],"mappings":";AAAA;AACA;AACA"}},
    {"offset": {"line": 163, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/lib/utils/logger.ts"],"sourcesContent":["/**\r\n * Logger utility for consistent logging across the application\r\n * Replaces console.log with structured logging\r\n */\r\n\r\ntype LogLevel = 'debug' | 'info' | 'warn' | 'error';\r\n\r\ninterface LogContext {\r\n  [key: string]: unknown;\r\n}\r\n\r\nclass Logger {\r\n  private isDevelopment(): boolean {\r\n    return process.env.NODE_ENV === 'development';\r\n  }\r\n\r\n  private formatMessage(level: LogLevel, message: string, context?: LogContext): string {\r\n    const timestamp = new Date().toISOString();\r\n    const contextStr = context ? ` ${JSON.stringify(context)}` : '';\r\n    return `[${timestamp}] [${level.toUpperCase()}] ${message}${contextStr}`;\r\n  }\r\n\r\n  debug(message: string, context?: LogContext): void {\r\n    if (this.isDevelopment()) {\r\n      console.debug(this.formatMessage('debug', message, context));\r\n    }\r\n  }\r\n\r\n  info(message: string, context?: LogContext): void {\r\n    if (this.isDevelopment()) {\r\n      console.info(this.formatMessage('info', message, context));\r\n    }\r\n  }\r\n\r\n  warn(message: string, context?: LogContext): void {\r\n    console.warn(this.formatMessage('warn', message, context));\r\n  }\r\n\r\n  error(message: string, context?: LogContext): void {\r\n    console.error(this.formatMessage('error', message, context));\r\n  }\r\n\r\n  log(message: string, context?: LogContext): void {\r\n    // Alias for info in development\r\n    this.info(message, context);\r\n  }\r\n}\r\n\r\nexport const logger = new Logger();\r\n\r\n\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AAUU;AAFX,MAAM;IACI,gBAAyB;QAC/B,OAAO,oDAAyB;IAClC;IAEQ,cAAc,KAAe,EAAE,OAAe,EAAE,OAAoB,EAAU;QACpF,MAAM,YAAY,IAAI,OAAO,WAAW;QACxC,MAAM,aAAa,UAAU,CAAC,CAAC,EAAE,KAAK,SAAS,CAAC,UAAU,GAAG;QAC7D,OAAO,CAAC,CAAC,EAAE,UAAU,GAAG,EAAE,MAAM,WAAW,GAAG,EAAE,EAAE,UAAU,YAAY;IAC1E;IAEA,MAAM,OAAe,EAAE,OAAoB,EAAQ;QACjD,IAAI,IAAI,CAAC,aAAa,IAAI;YACxB,QAAQ,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,SAAS,SAAS;QACrD;IACF;IAEA,KAAK,OAAe,EAAE,OAAoB,EAAQ;QAChD,IAAI,IAAI,CAAC,aAAa,IAAI;YACxB,QAAQ,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,SAAS;QACnD;IACF;IAEA,KAAK,OAAe,EAAE,OAAoB,EAAQ;QAChD,QAAQ,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,QAAQ,SAAS;IACnD;IAEA,MAAM,OAAe,EAAE,OAAoB,EAAQ;QACjD,QAAQ,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,SAAS,SAAS;IACrD;IAEA,IAAI,OAAe,EAAE,OAAoB,EAAQ;QAC/C,gCAAgC;QAChC,IAAI,CAAC,IAAI,CAAC,SAAS;IACrB;AACF;AAEO,MAAM,SAAS,IAAI"}},
    {"offset": {"line": 209, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/lib/utils/image-utils.ts"],"sourcesContent":["/**\n * Unified image URL utilities for consistent handling across the application\n */\n\nimport imageCompression from 'browser-image-compression';\nimport { logger } from './logger';\n\n/**\n * Type for image URL input - can be string or object with url/src/value properties\n */\ntype ImageUrlInput = string | null | undefined | { url?: string; src?: string; value?: string };\n\n/**\n * Validates if a URL is a valid image URL\n */\nexport function isValidImageUrl(url: ImageUrlInput): boolean {\n  if (!url) return false;\n  \n  const urlStr = typeof url === 'string' ? url.trim() : '';\n  if (!urlStr) return false;\n  \n  // Base64 images are valid\n  if (urlStr.startsWith('data:image/')) return true;\n  \n  // HTTP/HTTPS URLs are valid\n  if (urlStr.startsWith('http://') || urlStr.startsWith('https://')) return true;\n  \n  // Relative paths starting with / are valid\n  if (urlStr.startsWith('/')) return true;\n  \n  return false;\n}\n\n/**\n * Processes and normalizes an image URL from various formats\n * Returns null if invalid\n */\nexport function processImageUrl(url: ImageUrlInput): string | null {\n  if (!url) return null;\n  \n  let finalUrl = '';\n  if (typeof url === 'string') {\n    finalUrl = url.trim();\n  } else if (typeof url === 'object' && url !== null) {\n    finalUrl = (url.url || url.src || url.value || '').trim();\n  }\n  \n  if (!finalUrl) return null;\n  \n  // Validate\n  if (!isValidImageUrl(finalUrl)) {\n    return null;\n  }\n  \n  // For base64 or full URLs, return as-is\n  if (finalUrl.startsWith('data:') || finalUrl.startsWith('http://') || finalUrl.startsWith('https://')) {\n    return finalUrl;\n  }\n  \n  // For relative paths, ensure they start with /\n  if (finalUrl.startsWith('/')) {\n    return finalUrl;\n  }\n  \n  return `/${finalUrl}`;\n}\n\n/**\n * Smart split for comma-separated image URLs that handles Base64 data URIs\n * Base64 strings can contain commas, so we need special handling\n */\nexport function smartSplitUrls(str: string | null | undefined): string[] {\n  if (!str) return [];\n  \n  // If no base64, simple split\n  if (!str.includes('data:image/')) {\n    return str.split(',').map(s => s.trim()).filter(Boolean);\n  }\n  \n  // Handle base64 - split carefully\n  // Base64 format: data:image/type;base64,<base64data>\n  // The comma after base64, is the separator, but base64 data itself can contain commas\n  // We need to find the comma that separates base64 header from data, then find the next URL separator\n  \n  const results: string[] = [];\n  let i = 0;\n  \n  while (i < str.length) {\n    if (str.substring(i).startsWith('data:image/')) {\n      // Found start of base64 image\n      // Find the comma after base64, (this is the separator between header and data)\n      const headerEnd = str.indexOf(',', i);\n      if (headerEnd === -1) {\n        // No comma found, treat entire rest as base64\n        results.push(str.substring(i).trim());\n        break;\n      }\n      \n      // Find the next comma that's likely a URL separator (followed by whitespace and another URL pattern)\n      // Or find end of string\n      let nextSeparator = str.length;\n      for (let j = headerEnd + 1; j < str.length; j++) {\n        if (str[j] === ',') {\n          // Check if this comma is followed by a URL pattern (not part of base64)\n          const afterComma = str.substring(j + 1).trim();\n          if (afterComma.startsWith('data:image/') || \n              afterComma.startsWith('http://') || \n              afterComma.startsWith('https://') ||\n              afterComma.startsWith('/')) {\n            nextSeparator = j;\n            break;\n          }\n        }\n      }\n      \n      // Extract base64 image (from start to separator)\n      const base64Image = str.substring(i, nextSeparator).trim();\n      if (base64Image) {\n        results.push(base64Image);\n      }\n      \n      i = nextSeparator + 1;\n    } else {\n      // Regular URL - find next comma or end\n      const nextComma = str.indexOf(',', i);\n      if (nextComma === -1) {\n        // No more commas, add rest as single URL\n        const url = str.substring(i).trim();\n        if (url) {\n          results.push(url);\n        }\n        break;\n      } else {\n        // Add URL up to comma\n        const url = str.substring(i, nextComma).trim();\n        if (url) {\n          results.push(url);\n        }\n        i = nextComma + 1;\n      }\n    }\n  }\n  \n  return results.filter(Boolean);\n}\n\n/**\n * Normalizes URL for comparison (ensures consistent format for deduplication)\n * Returns normalized string for exact matching\n */\nexport function normalizeUrlForComparison(url: string): string {\n  if (!url) return '';\n  \n  // Base64 images - return as-is (exact match required)\n  if (url.startsWith('data:')) {\n    return url;\n  }\n  \n  // HTTP/HTTPS URLs - return as-is (exact match)\n  if (url.startsWith('http://') || url.startsWith('https://')) {\n    return url;\n  }\n  \n  // Relative paths - normalize to start with /\n  const trimmed = url.trim();\n  if (trimmed.startsWith('/')) {\n    return trimmed;\n  }\n  \n  return `/${trimmed}`;\n}\n\n/**\n * Gets all normalized variations of a URL for comparison\n * Useful when comparing URLs that might have different formats\n */\nexport function getUrlVariations(url: string): string[] {\n  if (!url) return [];\n  \n  const normalized = normalizeUrlForComparison(url);\n  const variations = new Set<string>([normalized]);\n  \n  // For relative paths, add variations with/without leading slash\n  if (!normalized.startsWith('data:') && !normalized.startsWith('http')) {\n    if (normalized.startsWith('/')) {\n      variations.add(normalized.substring(1));\n      variations.add(normalized);\n    } else {\n      variations.add(normalized);\n      variations.add(`/${normalized}`);\n    }\n    \n    // Also add without query params\n    const withoutQuery = normalized.split('?')[0];\n    if (withoutQuery !== normalized) {\n      variations.add(withoutQuery);\n      if (withoutQuery.startsWith('/')) {\n        variations.add(withoutQuery.substring(1));\n      } else {\n        variations.add(`/${withoutQuery}`);\n      }\n    }\n  }\n  \n  return Array.from(variations);\n}\n\n/**\n * Cleans and validates an array of image URLs\n * Removes invalid, empty, and duplicate URLs\n */\nexport function cleanImageUrls(urls: (string | ImageUrlInput)[]): string[] {\n  if (!Array.isArray(urls)) return [];\n  \n  const seen = new Set<string>();\n  const cleaned: string[] = [];\n  \n  for (const url of urls) {\n    const processed = processImageUrl(url);\n    if (!processed) continue;\n    \n    const normalized = normalizeUrlForComparison(processed);\n    if (seen.has(normalized)) continue;\n    \n    seen.add(normalized);\n    cleaned.push(processed);\n  }\n  \n  return cleaned;\n}\n\n/**\n * Separates main images from variant images\n * Removes variant images from main images array to prevent duplication\n */\nexport function separateMainAndVariantImages(\n  mainImages: (string | ImageUrlInput)[],\n  variantImages: (string | ImageUrlInput)[]\n): {\n  main: string[];\n  variants: string[];\n} {\n  // Process and normalize all variant images\n  const variantUrlSet = new Set<string>();\n  const variantVariationsMap = new Map<string, string[]>();\n  \n  for (const variantImg of variantImages) {\n    const processed = processImageUrl(variantImg);\n    if (!processed) continue;\n    \n    const normalized = normalizeUrlForComparison(processed);\n    variantUrlSet.add(normalized);\n    \n    // Store all variations for this URL\n    const variations = getUrlVariations(processed);\n    variations.forEach(v => variantVariationsMap.set(v, variations));\n  }\n  \n  // Process main images and filter out those that match variants\n  const mainProcessed: string[] = [];\n  const seenMain = new Set<string>();\n  \n  for (const mainImg of mainImages) {\n    const processed = processImageUrl(mainImg);\n    if (!processed) continue;\n    \n    const normalized = normalizeUrlForComparison(processed);\n    \n    // Check if this main image matches any variant image\n    const isVariantImage = variantUrlSet.has(normalized) || \n                          variantVariationsMap.has(normalized) ||\n                          Array.from(variantVariationsMap.values()).some(variations => \n                            variations.some(v => {\n                              const mainVariations = getUrlVariations(processed);\n                              return mainVariations.includes(v);\n                            })\n                          );\n    \n    if (isVariantImage) {\n      continue; // Skip - this is a variant image\n    }\n    \n    // Check for duplicates in main images\n    if (seenMain.has(normalized)) {\n      continue;\n    }\n    \n    seenMain.add(normalized);\n    mainProcessed.push(processed);\n  }\n  \n  // Process variant images (already validated above)\n  const variantProcessed: string[] = [];\n  const seenVariant = new Set<string>();\n  \n  for (const variantImg of variantImages) {\n    const processed = processImageUrl(variantImg);\n    if (!processed) continue;\n    \n    const normalized = normalizeUrlForComparison(processed);\n    if (seenVariant.has(normalized)) continue;\n    \n    seenVariant.add(normalized);\n    variantProcessed.push(processed);\n  }\n  \n  return {\n    main: mainProcessed,\n    variants: variantProcessed,\n  };\n}\n\n/**\n * Processes an image file with compression, EXIF orientation correction, and size optimization\n * Automatically handles:\n * - EXIF orientation (rotates image correctly)\n * - Resize to max dimensions (1920x1920 by default)\n * - Compression to reduce file size (maxSizeMB: 2MB by default)\n * \n * @param file - The image file to process\n * @param options - Processing options\n * @returns Promise<string> - Base64 data URL of processed image\n */\nexport async function processImageFile(\n  file: File,\n  options?: {\n    maxSizeMB?: number; // Maximum file size in MB (default: 2)\n    maxWidthOrHeight?: number; // Maximum width or height in pixels (default: 1920)\n    useWebWorker?: boolean; // Use web worker for processing (default: true)\n    fileType?: string; // Output file type (default: 'image/jpeg')\n    initialQuality?: number; // Initial quality 0-1 (default: 0.8)\n  }\n): Promise<string> {\n  try {\n    logger.debug('Starting image processing', {\n      fileName: file.name,\n      originalSize: `${Math.round(file.size / 1024)}KB`,\n      type: file.type\n    });\n\n    const {\n      maxSizeMB = 2,\n      maxWidthOrHeight = 1920,\n      useWebWorker = true,\n      fileType = 'image/jpeg',\n      initialQuality = 0.8\n    } = options || {};\n\n    // Process image with compression and EXIF orientation correction\n    // browser-image-compression automatically handles EXIF orientation\n    const compressedFile = await imageCompression(file, {\n      maxSizeMB,\n      maxWidthOrHeight,\n      useWebWorker,\n      fileType,\n      initialQuality,\n      // EXIF orientation is automatically handled by browser-image-compression\n    });\n\n    logger.info('Image processed successfully', {\n      originalSize: `${Math.round(file.size / 1024)}KB`,\n      compressedSize: `${Math.round(compressedFile.size / 1024)}KB`,\n      reduction: `${Math.round((1 - compressedFile.size / file.size) * 100)}%`\n    });\n\n    // Convert to base64\n    return new Promise<string>((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => {\n        const result = reader.result as string;\n        logger.debug('Image converted to base64', { length: result.length });\n        resolve(result);\n      };\n      reader.onerror = (error) => {\n        logger.error('Error converting to base64', { error });\n        reject(new Error('Failed to convert image to base64'));\n      };\n      reader.readAsDataURL(compressedFile);\n    });\n  } catch (error: unknown) {\n    const errorMessage = error instanceof Error ? error.message : 'Failed to process image';\n    logger.error('Error processing image', { error });\n    throw new Error(errorMessage);\n  }\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 496, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/BasicInformation.tsx"],"sourcesContent":["'use client';\r\n\r\nimport type { ChangeEvent } from 'react';\r\nimport { Input } from '@shop/ui';\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\n\r\ninterface BasicInformationProps {\r\n  productType: 'simple' | 'variable';\r\n  setProductType: (type: 'simple' | 'variable') => void;\r\n  title: string;\r\n  slug: string;\r\n  descriptionHtml: string;\r\n  onTitleChange: (e: ChangeEvent<HTMLInputElement>) => void;\r\n  onSlugChange: (e: ChangeEvent<HTMLInputElement>) => void;\r\n  onDescriptionChange: (e: ChangeEvent<HTMLTextAreaElement>) => void;\r\n}\r\n\r\nexport function BasicInformation({\r\n  productType,\r\n  setProductType,\r\n  title,\r\n  slug,\r\n  descriptionHtml,\r\n  onTitleChange,\r\n  onSlugChange,\r\n  onDescriptionChange,\r\n}: BasicInformationProps) {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">{t('admin.products.add.basicInformation')}</h2>\r\n      <div className=\"space-y-4\">\r\n        {/* Product Type Selector */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n            {t('admin.products.add.productType')} *\r\n          </label>\r\n          <p className=\"text-xs text-gray-500 mb-3\">\r\n            {t('admin.products.add.productTypeDescription')}\r\n          </p>\r\n          <div className=\"flex gap-4\">\r\n            <label className=\"flex items-center gap-2 cursor-pointer\">\r\n              <input\r\n                type=\"radio\"\r\n                name=\"productType\"\r\n                value=\"simple\"\r\n                checked={productType === 'simple'}\r\n                onChange={(e) => setProductType(e.target.value as 'simple' | 'variable')}\r\n                className=\"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500\"\r\n              />\r\n              <span className=\"text-sm text-gray-700\">{t('admin.products.add.productTypeSimple')}</span>\r\n            </label>\r\n            <label className=\"flex items-center gap-2 cursor-pointer\">\r\n              <input\r\n                type=\"radio\"\r\n                name=\"productType\"\r\n                value=\"variable\"\r\n                checked={productType === 'variable'}\r\n                onChange={(e) => setProductType(e.target.value as 'simple' | 'variable')}\r\n                className=\"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500\"\r\n              />\r\n              <span className=\"text-sm text-gray-700\">{t('admin.products.add.productTypeVariable')}</span>\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n            {t('admin.products.add.title')} *\r\n          </label>\r\n          <Input\r\n            type=\"text\"\r\n            value={title}\r\n            onChange={onTitleChange}\r\n            required\r\n            placeholder={t('admin.products.add.productTitlePlaceholder')}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n            {t('admin.products.add.slug')} *\r\n          </label>\r\n          <Input\r\n            type=\"text\"\r\n            value={slug}\r\n            onChange={onSlugChange}\r\n            required\r\n            placeholder={t('admin.products.add.productSlugPlaceholder')}\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n            {t('admin.products.add.description')}\r\n          </label>\r\n          <textarea\r\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            rows={6}\r\n            value={descriptionHtml}\r\n            onChange={onDescriptionChange}\r\n            placeholder={t('admin.products.add.productDescriptionPlaceholder')}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AACA;;;AAJA;;;AAiBO,SAAS,iBAAiB,EAC/B,WAAW,EACX,cAAc,EACd,KAAK,EACL,IAAI,EACJ,eAAe,EACf,aAAa,EACb,YAAY,EACZ,mBAAmB,EACG;;IACtB,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,yJAAc;IAE5B,qBACE,6LAAC;;0BACC,6LAAC;gBAAG,WAAU;0BAA4C,EAAE;;;;;;0BAC5D,6LAAC;gBAAI,WAAU;;kCAEb,6LAAC;;0CACC,6LAAC;gCAAM,WAAU;;oCACd,EAAE;oCAAkC;;;;;;;0CAEvC,6LAAC;gCAAE,WAAU;0CACV,EAAE;;;;;;0CAEL,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAM,WAAU;;0DACf,6LAAC;gDACC,MAAK;gDACL,MAAK;gDACL,OAAM;gDACN,SAAS,gBAAgB;gDACzB,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;gDAC9C,WAAU;;;;;;0DAEZ,6LAAC;gDAAK,WAAU;0DAAyB,EAAE;;;;;;;;;;;;kDAE7C,6LAAC;wCAAM,WAAU;;0DACf,6LAAC;gDACC,MAAK;gDACL,MAAK;gDACL,OAAM;gDACN,SAAS,gBAAgB;gDACzB,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;gDAC9C,WAAU;;;;;;0DAEZ,6LAAC;gDAAK,WAAU;0DAAyB,EAAE;;;;;;;;;;;;;;;;;;;;;;;;kCAKjD,6LAAC;;0CACC,6LAAC;gCAAM,WAAU;;oCACd,EAAE;oCAA4B;;;;;;;0CAEjC,6LAAC,oIAAK;gCACJ,MAAK;gCACL,OAAO;gCACP,UAAU;gCACV,QAAQ;gCACR,aAAa,EAAE;;;;;;;;;;;;kCAInB,6LAAC;;0CACC,6LAAC;gCAAM,WAAU;;oCACd,EAAE;oCAA2B;;;;;;;0CAEhC,6LAAC,oIAAK;gCACJ,MAAK;gCACL,OAAO;gCACP,UAAU;gCACV,QAAQ;gCACR,aAAa,EAAE;;;;;;;;;;;;kCAInB,6LAAC;;0CACC,6LAAC;gCAAM,WAAU;0CACd,EAAE;;;;;;0CAEL,6LAAC;gCACC,WAAU;gCACV,MAAM;gCACN,OAAO;gCACP,UAAU;gCACV,aAAa,EAAE;;;;;;;;;;;;;;;;;;;;;;;;AAM3B;GA3FgB;;QAUA,yJAAc;;;KAVd"}},
    {"offset": {"line": 734, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/ProductImages.tsx"],"sourcesContent":["'use client';\r\n\r\nimport type { ChangeEvent, RefObject } from 'react';\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\n\r\ninterface ProductImagesProps {\r\n  imageUrls: string[];\r\n  featuredImageIndex: number;\r\n  imageUploadLoading: boolean;\r\n  imageUploadError: string | null;\r\n  fileInputRef: RefObject<HTMLInputElement>;\r\n  onUploadImages: (event: ChangeEvent<HTMLInputElement>) => void;\r\n  onRemoveImage: (index: number) => void;\r\n  onSetFeaturedImage: (index: number) => void;\r\n}\r\n\r\nexport function ProductImages({\r\n  imageUrls,\r\n  featuredImageIndex,\r\n  imageUploadLoading,\r\n  imageUploadError,\r\n  fileInputRef,\r\n  onUploadImages,\r\n  onRemoveImage,\r\n  onSetFeaturedImage,\r\n}: ProductImagesProps) {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">{t('admin.products.add.mainProductImage')}</h2>\r\n      <div className=\"space-y-4\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n            {t('admin.products.add.productImages')}\r\n            <span className=\"text-xs text-gray-500 ml-2\">({t('admin.products.add.uploadMultipleImages')})</span>\r\n          </label>\r\n          \r\n          {/* Upload Button */}\r\n          <div className=\"mb-4\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => fileInputRef.current?.click()}\r\n              disabled={imageUploadLoading}\r\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\r\n            >\r\n              <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n              </svg>\r\n              {imageUploadLoading ? t('admin.products.add.uploading') : t('admin.products.add.uploadImages')}\r\n            </button>\r\n            <input\r\n              ref={fileInputRef}\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              multiple\r\n              onChange={onUploadImages}\r\n              className=\"hidden\"\r\n            />\r\n          </div>\r\n\r\n          {/* Images Grid */}\r\n          {imageUrls.length > 0 && (\r\n            <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n              {imageUrls.map((imageUrl, index) => (\r\n                <div key={index} className=\"relative group\">\r\n                  <div className={`relative border-2 rounded-md overflow-hidden ${\r\n                    featuredImageIndex === index \r\n                      ? 'border-blue-500 ring-2 ring-blue-300' \r\n                      : 'border-gray-300'\r\n                  }`}>\r\n                    <img\r\n                      src={imageUrl}\r\n                      alt={`Product image ${index + 1}`}\r\n                      className=\"w-full h-48 object-cover\"\r\n                    />\r\n                    \r\n                    {/* Main Checkbox */}\r\n                    <div className=\"absolute top-2 left-2\">\r\n                      <label className=\"flex items-center gap-2 bg-white/90 backdrop-blur-sm px-2 py-1 rounded-md cursor-pointer hover:bg-white transition-colors\">\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={featuredImageIndex === index}\r\n                          onChange={() => onSetFeaturedImage(index)}\r\n                          className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n                        />\r\n                        <span className=\"text-xs font-medium text-gray-700\">\r\n                          {featuredImageIndex === index ? t('admin.products.add.main') : t('admin.products.add.setAsMain')}\r\n                        </span>\r\n                      </label>\r\n                    </div>\r\n\r\n                    {/* Remove Button */}\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => onRemoveImage(index)}\r\n                      className=\"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1.5 hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100\"\r\n                      title={t('admin.products.add.removeImage')}\r\n                    >\r\n                      <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                      </svg>\r\n                    </button>\r\n\r\n                    {/* Main Badge */}\r\n                    {featuredImageIndex === index && (\r\n                      <div className=\"absolute bottom-2 left-2 bg-blue-500 text-white px-2 py-1 rounded text-xs font-medium\">\r\n                        {t('admin.products.add.main')}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n\r\n          {imageUploadError && (\r\n            <div className=\"mt-2 text-sm text-red-600\">\r\n              {imageUploadError}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAGA;;;AAHA;;AAgBO,SAAS,cAAc,EAC5B,SAAS,EACT,kBAAkB,EAClB,kBAAkB,EAClB,gBAAgB,EAChB,YAAY,EACZ,cAAc,EACd,aAAa,EACb,kBAAkB,EACC;;IACnB,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,yJAAc;IAE5B,qBACE,6LAAC;;0BACC,6LAAC;gBAAG,WAAU;0BAA4C,EAAE;;;;;;0BAC5D,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;;sCACC,6LAAC;4BAAM,WAAU;;gCACd,EAAE;8CACH,6LAAC;oCAAK,WAAU;;wCAA6B;wCAAE,EAAE;wCAA2C;;;;;;;;;;;;;sCAI9F,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,MAAK;oCACL,SAAS,IAAM,aAAa,OAAO,EAAE;oCACrC,UAAU;oCACV,WAAU;;sDAEV,6LAAC;4CAAI,WAAU;4CAAU,MAAK;4CAAO,QAAO;4CAAe,SAAQ;sDACjE,cAAA,6LAAC;gDAAK,eAAc;gDAAQ,gBAAe;gDAAQ,aAAa;gDAAG,GAAE;;;;;;;;;;;wCAEtE,qBAAqB,EAAE,kCAAkC,EAAE;;;;;;;8CAE9D,6LAAC;oCACC,KAAK;oCACL,MAAK;oCACL,QAAO;oCACP,QAAQ;oCACR,UAAU;oCACV,WAAU;;;;;;;;;;;;wBAKb,UAAU,MAAM,GAAG,mBAClB,6LAAC;4BAAI,WAAU;sCACZ,UAAU,GAAG,CAAC,CAAC,UAAU,sBACxB,6LAAC;oCAAgB,WAAU;8CACzB,cAAA,6LAAC;wCAAI,WAAW,CAAC,6CAA6C,EAC5D,uBAAuB,QACnB,yCACA,mBACJ;;0DACA,6LAAC;gDACC,KAAK;gDACL,KAAK,CAAC,cAAc,EAAE,QAAQ,GAAG;gDACjC,WAAU;;;;;;0DAIZ,6LAAC;gDAAI,WAAU;0DACb,cAAA,6LAAC;oDAAM,WAAU;;sEACf,6LAAC;4DACC,MAAK;4DACL,SAAS,uBAAuB;4DAChC,UAAU,IAAM,mBAAmB;4DACnC,WAAU;;;;;;sEAEZ,6LAAC;4DAAK,WAAU;sEACb,uBAAuB,QAAQ,EAAE,6BAA6B,EAAE;;;;;;;;;;;;;;;;;0DAMvE,6LAAC;gDACC,MAAK;gDACL,SAAS,IAAM,cAAc;gDAC7B,WAAU;gDACV,OAAO,EAAE;0DAET,cAAA,6LAAC;oDAAI,WAAU;oDAAU,MAAK;oDAAO,QAAO;oDAAe,SAAQ;8DACjE,cAAA,6LAAC;wDAAK,eAAc;wDAAQ,gBAAe;wDAAQ,aAAa;wDAAG,GAAE;;;;;;;;;;;;;;;;4CAKxE,uBAAuB,uBACtB,6LAAC;gDAAI,WAAU;0DACZ,EAAE;;;;;;;;;;;;mCA1CD;;;;;;;;;;wBAmDf,kCACC,6LAAC;4BAAI,WAAU;sCACZ;;;;;;;;;;;;;;;;;;;;;;;AAOf;GA7GgB;;QAUA,yJAAc;;;KAVd"}},
    {"offset": {"line": 982, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/CategoriesBrands.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { Input } from '@shop/ui';\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\nimport type { Category, Brand } from '../types';\r\n\r\ninterface CategoriesBrandsProps {\r\n  categories: Category[];\r\n  brands: Brand[];\r\n  categoryIds: string[];\r\n  brandIds: string[];\r\n  categoriesExpanded: boolean;\r\n  brandsExpanded: boolean;\r\n  useNewCategory: boolean;\r\n  useNewBrand: boolean;\r\n  newCategoryName: string;\r\n  newBrandName: string;\r\n  onCategoriesExpandedChange: (expanded: boolean) => void;\r\n  onBrandsExpandedChange: (expanded: boolean) => void;\r\n  onUseNewCategoryChange: (useNew: boolean) => void;\r\n  onUseNewBrandChange: (useNew: boolean) => void;\r\n  onNewCategoryNameChange: (name: string) => void;\r\n  onNewBrandNameChange: (name: string) => void;\r\n  onCategoryIdsChange: (ids: string[]) => void;\r\n  onBrandIdsChange: (ids: string[]) => void;\r\n  onPrimaryCategoryIdChange: (id: string) => void;\r\n  isClothingCategory: () => boolean;\r\n  onVariantsUpdate?: (updater: (prev: any[]) => any[]) => void;\r\n}\r\n\r\nexport function CategoriesBrands({\r\n  categories,\r\n  brands,\r\n  categoryIds,\r\n  brandIds,\r\n  categoriesExpanded,\r\n  brandsExpanded,\r\n  useNewCategory,\r\n  useNewBrand,\r\n  newCategoryName,\r\n  newBrandName,\r\n  onCategoriesExpandedChange,\r\n  onBrandsExpandedChange,\r\n  onUseNewCategoryChange,\r\n  onUseNewBrandChange,\r\n  onNewCategoryNameChange,\r\n  onNewBrandNameChange,\r\n  onCategoryIdsChange,\r\n  onBrandIdsChange,\r\n  onPrimaryCategoryIdChange,\r\n  isClothingCategory,\r\n  onVariantsUpdate,\r\n}: CategoriesBrandsProps) {\r\n  const { t } = useTranslation();\r\n\r\n  // Build category tree structure\r\n  const buildCategoryTree = () => {\r\n    const categoryMap = new Map<string, Category & { children: Category[] }>();\r\n    const rootCategories: (Category & { children: Category[] })[] = [];\r\n\r\n    // First pass: create map and identify root categories\r\n    categories.forEach((category) => {\r\n      categoryMap.set(category.id, { ...category, children: [] });\r\n    });\r\n\r\n    // Second pass: build tree structure\r\n    categories.forEach((category) => {\r\n      if (category.parentId && categoryMap.has(category.parentId)) {\r\n        const parent = categoryMap.get(category.parentId)!;\r\n        const child = categoryMap.get(category.id)!;\r\n        parent.children.push(child);\r\n      } else {\r\n        rootCategories.push(categoryMap.get(category.id)!);\r\n      }\r\n    });\r\n\r\n    // Flatten tree for display (parent first, then children)\r\n    const flattenTree = (\r\n      nodes: (Category & { children: Category[] })[],\r\n      result: (Category & { isSubcategory: boolean })[] = []\r\n    ): (Category & { isSubcategory: boolean })[] => {\r\n      nodes.forEach((node) => {\r\n        result.push({ ...node, isSubcategory: false });\r\n        if (node.children && node.children.length > 0) {\r\n          node.children.forEach((child) => {\r\n            result.push({ ...child, isSubcategory: true });\r\n          });\r\n        }\r\n      });\r\n      return result;\r\n    };\r\n\r\n    return flattenTree(rootCategories);\r\n  };\r\n\r\n  const displayCategories = buildCategoryTree();\r\n\r\n  const handleCategoryChange = (categoryId: string, checked: boolean) => {\r\n    const newCategoryIds = checked\r\n      ? [...categoryIds, categoryId]\r\n      : categoryIds.filter((id) => id !== categoryId);\r\n\r\n    // Set primary category if it's the first one\r\n    const newPrimaryCategoryId = newCategoryIds.length > 0 ? newCategoryIds[0] : '';\r\n\r\n    const selectedCategory = categories.find((cat) => cat.id === categoryId);\r\n    const newIsSizeRequired = selectedCategory?.requiresSizes ?? false;\r\n\r\n    onCategoryIdsChange(newCategoryIds);\r\n    onPrimaryCategoryIdChange(newPrimaryCategoryId);\r\n\r\n    // If size requirement changed and variants need to be cleared\r\n    if (onVariantsUpdate) {\r\n      const wasSizeRequired = isClothingCategory();\r\n      if (wasSizeRequired && !newIsSizeRequired && newCategoryIds.length === 0) {\r\n        onVariantsUpdate((prev) =>\r\n          prev.map((v) => ({\r\n            ...v,\r\n            sizes: [],\r\n            sizeStocks: {},\r\n            size: '',\r\n          }))\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">{t('admin.products.add.categoriesAndBrands')}</h2>\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        {/* Categories - Multi-select */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n            {t('admin.products.add.categories')} <span className=\"text-gray-500 font-normal\">{t('admin.products.add.selectMultiple')}</span>\r\n          </label>\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <input\r\n                type=\"radio\"\r\n                id=\"select-category\"\r\n                name=\"category-mode\"\r\n                checked={!useNewCategory}\r\n                onChange={() => {\r\n                  onUseNewCategoryChange(false);\r\n                  onNewCategoryNameChange('');\r\n                }}\r\n                className=\"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500\"\r\n              />\r\n              <label htmlFor=\"select-category\" className=\"text-sm text-gray-700\">\r\n                {t('admin.products.add.selectExistingCategories')}\r\n              </label>\r\n            </div>\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <input\r\n                type=\"radio\"\r\n                id=\"new-category\"\r\n                name=\"category-mode\"\r\n                checked={useNewCategory}\r\n                onChange={() => {\r\n                  onUseNewCategoryChange(true);\r\n                }}\r\n                className=\"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500\"\r\n              />\r\n              <label htmlFor=\"new-category\" className=\"text-sm text-gray-700\">\r\n                {t('admin.products.add.addNewCategory')}\r\n              </label>\r\n            </div>\r\n            {!useNewCategory ? (\r\n              <div className=\"relative\" data-category-dropdown>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => onCategoriesExpandedChange(!categoriesExpanded)}\r\n                  className=\"w-full px-3 py-2 text-left border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-sm flex items-center justify-between\"\r\n                >\r\n                  <span className=\"text-gray-700\">\r\n                    {categoryIds.length === 0\r\n                      ? t('admin.products.add.selectCategories')\r\n                      : categoryIds.length === 1\r\n                        ? t('admin.products.add.categorySelected').replace('{count}', categoryIds.length.toString())\r\n                        : t('admin.products.add.categoriesSelected').replace('{count}', categoryIds.length.toString())}\r\n                  </span>\r\n                  <svg\r\n                    className={`w-4 h-4 text-gray-500 transition-transform duration-200 ${\r\n                      categoriesExpanded ? 'transform rotate-180' : ''\r\n                    }`}\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n                  </svg>\r\n                </button>\r\n                {categoriesExpanded && (\r\n                  <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto\">\r\n                    <div className=\"p-2\">\r\n                      <div className=\"space-y-1\">\r\n                        {displayCategories.map((category) => (\r\n                          <label\r\n                            key={category.id}\r\n                            className={`flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded ${\r\n                              category.isSubcategory ? 'pl-6' : ''\r\n                            }`}\r\n                          >\r\n                            <input\r\n                              type=\"checkbox\"\r\n                              checked={categoryIds.includes(category.id)}\r\n                              onChange={(e) => handleCategoryChange(category.id, e.target.checked)}\r\n                              className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n                            />\r\n                            <span\r\n                              className={`text-gray-700 ${\r\n                                category.isSubcategory ? 'text-xs' : 'text-sm font-semibold'\r\n                              }`}\r\n                            >\r\n                              {category.title}\r\n                            </span>\r\n                          </label>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-3\">\r\n                <Input\r\n                  type=\"text\"\r\n                  value={newCategoryName}\r\n                  onChange={(e) => onNewCategoryNameChange(e.target.value)}\r\n                  placeholder={t('admin.products.add.enterNewCategoryName')}\r\n                  className=\"w-full\"\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Brands - Multi-select */}\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n            {t('admin.products.add.brands')} <span className=\"text-gray-500 font-normal\">{t('admin.products.add.selectMultiple')}</span>\r\n          </label>\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <input\r\n                type=\"radio\"\r\n                id=\"select-brand\"\r\n                name=\"brand-mode\"\r\n                checked={!useNewBrand}\r\n                onChange={() => {\r\n                  onUseNewBrandChange(false);\r\n                  onNewBrandNameChange('');\r\n                }}\r\n                className=\"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500\"\r\n              />\r\n              <label htmlFor=\"select-brand\" className=\"text-sm text-gray-700\">\r\n                {t('admin.products.add.selectExistingBrands')}\r\n              </label>\r\n            </div>\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <input\r\n                type=\"radio\"\r\n                id=\"new-brand\"\r\n                name=\"brand-mode\"\r\n                checked={useNewBrand}\r\n                onChange={() => {\r\n                  onUseNewBrandChange(true);\r\n                }}\r\n                className=\"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500\"\r\n              />\r\n              <label htmlFor=\"new-brand\" className=\"text-sm text-gray-700\">\r\n                {t('admin.products.add.addNewBrand')}\r\n              </label>\r\n            </div>\r\n            {!useNewBrand ? (\r\n              <div className=\"relative\" data-brand-dropdown>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => onBrandsExpandedChange(!brandsExpanded)}\r\n                  className=\"w-full px-3 py-2 text-left border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-sm flex items-center justify-between\"\r\n                >\r\n                  <span className=\"text-gray-700\">\r\n                    {brandIds.length === 0\r\n                      ? t('admin.products.add.selectBrands')\r\n                      : brandIds.length === 1\r\n                        ? t('admin.products.add.brandSelected').replace('{count}', brandIds.length.toString())\r\n                        : t('admin.products.add.brandsSelected').replace('{count}', brandIds.length.toString())}\r\n                  </span>\r\n                  <svg\r\n                    className={`w-4 h-4 text-gray-500 transition-transform duration-200 ${\r\n                      brandsExpanded ? 'transform rotate-180' : ''\r\n                    }`}\r\n                    fill=\"none\"\r\n                    stroke=\"currentColor\"\r\n                    viewBox=\"0 0 24 24\"\r\n                  >\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n                  </svg>\r\n                </button>\r\n                {brandsExpanded && (\r\n                  <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto\">\r\n                    <div className=\"p-2\">\r\n                      <div className=\"space-y-1\">\r\n                        {brands.map((brand) => (\r\n                          <label\r\n                            key={brand.id}\r\n                            className=\"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded\"\r\n                          >\r\n                            <input\r\n                              type=\"checkbox\"\r\n                              checked={brandIds.includes(brand.id)}\r\n                              onChange={(e) => {\r\n                                const newBrandIds = e.target.checked\r\n                                  ? [...brandIds, brand.id]\r\n                                  : brandIds.filter((id) => id !== brand.id);\r\n                                onBrandIdsChange(newBrandIds);\r\n                              }}\r\n                              className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n                            />\r\n                            <span className=\"text-sm text-gray-700\">{brand.name}</span>\r\n                          </label>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            ) : (\r\n              <Input\r\n                type=\"text\"\r\n                value={newBrandName}\r\n                onChange={(e) => onNewBrandNameChange(e.target.value)}\r\n                placeholder={t('admin.products.add.enterNewBrandName')}\r\n                className=\"w-full\"\r\n              />\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1534, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/SimpleProductFields.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { Input } from '@shop/ui';\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\nimport { CURRENCIES, type CurrencyCode } from '../../../../../lib/currency';\r\n\r\ninterface SimpleProductFieldsProps {\r\n  price: string;\r\n  compareAtPrice: string;\r\n  sku: string;\r\n  quantity: string;\r\n  defaultCurrency: CurrencyCode;\r\n  onPriceChange: (value: string) => void;\r\n  onCompareAtPriceChange: (value: string) => void;\r\n  onSkuChange: (value: string) => void;\r\n  onQuantityChange: (value: string) => void;\r\n}\r\n\r\nexport function SimpleProductFields({\r\n  price,\r\n  compareAtPrice,\r\n  sku,\r\n  quantity,\r\n  defaultCurrency,\r\n  onPriceChange,\r\n  onCompareAtPriceChange,\r\n  onSkuChange,\r\n  onQuantityChange,\r\n}: SimpleProductFieldsProps) {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">{t('admin.products.add.productVariants')}</h2>\r\n      <div className=\"bg-white border border-gray-200 rounded-lg p-6 space-y-4\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n          {/* Price */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              {t('admin.products.add.price')} *\r\n            </label>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Input\r\n                type=\"number\"\r\n                value={price}\r\n                onChange={(e) => onPriceChange(e.target.value)}\r\n                placeholder={t('admin.products.add.pricePlaceholder')}\r\n                className=\"flex-1\"\r\n                min=\"0\"\r\n                step=\"0.01\"\r\n                required\r\n              />\r\n              <span className=\"text-sm text-gray-500 whitespace-nowrap\">{CURRENCIES[defaultCurrency].symbol}</span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Compare At Price */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              {t('admin.products.add.compareAtPrice')}\r\n            </label>\r\n            <div className=\"flex items-center gap-2\">\r\n              <Input\r\n                type=\"number\"\r\n                value={compareAtPrice}\r\n                onChange={(e) => onCompareAtPriceChange(e.target.value)}\r\n                placeholder={t('admin.products.add.pricePlaceholder')}\r\n                className=\"flex-1\"\r\n                min=\"0\"\r\n                step=\"0.01\"\r\n              />\r\n              <span className=\"text-sm text-gray-500 whitespace-nowrap\">{CURRENCIES[defaultCurrency].symbol}</span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* SKU */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              {t('admin.products.add.sku')} *\r\n            </label>\r\n            <Input\r\n              type=\"text\"\r\n              value={sku}\r\n              onChange={(e) => onSkuChange(e.target.value)}\r\n              placeholder={t('admin.products.add.autoGenerated')}\r\n              className=\"w-full\"\r\n              required\r\n            />\r\n          </div>\r\n\r\n          {/* Quantity */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              {t('admin.products.add.quantity')} *\r\n            </label>\r\n            <Input\r\n              type=\"number\"\r\n              value={quantity}\r\n              onChange={(e) => onQuantityChange(e.target.value)}\r\n              placeholder={t('admin.products.add.quantityPlaceholder')}\r\n              className=\"w-full\"\r\n              min=\"0\"\r\n              required\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;;;AAJA;;;;AAkBO,SAAS,oBAAoB,EAClC,KAAK,EACL,cAAc,EACd,GAAG,EACH,QAAQ,EACR,eAAe,EACf,aAAa,EACb,sBAAsB,EACtB,WAAW,EACX,gBAAgB,EACS;;IACzB,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,yJAAc;IAE5B,qBACE,6LAAC;;0BACC,6LAAC;gBAAG,WAAU;0BAA4C,EAAE;;;;;;0BAC5D,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCAEb,6LAAC;;8CACC,6LAAC;oCAAM,WAAU;;wCACd,EAAE;wCAA4B;;;;;;;8CAEjC,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,oIAAK;4CACJ,MAAK;4CACL,OAAO;4CACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;4CAC7C,aAAa,EAAE;4CACf,WAAU;4CACV,KAAI;4CACJ,MAAK;4CACL,QAAQ;;;;;;sDAEV,6LAAC;4CAAK,WAAU;sDAA2C,+IAAU,CAAC,gBAAgB,CAAC,MAAM;;;;;;;;;;;;;;;;;;sCAKjG,6LAAC;;8CACC,6LAAC;oCAAM,WAAU;8CACd,EAAE;;;;;;8CAEL,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,oIAAK;4CACJ,MAAK;4CACL,OAAO;4CACP,UAAU,CAAC,IAAM,uBAAuB,EAAE,MAAM,CAAC,KAAK;4CACtD,aAAa,EAAE;4CACf,WAAU;4CACV,KAAI;4CACJ,MAAK;;;;;;sDAEP,6LAAC;4CAAK,WAAU;sDAA2C,+IAAU,CAAC,gBAAgB,CAAC,MAAM;;;;;;;;;;;;;;;;;;sCAKjG,6LAAC;;8CACC,6LAAC;oCAAM,WAAU;;wCACd,EAAE;wCAA0B;;;;;;;8CAE/B,6LAAC,oIAAK;oCACJ,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;oCAC3C,aAAa,EAAE;oCACf,WAAU;oCACV,QAAQ;;;;;;;;;;;;sCAKZ,6LAAC;;8CACC,6LAAC;oCAAM,WAAU;;wCACd,EAAE;wCAA+B;;;;;;;8CAEpC,6LAAC,oIAAK;oCACJ,MAAK;oCACL,OAAO;oCACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;oCAChD,aAAa,EAAE;oCACf,WAAU;oCACV,KAAI;oCACJ,QAAQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOtB;GA3FgB;;QAWA,yJAAc;;;KAXd"}},
    {"offset": {"line": 1759, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/lib/colorMap.ts"],"sourcesContent":["// Shared color map for common color names used in filters and admin UI\r\n// This helps render consistent color circles/palette based on color labels.\r\n\r\nconst COLOR_MAP: Record<string, string> = {\r\n  beige: '#F5F5DC',\r\n  black: '#000000',\r\n  blue: '#0000FF',\r\n  brown: '#A52A2A',\r\n  gray: '#808080',\r\n  grey: '#808080',\r\n  green: '#008000',\r\n  red: '#FF0000',\r\n  white: '#FFFFFF',\r\n  yellow: '#FFFF00',\r\n  orange: '#FFA500',\r\n  pink: '#FFC0CB',\r\n  purple: '#800080',\r\n  navy: '#000080',\r\n  maroon: '#800000',\r\n  teal: '#008080',\r\n  cyan: '#00FFFF',\r\n  magenta: '#FF00FF',\r\n  lime: '#00FF00',\r\n  olive: '#808000',\r\n  silver: '#C0C0C0',\r\n  gold: '#FFD700',\r\n  tan: '#D2B48C',\r\n  khaki: '#F0E68C',\r\n  coral: '#FF7F50',\r\n  salmon: '#FA8072',\r\n  turquoise: '#40E0D0',\r\n  violet: '#EE82EE',\r\n  indigo: '#4B0082',\r\n  crimson: '#DC143C',\r\n  lavender: '#E6E6FA',\r\n  peach: '#FFE5B4',\r\n  mint: '#98FB98',\r\n  ivory: '#FFFFF0',\r\n  cream: '#FFFDD0',\r\n};\r\n\r\nexport function getColorHex(colorName: string): string {\r\n  const normalized = colorName.toLowerCase().trim();\r\n  return COLOR_MAP[normalized] || '#CCCCCC';\r\n}\r\n\r\nexport { COLOR_MAP };\r\n\r\n\r\n"],"names":[],"mappings":"AAAA,uEAAuE;AACvE,4EAA4E;;;;;;;AAE5E,MAAM,YAAoC;IACxC,OAAO;IACP,OAAO;IACP,MAAM;IACN,OAAO;IACP,MAAM;IACN,MAAM;IACN,OAAO;IACP,KAAK;IACL,OAAO;IACP,QAAQ;IACR,QAAQ;IACR,MAAM;IACN,QAAQ;IACR,MAAM;IACN,QAAQ;IACR,MAAM;IACN,MAAM;IACN,SAAS;IACT,MAAM;IACN,OAAO;IACP,QAAQ;IACR,MAAM;IACN,KAAK;IACL,OAAO;IACP,OAAO;IACP,QAAQ;IACR,WAAW;IACX,QAAQ;IACR,QAAQ;IACR,SAAS;IACT,UAAU;IACV,OAAO;IACP,MAAM;IACN,OAAO;IACP,OAAO;AACT;AAEO,SAAS,YAAY,SAAiB;IAC3C,MAAM,aAAa,UAAU,WAAW,GAAG,IAAI;IAC/C,OAAO,SAAS,CAAC,WAAW,IAAI;AAClC"}},
    {"offset": {"line": 1816, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/AttributesSelection.tsx"],"sourcesContent":["'use client';\r\n\r\nimport type { RefObject } from 'react';\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\nimport { getColorHex } from '../../../../../lib/colorMap';\r\nimport type { Attribute } from '../types';\r\n\r\ninterface AttributesSelectionProps {\r\n  attributes: Attribute[];\r\n  selectedAttributesForVariants: Set<string>;\r\n  selectedAttributeValueIds: Record<string, string[]>;\r\n  attributesDropdownOpen: boolean;\r\n  attributesDropdownRef: RefObject<HTMLDivElement>;\r\n  onAttributesDropdownToggle: () => void;\r\n  onAttributeToggle: (attributeId: string, checked: boolean) => void;\r\n  onAttributeRemove: (attributeId: string) => void;\r\n}\r\n\r\nexport function AttributesSelection({\r\n  attributes,\r\n  selectedAttributesForVariants,\r\n  selectedAttributeValueIds,\r\n  attributesDropdownOpen,\r\n  attributesDropdownRef,\r\n  onAttributesDropdownToggle,\r\n  onAttributeToggle,\r\n  onAttributeRemove,\r\n}: AttributesSelectionProps) {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">{t('admin.products.add.selectAttributesForVariants')}</h2>\r\n      <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\r\n        <label className=\"block text-sm font-medium text-gray-700 mb-3\">\r\n          {t('admin.products.add.attributes')} <span className=\"text-gray-500 font-normal\">{t('admin.products.add.selectMultiple')}</span>\r\n        </label>\r\n        <div className=\"relative\" ref={attributesDropdownRef}>\r\n          <button\r\n            type=\"button\"\r\n            onClick={onAttributesDropdownToggle}\r\n            className=\"w-full px-3 py-2 text-left border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-sm flex items-center justify-between\"\r\n          >\r\n            <span className=\"text-gray-700\">\r\n              {selectedAttributesForVariants.size === 0\r\n                ? t('admin.products.add.selectAttributes')\r\n                : selectedAttributesForVariants.size === 1\r\n                  ? t('admin.products.add.attributeSelected').replace('{count}', '1')\r\n                  : t('admin.products.add.attributesSelected').replace('{count}', selectedAttributesForVariants.size.toString())}\r\n            </span>\r\n            <svg\r\n              className={`w-4 h-4 text-gray-500 transition-transform duration-200 ${\r\n                attributesDropdownOpen ? 'transform rotate-180' : ''\r\n              }`}\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n            </svg>\r\n          </button>\r\n          {attributesDropdownOpen && (\r\n            <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-96 overflow-y-auto\">\r\n              <div className=\"p-4\">\r\n                <div className=\"mb-3 pb-3 border-b border-gray-200\">\r\n                  <h3 className=\"text-sm font-semibold text-gray-900\">\r\n                    {t('admin.products.add.selectAttributes')}\r\n                  </h3>\r\n                  <p className=\"text-xs text-gray-500 mt-1\">\r\n                    {t('admin.products.add.selectAttributesDescription')}\r\n                  </p>\r\n                </div>\r\n                {attributes.length === 0 ? (\r\n                  <p className=\"text-sm text-gray-500 text-center py-4\">\r\n                    {t('admin.products.add.noAttributesAvailable')}\r\n                  </p>\r\n                ) : (\r\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3\">\r\n                    {attributes.map((attribute) => (\r\n                      <label\r\n                        key={attribute.id}\r\n                        className={`flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-3 rounded-lg border transition-colors ${\r\n                          selectedAttributesForVariants.has(attribute.id)\r\n                            ? 'bg-blue-50 border-blue-300'\r\n                            : 'border-gray-200 bg-white'\r\n                        }`}\r\n                      >\r\n                        <input\r\n                          type=\"checkbox\"\r\n                          checked={selectedAttributesForVariants.has(attribute.id)}\r\n                          onChange={(e) => onAttributeToggle(attribute.id, e.target.checked)}\r\n                          className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n                        />\r\n                        <span className=\"text-sm font-medium text-gray-900\">{attribute.name}</span>\r\n                      </label>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n        {selectedAttributesForVariants.size > 0 && (\r\n          <div className=\"mt-4 pt-4 border-t border-gray-200\">\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {Array.from(selectedAttributesForVariants).map((attributeId) => {\r\n                const attribute = attributes.find(a => a.id === attributeId);\r\n                if (!attribute) return null;\r\n                \r\n                // Get selected values for this attribute to show preview\r\n                const selectedValueIds = selectedAttributeValueIds[attributeId] || [];\r\n                const selectedValues = selectedValueIds\r\n                  .map(id => attribute.values.find(v => v.id === id))\r\n                  .filter((v): v is NonNullable<typeof v> => v !== null);\r\n                \r\n                // Get first selected value's image if available\r\n                const previewImage = selectedValues.find(v => v.imageUrl)?.imageUrl;\r\n                const isColor = attribute.key === 'color';\r\n                const previewColor = isColor && selectedValues.length > 0 \r\n                  ? (selectedValues[0].colors?.[0] || getColorHex(selectedValues[0].label))\r\n                  : null;\r\n                \r\n                return (\r\n                  <span\r\n                    key={attributeId}\r\n                    className=\"inline-flex items-center gap-2 px-3 py-1.5 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium border border-blue-200\"\r\n                  >\r\n                    {previewImage ? (\r\n                      <img\r\n                        src={previewImage}\r\n                        alt={attribute.name}\r\n                        className=\"w-4 h-4 object-cover rounded border border-gray-300\"\r\n                      />\r\n                    ) : previewColor ? (\r\n                      <span\r\n                        className=\"inline-block w-4 h-4 rounded-full border border-gray-300\"\r\n                        style={{ backgroundColor: previewColor }}\r\n                      />\r\n                    ) : null}\r\n                    {attribute.name}\r\n                    {selectedValues.length > 0 && (\r\n                      <span className=\"text-xs text-blue-600\">\r\n                        ({selectedValues.length})\r\n                      </span>\r\n                    )}\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => onAttributeRemove(attributeId)}\r\n                      className=\"ml-1 text-blue-600 hover:text-blue-800 focus:outline-none\"\r\n                    >\r\n                      <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                      </svg>\r\n                    </button>\r\n                  </span>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAGA;AACA;;;AAJA;;;AAkBO,SAAS,oBAAoB,EAClC,UAAU,EACV,6BAA6B,EAC7B,yBAAyB,EACzB,sBAAsB,EACtB,qBAAqB,EACrB,0BAA0B,EAC1B,iBAAiB,EACjB,iBAAiB,EACQ;;IACzB,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,yJAAc;IAE5B,qBACE,6LAAC;;0BACC,6LAAC;gBAAG,WAAU;0BAA4C,EAAE;;;;;;0BAC5D,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAM,WAAU;;4BACd,EAAE;4BAAiC;0CAAC,6LAAC;gCAAK,WAAU;0CAA6B,EAAE;;;;;;;;;;;;kCAEtF,6LAAC;wBAAI,WAAU;wBAAW,KAAK;;0CAC7B,6LAAC;gCACC,MAAK;gCACL,SAAS;gCACT,WAAU;;kDAEV,6LAAC;wCAAK,WAAU;kDACb,8BAA8B,IAAI,KAAK,IACpC,EAAE,yCACF,8BAA8B,IAAI,KAAK,IACrC,EAAE,wCAAwC,OAAO,CAAC,WAAW,OAC7D,EAAE,yCAAyC,OAAO,CAAC,WAAW,8BAA8B,IAAI,CAAC,QAAQ;;;;;;kDAEjH,6LAAC;wCACC,WAAW,CAAC,wDAAwD,EAClE,yBAAyB,yBAAyB,IAClD;wCACF,MAAK;wCACL,QAAO;wCACP,SAAQ;kDAER,cAAA,6LAAC;4CAAK,eAAc;4CAAQ,gBAAe;4CAAQ,aAAa;4CAAG,GAAE;;;;;;;;;;;;;;;;;4BAGxE,wCACC,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAG,WAAU;8DACX,EAAE;;;;;;8DAEL,6LAAC;oDAAE,WAAU;8DACV,EAAE;;;;;;;;;;;;wCAGN,WAAW,MAAM,KAAK,kBACrB,6LAAC;4CAAE,WAAU;sDACV,EAAE;;;;;iEAGL,6LAAC;4CAAI,WAAU;sDACZ,WAAW,GAAG,CAAC,CAAC,0BACf,6LAAC;oDAEC,WAAW,CAAC,oGAAoG,EAC9G,8BAA8B,GAAG,CAAC,UAAU,EAAE,IAC1C,+BACA,4BACJ;;sEAEF,6LAAC;4DACC,MAAK;4DACL,SAAS,8BAA8B,GAAG,CAAC,UAAU,EAAE;4DACvD,UAAU,CAAC,IAAM,kBAAkB,UAAU,EAAE,EAAE,EAAE,MAAM,CAAC,OAAO;4DACjE,WAAU;;;;;;sEAEZ,6LAAC;4DAAK,WAAU;sEAAqC,UAAU,IAAI;;;;;;;mDAb9D,UAAU,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;oBAsBhC,8BAA8B,IAAI,GAAG,mBACpC,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;sCACZ,MAAM,IAAI,CAAC,+BAA+B,GAAG,CAAC,CAAC;gCAC9C,MAAM,YAAY,WAAW,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;gCAChD,IAAI,CAAC,WAAW,OAAO;gCAEvB,yDAAyD;gCACzD,MAAM,mBAAmB,yBAAyB,CAAC,YAAY,IAAI,EAAE;gCACrE,MAAM,iBAAiB,iBACpB,GAAG,CAAC,CAAA,KAAM,UAAU,MAAM,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,KAC9C,MAAM,CAAC,CAAC,IAAkC,MAAM;gCAEnD,gDAAgD;gCAChD,MAAM,eAAe,eAAe,IAAI,CAAC,CAAA,IAAK,EAAE,QAAQ,GAAG;gCAC3D,MAAM,UAAU,UAAU,GAAG,KAAK;gCAClC,MAAM,eAAe,WAAW,eAAe,MAAM,GAAG,IACnD,cAAc,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,EAAE,IAAI,IAAA,gJAAW,EAAC,cAAc,CAAC,EAAE,CAAC,KAAK,IACrE;gCAEJ,qBACE,6LAAC;oCAEC,WAAU;;wCAET,6BACC,6LAAC;4CACC,KAAK;4CACL,KAAK,UAAU,IAAI;4CACnB,WAAU;;;;;mDAEV,6BACF,6LAAC;4CACC,WAAU;4CACV,OAAO;gDAAE,iBAAiB;4CAAa;;;;;mDAEvC;wCACH,UAAU,IAAI;wCACd,eAAe,MAAM,GAAG,mBACvB,6LAAC;4CAAK,WAAU;;gDAAwB;gDACpC,eAAe,MAAM;gDAAC;;;;;;;sDAG5B,6LAAC;4CACC,MAAK;4CACL,SAAS,IAAM,kBAAkB;4CACjC,WAAU;sDAEV,cAAA,6LAAC;gDAAI,WAAU;gDAAU,MAAK;gDAAO,QAAO;gDAAe,SAAQ;0DACjE,cAAA,6LAAC;oDAAK,eAAc;oDAAQ,gBAAe;oDAAQ,aAAa;oDAAG,GAAE;;;;;;;;;;;;;;;;;mCA3BpE;;;;;4BAgCX;;;;;;;;;;;;;;;;;;;;;;;AAOd;GAjJgB;;QAUA,yJAAc;;;KAVd"}},
    {"offset": {"line": 2116, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/VariantBuilder.tsx"],"sourcesContent":["'use client';\r\n\r\nimport type { ChangeEvent, RefObject } from 'react';\r\nimport { Button, Input } from '@shop/ui';\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\nimport { getColorHex } from '../../../../../lib/colorMap';\r\nimport { CURRENCIES, type CurrencyCode } from '../../../../../lib/currency';\r\nimport type { Attribute, GeneratedVariant } from '../types';\r\n\r\ninterface VariantBuilderProps {\r\n  generatedVariants: GeneratedVariant[];\r\n  attributes: Attribute[];\r\n  selectedAttributesForVariants: Set<string>;\r\n  isEditMode: boolean;\r\n  hasVariantsToLoad: boolean;\r\n  defaultCurrency: CurrencyCode;\r\n  imageUploadLoading: boolean;\r\n  slug: string;\r\n  title: string;\r\n  variantImageInputRefs: RefObject<Record<string, HTMLInputElement | null>>;\r\n  onVariantUpdate: (updater: (prev: GeneratedVariant[]) => GeneratedVariant[]) => void;\r\n  onVariantDelete: (variantId: string) => void;\r\n  onVariantAdd: () => void;\r\n  onApplyToAll: (field: 'price' | 'compareAtPrice' | 'stock' | 'sku', value: string) => void;\r\n  onVariantImageUpload: (variantId: string, event: ChangeEvent<HTMLInputElement>) => void;\r\n  onOpenValueModal: (modal: { variantId: string; attributeId: string } | null) => void;\r\n  generateSlug: (title: string) => string;\r\n}\r\n\r\nexport function VariantBuilder({\r\n  generatedVariants,\r\n  attributes,\r\n  selectedAttributesForVariants,\r\n  isEditMode,\r\n  hasVariantsToLoad,\r\n  defaultCurrency,\r\n  imageUploadLoading,\r\n  slug,\r\n  title,\r\n  variantImageInputRefs,\r\n  onVariantUpdate,\r\n  onVariantDelete,\r\n  onVariantAdd,\r\n  onApplyToAll,\r\n  onVariantImageUpload,\r\n  onOpenValueModal,\r\n  generateSlug,\r\n}: VariantBuilderProps) {\r\n  const { t } = useTranslation();\r\n\r\n  // Get attributes to show in table header\r\n  const getAttributesToShow = (variant?: GeneratedVariant) => {\r\n    if (selectedAttributesForVariants.size > 0) {\r\n      return Array.from(selectedAttributesForVariants);\r\n    }\r\n    if (isEditMode && variant) {\r\n      // Extract unique attribute IDs from this variant's values\r\n      const attrIds = new Set<string>();\r\n      variant.selectedValueIds.forEach((valueId) => {\r\n        const attr = attributes.find((a) => a.values.some((v) => v.id === valueId));\r\n        if (attr) attrIds.add(attr.id);\r\n      });\r\n      return Array.from(attrIds);\r\n    }\r\n    return [];\r\n  };\r\n\r\n  const attributesToShow = generatedVariants.length > 0 ? getAttributesToShow(generatedVariants[0]) : [];\r\n\r\n  return (\r\n    <div>\r\n      <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">{t('admin.products.add.variantBuilder')}</h2>\r\n      <div className=\"bg-white border border-gray-200 rounded-lg p-6 space-y-6\">\r\n        {/* Generated Variants Table */}\r\n        {generatedVariants.length > 0 && (\r\n          <div>\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-lg font-semibold text-gray-900\">\r\n                {t('admin.products.add.generatedVariants')} ({generatedVariants.length.toString()})\r\n              </h3>\r\n              <div className=\"flex gap-2\">\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => {\r\n                    const price = prompt(t('admin.products.add.enterDefaultPrice'));\r\n                    if (price !== null) {\r\n                      onApplyToAll('price', price);\r\n                    }\r\n                  }}\r\n                >\r\n                  {t('admin.products.add.applyPriceToAll')}\r\n                </Button>\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => {\r\n                    const stock = prompt(t('admin.products.add.enterDefaultStock'));\r\n                    if (stock !== null) {\r\n                      onApplyToAll('stock', stock);\r\n                    }\r\n                  }}\r\n                >\r\n                  {t('admin.products.add.applyStockToAll')}\r\n                </Button>\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => {\r\n                    const skuPrefix = prompt(t('admin.products.add.enterSkuPrefix'));\r\n                    if (skuPrefix !== null) {\r\n                      const baseSlug = skuPrefix || slug || generateSlug(title) || 'PROD';\r\n                      onVariantUpdate((prev) =>\r\n                        prev.map((variant) => {\r\n                          const valueParts: string[] = [];\r\n                          Array.from(selectedAttributesForVariants).forEach((attributeId) => {\r\n                            const attribute = attributes.find((a) => a.id === attributeId);\r\n                            if (!attribute) return;\r\n\r\n                            const selectedIds = variant.selectedValueIds.filter((id) =>\r\n                              attribute.values.some((v) => v.id === id)\r\n                            );\r\n\r\n                            selectedIds.forEach((valueId) => {\r\n                              const value = attribute.values.find((v) => v.id === valueId);\r\n                              if (value) {\r\n                                valueParts.push(value.value.toUpperCase().replace(/\\s+/g, '-'));\r\n                              }\r\n                            });\r\n                          });\r\n\r\n                          const sku =\r\n                            valueParts.length > 0\r\n                              ? `${baseSlug.toUpperCase()}-${valueParts.join('-')}`\r\n                              : `${baseSlug.toUpperCase()}`;\r\n\r\n                          return { ...variant, sku };\r\n                        })\r\n                      );\r\n                    }\r\n                  }}\r\n                >\r\n                  {t('admin.products.add.applySkuToAll')}\r\n                </Button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"border border-gray-300 rounded-lg\" style={{ overflowX: 'hidden', overflowY: 'hidden' }}>\r\n              <table className=\"w-full divide-y divide-gray-200 bg-white\">\r\n                <thead className=\"bg-gray-50\">\r\n                  <tr>\r\n                    {attributesToShow.map((attributeId) => {\r\n                      const attribute = attributes.find((a) => a.id === attributeId);\r\n                      return attribute ? (\r\n                        <th\r\n                          key={attributeId}\r\n                          className=\"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\r\n                        >\r\n                          {attribute.name}\r\n                        </th>\r\n                      ) : null;\r\n                    })}\r\n                    <th className=\"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      {t('admin.products.add.price')}\r\n                    </th>\r\n                    <th className=\"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      {t('admin.products.add.compareAtPrice')}\r\n                    </th>\r\n                    <th className=\"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      {t('admin.products.add.stock')}\r\n                    </th>\r\n                    <th className=\"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      {t('admin.products.add.sku')}\r\n                    </th>\r\n                    <th className=\"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                      {t('admin.products.add.image')}\r\n                    </th>\r\n                    <th className=\"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20\">\r\n                      {t('admin.products.add.actions') || 'Actions'}\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                  {generatedVariants.map((variant) => {\r\n                    const variantAttributesToShow = getAttributesToShow(variant);\r\n\r\n                    return (\r\n                      <tr key={variant.id} className=\"hover:bg-gray-50\">\r\n                        {variantAttributesToShow.map((attributeId) => {\r\n                          const attribute = attributes.find((a) => a.id === attributeId);\r\n                          if (!attribute) return null;\r\n\r\n                          const isColor = attribute.key === 'color';\r\n                          const selectedValueIds = variant.selectedValueIds.filter((id) => {\r\n                            return attribute.values.some((v) => v.id === id);\r\n                          });\r\n                          const selectedValues = selectedValueIds\r\n                            .map((valueId) => {\r\n                              const value = attribute.values.find((v) => v.id === valueId);\r\n                              return value\r\n                                ? {\r\n                                    id: value.id,\r\n                                    label: value.label,\r\n                                    value: value.value,\r\n                                    colorHex: isColor ? (value.colors?.[0] || getColorHex(value.label)) : null,\r\n                                    imageUrl: value.imageUrl || null,\r\n                                  }\r\n                                : null;\r\n                            })\r\n                            .filter((v): v is NonNullable<typeof v> => v !== null);\r\n\r\n                          return (\r\n                            <td key={attributeId} className=\"px-2 py-2 whitespace-nowrap\">\r\n                              <div className=\"relative\">\r\n                                <button\r\n                                  type=\"button\"\r\n                                  onClick={() => {\r\n                                    onOpenValueModal({ variantId: variant.id, attributeId });\r\n                                  }}\r\n                                  className=\"w-full text-left flex items-center gap-1 p-1.5 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                                >\r\n                                  <div className=\"flex-1 flex flex-wrap items-center gap-1 min-w-0\">\r\n                                    {selectedValues.length > 0 ? (\r\n                                      selectedValues.map((val) => (\r\n                                        <span\r\n                                          key={val.id}\r\n                                          className=\"inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-blue-50 text-blue-700 rounded text-xs\"\r\n                                        >\r\n                                          {val.imageUrl ? (\r\n                                            <img\r\n                                              src={val.imageUrl}\r\n                                              alt={val.label}\r\n                                              className=\"w-3 h-3 object-cover rounded border border-gray-300\"\r\n                                            />\r\n                                          ) : isColor && val.colorHex ? (\r\n                                            <span\r\n                                              className=\"inline-block w-3 h-3 rounded-full border border-gray-300\"\r\n                                              style={{ backgroundColor: val.colorHex }}\r\n                                            />\r\n                                          ) : null}\r\n                                          {val.label}\r\n                                        </span>\r\n                                      ))\r\n                                    ) : (\r\n                                      <span className=\"text-xs text-gray-500\">{t('admin.products.add.valuesPlaceholder')}</span>\r\n                                    )}\r\n                                  </div>\r\n                                  <svg\r\n                                    className=\"w-3 h-3 text-gray-400 transition-transform flex-shrink-0\"\r\n                                    fill=\"none\"\r\n                                    stroke=\"currentColor\"\r\n                                    viewBox=\"0 0 24 24\"\r\n                                  >\r\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n                                  </svg>\r\n                                </button>\r\n                              </div>\r\n                            </td>\r\n                          );\r\n                        })}\r\n                        <td className=\"px-2 py-2 whitespace-nowrap\">\r\n                          <div className=\"flex items-center gap-1\">\r\n                            <Input\r\n                              type=\"number\"\r\n                              value={variant.price}\r\n                              onChange={(e) => {\r\n                                onVariantUpdate((prev) =>\r\n                                  prev.map((v) => (v.id === variant.id ? { ...v, price: e.target.value } : v))\r\n                                );\r\n                              }}\r\n                              placeholder={t('admin.products.add.pricePlaceholder')}\r\n                              className=\"w-20 text-xs\"\r\n                              min=\"0\"\r\n                              step=\"0.01\"\r\n                            />\r\n                            <span className=\"text-xs text-gray-500\">{CURRENCIES[defaultCurrency].symbol}</span>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-2 py-2 whitespace-nowrap\">\r\n                          <div className=\"flex items-center gap-1\">\r\n                            <Input\r\n                              type=\"number\"\r\n                              value={variant.compareAtPrice}\r\n                              onChange={(e) => {\r\n                                onVariantUpdate((prev) =>\r\n                                  prev.map((v) => (v.id === variant.id ? { ...v, compareAtPrice: e.target.value } : v))\r\n                                );\r\n                              }}\r\n                              placeholder={t('admin.products.add.pricePlaceholder')}\r\n                              className=\"w-20 text-xs\"\r\n                              min=\"0\"\r\n                              step=\"0.01\"\r\n                            />\r\n                            <span className=\"text-xs text-gray-500\">{CURRENCIES[defaultCurrency].symbol}</span>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-2 py-2 whitespace-nowrap\">\r\n                          <Input\r\n                            type=\"number\"\r\n                            value={variant.stock}\r\n                            onChange={(e) => {\r\n                              onVariantUpdate((prev) =>\r\n                                prev.map((v) => (v.id === variant.id ? { ...v, stock: e.target.value } : v))\r\n                              );\r\n                            }}\r\n                            placeholder={t('admin.products.add.quantityPlaceholder')}\r\n                            className=\"w-16 text-xs\"\r\n                            min=\"0\"\r\n                          />\r\n                        </td>\r\n                        <td className=\"px-2 py-2 whitespace-nowrap\">\r\n                          <Input\r\n                            type=\"text\"\r\n                            value={variant.sku}\r\n                            onChange={(e) => {\r\n                              onVariantUpdate((prev) =>\r\n                                prev.map((v) => (v.id === variant.id ? { ...v, sku: e.target.value } : v))\r\n                              );\r\n                            }}\r\n                            placeholder={t('admin.products.add.autoGenerated')}\r\n                            className=\"w-24 text-xs\"\r\n                          />\r\n                        </td>\r\n                        <td className=\"px-2 py-2 whitespace-nowrap\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            {variant.image ? (\r\n                              <div className=\"relative inline-block\">\r\n                                <img\r\n                                  src={variant.image}\r\n                                  alt=\"Variant image\"\r\n                                  className=\"w-12 h-12 object-cover border border-gray-300 rounded-md\"\r\n                                />\r\n                                <button\r\n                                  type=\"button\"\r\n                                  onClick={() => {\r\n                                    onVariantUpdate((prev) =>\r\n                                      prev.map((v) => (v.id === variant.id ? { ...v, image: null } : v))\r\n                                    );\r\n                                    if (variantImageInputRefs.current?.[variant.id]) {\r\n                                      variantImageInputRefs.current[variant.id]!.value = '';\r\n                                    }\r\n                                  }}\r\n                                  className=\"absolute -top-1 -right-1 bg-red-500 text-white rounded-full p-0.5 hover:bg-red-600 transition-colors\"\r\n                                  title={t('admin.products.add.removeImage')}\r\n                                >\r\n                                  <svg className=\"w-2.5 h-2.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                                  </svg>\r\n                                </button>\r\n                              </div>\r\n                            ) : (\r\n                              <button\r\n                                type=\"button\"\r\n                                onClick={() => variantImageInputRefs.current?.[variant.id]?.click()}\r\n                                disabled={imageUploadLoading}\r\n                                className=\"px-2 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1\"\r\n                              >\r\n                                <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4v16m8-8H4\" />\r\n                                </svg>\r\n                                <span className=\"hidden sm:inline\">\r\n                                  {imageUploadLoading ? t('admin.products.add.uploading') : t('admin.products.add.uploadImage')}\r\n                                </span>\r\n                                <span className=\"sm:hidden\">+</span>\r\n                              </button>\r\n                            )}\r\n                            <input\r\n                              ref={(el) => {\r\n                                if (variantImageInputRefs.current) {\r\n                                  variantImageInputRefs.current[variant.id] = el;\r\n                                }\r\n                              }}\r\n                              type=\"file\"\r\n                              accept=\"image/*\"\r\n                              onChange={(e) => onVariantImageUpload(variant.id, e)}\r\n                              className=\"hidden\"\r\n                            />\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"px-2 py-2 whitespace-nowrap\">\r\n                          <button\r\n                            type=\"button\"\r\n                            onClick={() => onVariantDelete(variant.id)}\r\n                            className=\"px-2 py-1 text-xs font-medium text-red-700 bg-red-50 border border-red-300 rounded-md hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors flex items-center gap-1\"\r\n                            title={t('admin.products.add.deleteVariant') || 'Delete variant'}\r\n                          >\r\n                            <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                              <path\r\n                                strokeLinecap=\"round\"\r\n                                strokeLinejoin=\"round\"\r\n                                strokeWidth={2}\r\n                                d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"\r\n                              />\r\n                            </svg>\r\n                            {t('admin.products.add.delete') || 'Delete'}\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n\r\n            <div className=\"mt-4 flex justify-end gap-2\">\r\n              <Button type=\"button\" variant=\"outline\" onClick={onVariantAdd}>\r\n                {t('admin.products.add.addVariant') || 'Add'}\r\n              </Button>\r\n              <Button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  console.log(' [VARIANT BUILDER] Variants ready for submission:', generatedVariants);\r\n                }}\r\n              >\r\n                {t('admin.products.add.variantsReady') || 'Variants Ready'}\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2857, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/ProductLabels.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { Button, Input } from '@shop/ui';\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\nimport type { ProductLabel } from '../types';\r\n\r\ninterface ProductLabelsProps {\r\n  labels: ProductLabel[];\r\n  onAddLabel: () => void;\r\n  onRemoveLabel: (index: number) => void;\r\n  onUpdateLabel: (index: number, field: keyof ProductLabel, value: any) => void;\r\n}\r\n\r\nexport function ProductLabels({ labels, onAddLabel, onRemoveLabel, onUpdateLabel }: ProductLabelsProps) {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <h2 className=\"text-xl font-semibold text-gray-900\">{t('admin.products.add.productLabels')}</h2>\r\n        <Button type=\"button\" variant=\"outline\" onClick={onAddLabel}>\r\n          {t('admin.products.add.addLabel')}\r\n        </Button>\r\n      </div>\r\n      {labels.length === 0 ? (\r\n        <div className=\"text-center py-4 border-2 border-dashed border-gray-300 rounded-lg\">\r\n          <p className=\"text-gray-500 mb-2\">{t('admin.products.add.noLabelsAdded')}</p>\r\n          <p className=\"text-sm text-gray-400\">{t('admin.products.add.addLabelsHint')}</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"space-y-4\">\r\n          {labels.map((label, index) => (\r\n            <div key={index} className=\"border border-gray-200 rounded-lg p-4 bg-gray-50\">\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <h3 className=\"text-lg font-medium text-gray-900\">\r\n                  {t('admin.products.add.label').replace('{index}', (index + 1).toString())}\r\n                </h3>\r\n                <Button type=\"button\" variant=\"ghost\" onClick={() => onRemoveLabel(index)} className=\"text-red-600 hover:text-red-700\">\r\n                  {t('admin.products.add.remove')}\r\n                </Button>\r\n              </div>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                {/* Label Type */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                    {t('admin.products.add.type')} *\r\n                  </label>\r\n                  <select\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    value={label.type}\r\n                    onChange={(e) => onUpdateLabel(index, 'type', e.target.value as 'text' | 'percentage')}\r\n                    required\r\n                  >\r\n                    <option value=\"text\">{t('admin.products.add.textType')}</option>\r\n                    <option value=\"percentage\">{t('admin.products.add.percentageType')}</option>\r\n                  </select>\r\n                </div>\r\n\r\n                {/* Label Value */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                    {t('admin.products.add.value')} *\r\n                  </label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    value={label.value}\r\n                    onChange={(e) => onUpdateLabel(index, 'value', e.target.value)}\r\n                    placeholder={\r\n                      label.type === 'percentage' ? t('admin.products.add.percentagePlaceholder') : t('admin.products.add.newProductLabel')\r\n                    }\r\n                    required\r\n                    className=\"w-full\"\r\n                  />\r\n                  {label.type === 'percentage' && (\r\n                    <p className=\"mt-1 text-xs text-blue-600 font-medium\">{t('admin.products.add.percentageAutoUpdateHint')}</p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Label Position */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                    {t('admin.products.add.position')} *\r\n                  </label>\r\n                  <select\r\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    value={label.position}\r\n                    onChange={(e) => onUpdateLabel(index, 'position', e.target.value)}\r\n                    required\r\n                  >\r\n                    <option value=\"top-left\">{t('admin.products.add.topLeft')}</option>\r\n                    <option value=\"top-right\">{t('admin.products.add.topRight')}</option>\r\n                    <option value=\"bottom-left\">{t('admin.products.add.bottomLeft')}</option>\r\n                    <option value=\"bottom-right\">{t('admin.products.add.bottomRight')}</option>\r\n                  </select>\r\n                </div>\r\n\r\n                {/* Label Color (Optional) */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                    {t('admin.products.add.colorOptional')}\r\n                  </label>\r\n                  <Input\r\n                    type=\"text\"\r\n                    value={label.color || ''}\r\n                    onChange={(e) => onUpdateLabel(index, 'color', e.target.value || null)}\r\n                    placeholder={t('admin.products.add.colorHexPlaceholder')}\r\n                    className=\"w-full\"\r\n                  />\r\n                  <p className=\"mt-1 text-xs text-gray-500\">{t('admin.products.add.hexColorHint')}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AACA;;;AAHA;;;AAaO,SAAS,cAAc,EAAE,MAAM,EAAE,UAAU,EAAE,aAAa,EAAE,aAAa,EAAsB;;IACpG,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,yJAAc;IAE5B,qBACE,6LAAC;;0BACC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAAuC,EAAE;;;;;;kCACvD,6LAAC,sIAAM;wBAAC,MAAK;wBAAS,SAAQ;wBAAU,SAAS;kCAC9C,EAAE;;;;;;;;;;;;YAGN,OAAO,MAAM,KAAK,kBACjB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAE,WAAU;kCAAsB,EAAE;;;;;;kCACrC,6LAAC;wBAAE,WAAU;kCAAyB,EAAE;;;;;;;;;;;qCAG1C,6LAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,OAAO,sBAClB,6LAAC;wBAAgB,WAAU;;0CACzB,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAG,WAAU;kDACX,EAAE,4BAA4B,OAAO,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE,QAAQ;;;;;;kDAExE,6LAAC,sIAAM;wCAAC,MAAK;wCAAS,SAAQ;wCAAQ,SAAS,IAAM,cAAc;wCAAQ,WAAU;kDAClF,EAAE;;;;;;;;;;;;0CAGP,6LAAC;gCAAI,WAAU;;kDAEb,6LAAC;;0DACC,6LAAC;gDAAM,WAAU;;oDACd,EAAE;oDAA2B;;;;;;;0DAEhC,6LAAC;gDACC,WAAU;gDACV,OAAO,MAAM,IAAI;gDACjB,UAAU,CAAC,IAAM,cAAc,OAAO,QAAQ,EAAE,MAAM,CAAC,KAAK;gDAC5D,QAAQ;;kEAER,6LAAC;wDAAO,OAAM;kEAAQ,EAAE;;;;;;kEACxB,6LAAC;wDAAO,OAAM;kEAAc,EAAE;;;;;;;;;;;;;;;;;;kDAKlC,6LAAC;;0DACC,6LAAC;gDAAM,WAAU;;oDACd,EAAE;oDAA4B;;;;;;;0DAEjC,6LAAC,oIAAK;gDACJ,MAAK;gDACL,OAAO,MAAM,KAAK;gDAClB,UAAU,CAAC,IAAM,cAAc,OAAO,SAAS,EAAE,MAAM,CAAC,KAAK;gDAC7D,aACE,MAAM,IAAI,KAAK,eAAe,EAAE,8CAA8C,EAAE;gDAElF,QAAQ;gDACR,WAAU;;;;;;4CAEX,MAAM,IAAI,KAAK,8BACd,6LAAC;gDAAE,WAAU;0DAA0C,EAAE;;;;;;;;;;;;kDAK7D,6LAAC;;0DACC,6LAAC;gDAAM,WAAU;;oDACd,EAAE;oDAA+B;;;;;;;0DAEpC,6LAAC;gDACC,WAAU;gDACV,OAAO,MAAM,QAAQ;gDACrB,UAAU,CAAC,IAAM,cAAc,OAAO,YAAY,EAAE,MAAM,CAAC,KAAK;gDAChE,QAAQ;;kEAER,6LAAC;wDAAO,OAAM;kEAAY,EAAE;;;;;;kEAC5B,6LAAC;wDAAO,OAAM;kEAAa,EAAE;;;;;;kEAC7B,6LAAC;wDAAO,OAAM;kEAAe,EAAE;;;;;;kEAC/B,6LAAC;wDAAO,OAAM;kEAAgB,EAAE;;;;;;;;;;;;;;;;;;kDAKpC,6LAAC;;0DACC,6LAAC;gDAAM,WAAU;0DACd,EAAE;;;;;;0DAEL,6LAAC,oIAAK;gDACJ,MAAK;gDACL,OAAO,MAAM,KAAK,IAAI;gDACtB,UAAU,CAAC,IAAM,cAAc,OAAO,SAAS,EAAE,MAAM,CAAC,KAAK,IAAI;gDACjE,aAAa,EAAE;gDACf,WAAU;;;;;;0DAEZ,6LAAC;gDAAE,WAAU;0DAA8B,EAAE;;;;;;;;;;;;;;;;;;;uBA5EzC;;;;;;;;;;;;;;;;AAqFtB;GAxGgB;;QACA,yJAAc;;;KADd"}},
    {"offset": {"line": 3186, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/ValueSelectionModal.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { Button } from '@shop/ui';\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\nimport { getColorHex } from '../../../../../lib/colorMap';\r\nimport type { Attribute, GeneratedVariant } from '../types';\r\n\r\ninterface ValueSelectionModalProps {\r\n  openValueModal: { variantId: string; attributeId: string } | null;\r\n  variant: GeneratedVariant | undefined;\r\n  attribute: Attribute | undefined;\r\n  onClose: () => void;\r\n  onVariantUpdate: (updater: (prev: GeneratedVariant[]) => GeneratedVariant[]) => void;\r\n  onAttributeValueIdsUpdate: (updater: (prev: Record<string, string[]>) => Record<string, string[]>) => void;\r\n  selectedAttributeValueIds: Record<string, string[]>;\r\n}\r\n\r\nexport function ValueSelectionModal({\r\n  openValueModal,\r\n  variant,\r\n  attribute,\r\n  onClose,\r\n  onVariantUpdate,\r\n  onAttributeValueIdsUpdate,\r\n  selectedAttributeValueIds,\r\n}: ValueSelectionModalProps) {\r\n  const { t } = useTranslation();\r\n\r\n  if (!openValueModal || !variant || !attribute) return null;\r\n\r\n  const isColor = attribute.key === 'color';\r\n  const selectedValueIds = variant.selectedValueIds.filter((id) => {\r\n    return attribute.values.some((v) => v.id === id);\r\n  });\r\n\r\n  const handleSelectAll = (checked: boolean) => {\r\n    const isAutoVariant = variant.id === 'variant-all';\r\n\r\n    if (checked) {\r\n      // Select all values\r\n      const allValueIds = attribute.values.map((v) => v.id);\r\n      // Add to variant's selectedValueIds (merge with existing)\r\n      const currentIds = variant.selectedValueIds;\r\n      const newIds = [...new Set([...currentIds, ...allValueIds])];\r\n\r\n      // Update variant - merge with existing selectedValueIds\r\n      onVariantUpdate((prev) => prev.map((v) => (v.id === variant.id ? { ...v, selectedValueIds: newIds } : v)));\r\n\r\n      // Only update selectedAttributeValueIds for auto-generated variant\r\n      if (isAutoVariant) {\r\n        onAttributeValueIdsUpdate((prev) => ({\r\n          ...prev,\r\n          [openValueModal.attributeId]: allValueIds,\r\n        }));\r\n      }\r\n    } else {\r\n      // Deselect all values for this attribute\r\n      const valueIdsToRemove = attribute.values.map((v) => v.id);\r\n      const newIds = variant.selectedValueIds.filter((id) => !valueIdsToRemove.includes(id));\r\n\r\n      onVariantUpdate((prev) => prev.map((v) => (v.id === variant.id ? { ...v, selectedValueIds: newIds } : v)));\r\n\r\n      // Only update selectedAttributeValueIds for auto-generated variant\r\n      if (isAutoVariant) {\r\n        onAttributeValueIdsUpdate((prev) => ({\r\n          ...prev,\r\n          [openValueModal.attributeId]: [],\r\n        }));\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleValueToggle = (valueId: string, checked: boolean) => {\r\n    const isAutoVariant = variant.id === 'variant-all';\r\n    const currentIds = variant.selectedValueIds;\r\n    let newIds: string[];\r\n\r\n    if (checked) {\r\n      // Add value if not already selected\r\n      newIds = [...currentIds, valueId];\r\n    } else {\r\n      // Remove value\r\n      newIds = currentIds.filter((id) => id !== valueId);\r\n    }\r\n\r\n    // Update variant first (to preserve dropdown state)\r\n    onVariantUpdate((prev) => {\r\n      const updated = prev.map((v) => (v.id === variant.id ? { ...v, selectedValueIds: newIds } : v));\r\n      console.log(' [VARIANT BUILDER] Value selection updated:', {\r\n        variantId: variant.id,\r\n        isAutoVariant,\r\n        valueId,\r\n        action: checked ? 'added' : 'removed',\r\n        newSelectedIds: newIds.length,\r\n        totalVariants: updated.length,\r\n      });\r\n      return updated;\r\n    });\r\n\r\n    // Only update selectedAttributeValueIds for auto-generated variant\r\n    if (isAutoVariant) {\r\n      const currentAttrIds = selectedAttributeValueIds[openValueModal.attributeId] || [];\r\n      let newAttrIds: string[];\r\n      if (checked) {\r\n        newAttrIds = [...currentAttrIds, valueId];\r\n      } else {\r\n        newAttrIds = currentAttrIds.filter((id) => id !== valueId);\r\n      }\r\n\r\n      onAttributeValueIdsUpdate((prev) => ({\r\n        ...prev,\r\n        [openValueModal.attributeId]: newAttrIds,\r\n      }));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\"\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        className=\"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto\"\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white z-10\">\r\n          <h3 className=\"text-xl font-semibold text-gray-900\">\r\n            {t('admin.products.add.selectValues')} {attribute.name}\r\n          </h3>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n            aria-label=\"Close\"\r\n          >\r\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"p-6\">\r\n          {/* \"All\" option */}\r\n          <label className=\"flex items-center gap-2 p-2 rounded-lg cursor-pointer hover:bg-gray-50 mb-3 border border-gray-200\">\r\n            <input\r\n              type=\"checkbox\"\r\n              checked={attribute.values.length > 0 && selectedValueIds.length === attribute.values.length}\r\n              onChange={(e) => handleSelectAll(e.target.checked)}\r\n              className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500\"\r\n            />\r\n            <span className=\"text-sm font-medium text-gray-900\">All</span>\r\n          </label>\r\n\r\n          <div className=\"border-t border-gray-200 my-3\"></div>\r\n\r\n          {/* Individual value checkboxes - grid layout */}\r\n          <div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2\">\r\n            {attribute.values.map((value) => {\r\n              const isSelected = variant.selectedValueIds.includes(value.id);\r\n              const valueColorHex =\r\n                isColor && value.colors && value.colors.length > 0\r\n                  ? value.colors[0]\r\n                  : isColor\r\n                    ? getColorHex(value.label)\r\n                    : null;\r\n\r\n              return (\r\n                <label\r\n                  key={value.id}\r\n                  className={`flex flex-col items-center gap-1.5 p-2 rounded-lg cursor-pointer transition-all border-2 ${\r\n                    isSelected\r\n                      ? 'bg-blue-50 border-blue-600'\r\n                      : 'bg-gray-50 border-transparent hover:bg-gray-100 hover:border-gray-300'\r\n                  }`}\r\n                >\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={isSelected}\r\n                    onChange={(e) => handleValueToggle(value.id, e.target.checked)}\r\n                    className=\"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 flex-shrink-0\"\r\n                  />\r\n                  {/* Display image, color, or nothing */}\r\n                  {value.imageUrl ? (\r\n                    <img\r\n                      src={value.imageUrl}\r\n                      alt={value.label}\r\n                      className=\"w-8 h-8 object-cover rounded border border-gray-300 flex-shrink-0\"\r\n                    />\r\n                  ) : isColor && valueColorHex ? (\r\n                    <span\r\n                      className=\"inline-block w-6 h-6 rounded-full border-2 border-gray-300 shadow-sm flex-shrink-0\"\r\n                      style={{ backgroundColor: valueColorHex }}\r\n                    />\r\n                  ) : null}\r\n                  <span className=\"text-xs font-medium text-gray-900 text-center\">{value.label}</span>\r\n                </label>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex items-center justify-end gap-3 p-6 border-t border-gray-200 sticky bottom-0 bg-white\">\r\n          <Button type=\"button\" variant=\"outline\" onClick={onClose}>\r\n            {t('admin.common.close')}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;;;AAJA;;;;AAiBO,SAAS,oBAAoB,EAClC,cAAc,EACd,OAAO,EACP,SAAS,EACT,OAAO,EACP,eAAe,EACf,yBAAyB,EACzB,yBAAyB,EACA;;IACzB,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,yJAAc;IAE5B,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,WAAW,OAAO;IAEtD,MAAM,UAAU,UAAU,GAAG,KAAK;IAClC,MAAM,mBAAmB,QAAQ,gBAAgB,CAAC,MAAM,CAAC,CAAC;QACxD,OAAO,UAAU,MAAM,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAC/C;IAEA,MAAM,kBAAkB,CAAC;QACvB,MAAM,gBAAgB,QAAQ,EAAE,KAAK;QAErC,IAAI,SAAS;YACX,oBAAoB;YACpB,MAAM,cAAc,UAAU,MAAM,CAAC,GAAG,CAAC,CAAC,IAAM,EAAE,EAAE;YACpD,0DAA0D;YAC1D,MAAM,aAAa,QAAQ,gBAAgB;YAC3C,MAAM,SAAS;mBAAI,IAAI,IAAI;uBAAI;uBAAe;iBAAY;aAAE;YAE5D,wDAAwD;YACxD,gBAAgB,CAAC,OAAS,KAAK,GAAG,CAAC,CAAC,IAAO,EAAE,EAAE,KAAK,QAAQ,EAAE,GAAG;wBAAE,GAAG,CAAC;wBAAE,kBAAkB;oBAAO,IAAI;YAEtG,mEAAmE;YACnE,IAAI,eAAe;gBACjB,0BAA0B,CAAC,OAAS,CAAC;wBACnC,GAAG,IAAI;wBACP,CAAC,eAAe,WAAW,CAAC,EAAE;oBAChC,CAAC;YACH;QACF,OAAO;YACL,yCAAyC;YACzC,MAAM,mBAAmB,UAAU,MAAM,CAAC,GAAG,CAAC,CAAC,IAAM,EAAE,EAAE;YACzD,MAAM,SAAS,QAAQ,gBAAgB,CAAC,MAAM,CAAC,CAAC,KAAO,CAAC,iBAAiB,QAAQ,CAAC;YAElF,gBAAgB,CAAC,OAAS,KAAK,GAAG,CAAC,CAAC,IAAO,EAAE,EAAE,KAAK,QAAQ,EAAE,GAAG;wBAAE,GAAG,CAAC;wBAAE,kBAAkB;oBAAO,IAAI;YAEtG,mEAAmE;YACnE,IAAI,eAAe;gBACjB,0BAA0B,CAAC,OAAS,CAAC;wBACnC,GAAG,IAAI;wBACP,CAAC,eAAe,WAAW,CAAC,EAAE,EAAE;oBAClC,CAAC;YACH;QACF;IACF;IAEA,MAAM,oBAAoB,CAAC,SAAiB;QAC1C,MAAM,gBAAgB,QAAQ,EAAE,KAAK;QACrC,MAAM,aAAa,QAAQ,gBAAgB;QAC3C,IAAI;QAEJ,IAAI,SAAS;YACX,oCAAoC;YACpC,SAAS;mBAAI;gBAAY;aAAQ;QACnC,OAAO;YACL,eAAe;YACf,SAAS,WAAW,MAAM,CAAC,CAAC,KAAO,OAAO;QAC5C;QAEA,oDAAoD;QACpD,gBAAgB,CAAC;YACf,MAAM,UAAU,KAAK,GAAG,CAAC,CAAC,IAAO,EAAE,EAAE,KAAK,QAAQ,EAAE,GAAG;oBAAE,GAAG,CAAC;oBAAE,kBAAkB;gBAAO,IAAI;YAC5F,QAAQ,GAAG,CAAC,gDAAgD;gBAC1D,WAAW,QAAQ,EAAE;gBACrB;gBACA;gBACA,QAAQ,UAAU,UAAU;gBAC5B,gBAAgB,OAAO,MAAM;gBAC7B,eAAe,QAAQ,MAAM;YAC/B;YACA,OAAO;QACT;QAEA,mEAAmE;QACnE,IAAI,eAAe;YACjB,MAAM,iBAAiB,yBAAyB,CAAC,eAAe,WAAW,CAAC,IAAI,EAAE;YAClF,IAAI;YACJ,IAAI,SAAS;gBACX,aAAa;uBAAI;oBAAgB;iBAAQ;YAC3C,OAAO;gBACL,aAAa,eAAe,MAAM,CAAC,CAAC,KAAO,OAAO;YACpD;YAEA,0BAA0B,CAAC,OAAS,CAAC;oBACnC,GAAG,IAAI;oBACP,CAAC,eAAe,WAAW,CAAC,EAAE;gBAChC,CAAC;QACH;IACF;IAEA,qBACE,6LAAC;QACC,WAAU;QACV,SAAS;kBAET,cAAA,6LAAC;YACC,WAAU;YACV,SAAS,CAAC,IAAM,EAAE,eAAe;;8BAGjC,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;;gCACX,EAAE;gCAAmC;gCAAE,UAAU,IAAI;;;;;;;sCAExD,6LAAC;4BACC,SAAS;4BACT,WAAU;4BACV,cAAW;sCAEX,cAAA,6LAAC;gCAAI,WAAU;gCAAU,MAAK;gCAAO,QAAO;gCAAe,SAAQ;0CACjE,cAAA,6LAAC;oCAAK,eAAc;oCAAQ,gBAAe;oCAAQ,aAAa;oCAAG,GAAE;;;;;;;;;;;;;;;;;;;;;;8BAM3E,6LAAC;oBAAI,WAAU;;sCAEb,6LAAC;4BAAM,WAAU;;8CACf,6LAAC;oCACC,MAAK;oCACL,SAAS,UAAU,MAAM,CAAC,MAAM,GAAG,KAAK,iBAAiB,MAAM,KAAK,UAAU,MAAM,CAAC,MAAM;oCAC3F,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,OAAO;oCACjD,WAAU;;;;;;8CAEZ,6LAAC;oCAAK,WAAU;8CAAoC;;;;;;;;;;;;sCAGtD,6LAAC;4BAAI,WAAU;;;;;;sCAGf,6LAAC;4BAAI,WAAU;sCACZ,UAAU,MAAM,CAAC,GAAG,CAAC,CAAC;gCACrB,MAAM,aAAa,QAAQ,gBAAgB,CAAC,QAAQ,CAAC,MAAM,EAAE;gCAC7D,MAAM,gBACJ,WAAW,MAAM,MAAM,IAAI,MAAM,MAAM,CAAC,MAAM,GAAG,IAC7C,MAAM,MAAM,CAAC,EAAE,GACf,UACE,IAAA,gJAAW,EAAC,MAAM,KAAK,IACvB;gCAER,qBACE,6LAAC;oCAEC,WAAW,CAAC,yFAAyF,EACnG,aACI,+BACA,yEACJ;;sDAEF,6LAAC;4CACC,MAAK;4CACL,SAAS;4CACT,UAAU,CAAC,IAAM,kBAAkB,MAAM,EAAE,EAAE,EAAE,MAAM,CAAC,OAAO;4CAC7D,WAAU;;;;;;wCAGX,MAAM,QAAQ,iBACb,6LAAC;4CACC,KAAK,MAAM,QAAQ;4CACnB,KAAK,MAAM,KAAK;4CAChB,WAAU;;;;;mDAEV,WAAW,8BACb,6LAAC;4CACC,WAAU;4CACV,OAAO;gDAAE,iBAAiB;4CAAc;;;;;mDAExC;sDACJ,6LAAC;4CAAK,WAAU;sDAAiD,MAAM,KAAK;;;;;;;mCA1BvE,MAAM,EAAE;;;;;4BA6BnB;;;;;;;;;;;;8BAKJ,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC,sIAAM;wBAAC,MAAK;wBAAS,SAAQ;wBAAU,SAAS;kCAC9C,EAAE;;;;;;;;;;;;;;;;;;;;;;AAMf;GAlMgB;;QASA,yJAAc;;;KATd"}},
    {"offset": {"line": 3499, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/Publishing.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\n\r\ninterface PublishingProps {\r\n  featured: boolean;\r\n  onFeaturedChange: (featured: boolean) => void;\r\n}\r\n\r\nexport function Publishing({ featured, onFeaturedChange }: PublishingProps) {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <div>\r\n      <div className=\"space-y-2\">\r\n        <label className=\"flex items-center\">\r\n          <input\r\n            type=\"checkbox\"\r\n            checked={featured}\r\n            onChange={(e) => onFeaturedChange(e.target.checked)}\r\n            className=\"mr-2\"\r\n          />\r\n          <span className=\"text-sm font-medium text-gray-700 flex items-center gap-1\">\r\n            <span aria-hidden=\"true\"></span>\r\n            {t('admin.products.add.markAsFeatured')}\r\n          </span>\r\n        </label>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AASO,SAAS,WAAW,EAAE,QAAQ,EAAE,gBAAgB,EAAmB;;IACxE,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,yJAAc;IAE5B,qBACE,6LAAC;kBACC,cAAA,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAM,WAAU;;kCACf,6LAAC;wBACC,MAAK;wBACL,SAAS;wBACT,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,OAAO;wBAClD,WAAU;;;;;;kCAEZ,6LAAC;wBAAK,WAAU;;0CACd,6LAAC;gCAAK,eAAY;0CAAO;;;;;;4BACxB,EAAE;;;;;;;;;;;;;;;;;;;;;;;AAMf;GArBgB;;QACA,yJAAc;;;KADd"}},
    {"offset": {"line": 3578, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/FormActions.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { Button } from '@shop/ui';\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface FormActionsProps {\r\n  loading: boolean;\r\n  isEditMode: boolean;\r\n}\r\n\r\nexport function FormActions({ loading, isEditMode }: FormActionsProps) {\r\n  const { t } = useTranslation();\r\n  const router = useRouter();\r\n\r\n  return (\r\n    <div className=\"sticky bottom-0 left-0 right-0 z-50 bg-white border-t border-gray-200 shadow-lg -mx-6 -mb-6 px-6 py-4 mt-8 backdrop-blur-sm bg-white/95\">\r\n      <div className=\"flex flex-col sm:flex-row gap-3 sm:gap-4 max-w-full\">\r\n        <Button\r\n          type=\"submit\"\r\n          variant=\"primary\"\r\n          disabled={loading}\r\n          className=\"flex-1 w-full sm:w-auto order-2 sm:order-1\"\r\n        >\r\n          {loading\r\n            ? isEditMode\r\n              ? t('admin.products.add.updating')\r\n              : t('admin.products.add.creating')\r\n            : isEditMode\r\n              ? t('admin.products.add.updateProduct')\r\n              : t('admin.products.add.createProduct')}\r\n        </Button>\r\n        <Button\r\n          type=\"button\"\r\n          variant=\"outline\"\r\n          onClick={() => router.push('/admin/products')}\r\n          className=\"w-full sm:w-auto order-1 sm:order-2\"\r\n        >\r\n          {t('admin.common.cancel')}\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;;;AAJA;;;;AAWO,SAAS,YAAY,EAAE,OAAO,EAAE,UAAU,EAAoB;;IACnE,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,yJAAc;IAC5B,MAAM,SAAS,IAAA,kJAAS;IAExB,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC,sIAAM;oBACL,MAAK;oBACL,SAAQ;oBACR,UAAU;oBACV,WAAU;8BAET,UACG,aACE,EAAE,iCACF,EAAE,iCACJ,aACE,EAAE,sCACF,EAAE;;;;;;8BAEV,6LAAC,sIAAM;oBACL,MAAK;oBACL,SAAQ;oBACR,SAAS,IAAM,OAAO,IAAI,CAAC;oBAC3B,WAAU;8BAET,EAAE;;;;;;;;;;;;;;;;;AAKb;GAhCgB;;QACA,yJAAc;QACb,kJAAS;;;KAFV"}},
    {"offset": {"line": 3652, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/components/PageHeader.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useRouter } from 'next/navigation';\r\nimport { useTranslation } from '../../../../../lib/i18n-client';\r\n\r\ninterface PageHeaderProps {\r\n  isEditMode: boolean;\r\n}\r\n\r\nexport function PageHeader({ isEditMode }: PageHeaderProps) {\r\n  const { t } = useTranslation();\r\n  const router = useRouter();\r\n\r\n  return (\r\n    <div className=\"mb-8\">\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <button\r\n          onClick={() => router.push('/admin')}\r\n          className=\"text-gray-600 hover:text-gray-900 flex items-center\"\r\n        >\r\n          <svg className=\"w-5 h-5 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\r\n          </svg>\r\n          {t('admin.products.add.backToAdmin')}\r\n        </button>\r\n      </div>\r\n      <h1 className=\"text-3xl font-bold text-gray-900\">\r\n        {isEditMode ? t('admin.products.add.editProduct') : t('admin.products.add.addNewProduct')}\r\n      </h1>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AASO,SAAS,WAAW,EAAE,UAAU,EAAmB;;IACxD,MAAM,EAAE,CAAC,EAAE,GAAG,IAAA,yJAAc;IAC5B,MAAM,SAAS,IAAA,kJAAS;IAExB,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBACC,SAAS,IAAM,OAAO,IAAI,CAAC;oBAC3B,WAAU;;sCAEV,6LAAC;4BAAI,WAAU;4BAAe,MAAK;4BAAO,QAAO;4BAAe,SAAQ;sCACtE,cAAA,6LAAC;gCAAK,eAAc;gCAAQ,gBAAe;gCAAQ,aAAa;gCAAG,GAAE;;;;;;;;;;;wBAEtE,EAAE;;;;;;;;;;;;0BAGP,6LAAC;gBAAG,WAAU;0BACX,aAAa,EAAE,oCAAoC,EAAE;;;;;;;;;;;;AAI9D;GAtBgB;;QACA,yJAAc;QACb,kJAAS;;;KAFV"}},
    {"offset": {"line": 3740, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/hooks/useLabelManagement.ts"],"sourcesContent":["'use client';\r\n\r\nimport type { ProductLabel } from '../types';\r\n\r\ninterface UseLabelManagementReturn {\r\n  addLabel: () => void;\r\n  removeLabel: (index: number) => void;\r\n  updateLabel: (index: number, field: keyof ProductLabel, value: any) => void;\r\n}\r\n\r\nexport function useLabelManagement(\r\n  labels: ProductLabel[],\r\n  setLabels: (updater: (prev: ProductLabel[]) => ProductLabel[]) => void\r\n): UseLabelManagementReturn {\r\n  const addLabel = () => {\r\n    const newLabel: ProductLabel = {\r\n      type: 'text',\r\n      value: '',\r\n      position: 'top-left',\r\n      color: null,\r\n    };\r\n    setLabels((prev) => [...prev, newLabel]);\r\n  };\r\n\r\n  const removeLabel = (index: number) => {\r\n    setLabels((prev) => prev.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const updateLabel = (index: number, field: keyof ProductLabel, value: any) => {\r\n    setLabels((prev) => {\r\n      const newLabels = [...prev];\r\n      newLabels[index] = { ...newLabels[index], [field]: value };\r\n      return newLabels;\r\n    });\r\n  };\r\n\r\n  return {\r\n    addLabel,\r\n    removeLabel,\r\n    updateLabel,\r\n  };\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AAUO,SAAS,mBACd,MAAsB,EACtB,SAAsE;IAEtE,MAAM,WAAW;QACf,MAAM,WAAyB;YAC7B,MAAM;YACN,OAAO;YACP,UAAU;YACV,OAAO;QACT;QACA,UAAU,CAAC,OAAS;mBAAI;gBAAM;aAAS;IACzC;IAEA,MAAM,cAAc,CAAC;QACnB,UAAU,CAAC,OAAS,KAAK,MAAM,CAAC,CAAC,GAAG,IAAM,MAAM;IAClD;IAEA,MAAM,cAAc,CAAC,OAAe,OAA2B;QAC7D,UAAU,CAAC;YACT,MAAM,YAAY;mBAAI;aAAK;YAC3B,SAAS,CAAC,MAAM,GAAG;gBAAE,GAAG,SAAS,CAAC,MAAM;gBAAE,CAAC,MAAM,EAAE;YAAM;YACzD,OAAO;QACT;IACF;IAEA,OAAO;QACL;QACA;QACA;IACF;AACF"}},
    {"offset": {"line": 3786, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/hooks/useImageHandling.ts"],"sourcesContent":["'use client';\r\n\r\nimport type { ChangeEvent } from 'react';\r\nimport { processImageFile } from '../../../../../lib/utils/image-utils';\r\nimport type { Variant, ColorData } from '../types';\r\nimport type { GeneratedVariant } from '../types';\r\n\r\ninterface UseImageHandlingProps {\r\n  imageUrls: string[];\r\n  featuredImageIndex: number;\r\n  variants: Variant[];\r\n  generatedVariants: GeneratedVariant[];\r\n  colorImageTarget: { variantId: string; colorValue: string } | null;\r\n  setImageUrls: (updater: (prev: string[]) => string[]) => void;\r\n  setFeaturedImageIndex: (index: number) => void;\r\n  setMainProductImage: (image: string) => void;\r\n  setVariants: (updater: (prev: Variant[]) => Variant[]) => void;\r\n  setGeneratedVariants: (updater: (prev: GeneratedVariant[]) => GeneratedVariant[]) => void;\r\n  setImageUploadLoading: (loading: boolean) => void;\r\n  setImageUploadError: (error: string | null) => void;\r\n  setColorImageTarget: (target: { variantId: string; colorValue: string } | null) => void;\r\n  t: (key: string) => string;\r\n}\r\n\r\ninterface UseImageHandlingReturn {\r\n  addImageUrl: () => void;\r\n  removeImageUrl: (index: number) => void;\r\n  updateImageUrl: (index: number, url: string) => void;\r\n  setFeaturedImage: (index: number) => void;\r\n  handleUploadImages: (event: ChangeEvent<HTMLInputElement>) => Promise<void>;\r\n  handleUploadVariantImage: (variantId: string, event: ChangeEvent<HTMLInputElement>) => Promise<void>;\r\n  handleUploadColorImages: (event: ChangeEvent<HTMLInputElement>) => Promise<void>;\r\n  addColorImages: (variantId: string, colorValue: string, images: string[]) => void;\r\n}\r\n\r\nexport function useImageHandling({\r\n  imageUrls,\r\n  featuredImageIndex,\r\n  variants,\r\n  generatedVariants,\r\n  colorImageTarget,\r\n  setImageUrls,\r\n  setFeaturedImageIndex,\r\n  setMainProductImage,\r\n  setVariants,\r\n  setGeneratedVariants,\r\n  setImageUploadLoading,\r\n  setImageUploadError,\r\n  setColorImageTarget,\r\n  t,\r\n}: UseImageHandlingProps): UseImageHandlingReturn {\r\n  const addImageUrl = () => {\r\n    setImageUrls((prev) => [...prev, '']);\r\n  };\r\n\r\n  const removeImageUrl = (index: number) => {\r\n    setImageUrls((prev) => {\r\n      const newUrls = prev.filter((_, i) => i !== index);\r\n      let newFeaturedIndex = featuredImageIndex;\r\n      if (index === featuredImageIndex) {\r\n        newFeaturedIndex = 0;\r\n      } else if (index < featuredImageIndex) {\r\n        newFeaturedIndex = Math.max(0, featuredImageIndex - 1);\r\n      }\r\n      const finalFeaturedIndex = newUrls.length === 0 ? 0 : Math.min(newFeaturedIndex, newUrls.length - 1);\r\n      const mainImage = newUrls.length > 0 && newUrls[finalFeaturedIndex] ? newUrls[finalFeaturedIndex] : '';\r\n      setFeaturedImageIndex(finalFeaturedIndex);\r\n      setMainProductImage(mainImage);\r\n      return newUrls;\r\n    });\r\n  };\r\n\r\n  const updateImageUrl = (index: number, url: string) => {\r\n    setImageUrls((prev) => {\r\n      const newUrls = [...prev];\r\n      newUrls[index] = url;\r\n      return newUrls;\r\n    });\r\n  };\r\n\r\n  const setFeaturedImage = (index: number) => {\r\n    if (index < 0 || index >= imageUrls.length) {\r\n      return;\r\n    }\r\n    const mainImage = imageUrls[index] || '';\r\n    setFeaturedImageIndex(index);\r\n    setMainProductImage(mainImage);\r\n  };\r\n\r\n  const addColorImages = (variantId: string, colorValue: string, images: string[]) => {\r\n    console.log(' [ADMIN] Adding images to color:', {\r\n      variantId,\r\n      colorValue,\r\n      imagesCount: images.length,\r\n    });\r\n\r\n    setVariants((prev) =>\r\n      prev.map((v) => {\r\n        if (v.id === variantId) {\r\n          const updatedColors = v.colors.map((c) => {\r\n            if (c.colorValue === colorValue) {\r\n              const uniqueNewImages = images.filter((newImg) => !c.images.includes(newImg));\r\n              const newImages = [...c.images, ...uniqueNewImages];\r\n              return { ...c, images: newImages };\r\n            }\r\n            return c;\r\n          });\r\n          return { ...v, colors: updatedColors };\r\n        }\r\n        return v;\r\n      })\r\n    );\r\n  };\r\n\r\n  const handleUploadImages = async (event: ChangeEvent<HTMLInputElement>) => {\r\n    const files = Array.from(event.target.files || []);\r\n    if (files.length === 0) {\r\n      return;\r\n    }\r\n\r\n    console.log(' [UPLOAD] Starting upload of', files.length, 'image(s)');\r\n    setImageUploadLoading(true);\r\n    setImageUploadError(null);\r\n    try {\r\n      const uploadedImages: string[] = [];\r\n      const errors: string[] = [];\r\n\r\n      const filePromises = files.map(async (file, index) => {\r\n        try {\r\n          if (!file.type.startsWith('image/')) {\r\n            const errorMsg = `\"${file.name}\" is not an image file`;\r\n            console.warn(` [UPLOAD] Skipping non-image file ${index + 1}/${files.length}:`, file.name);\r\n            return { success: false, error: errorMsg, index };\r\n          }\r\n\r\n          console.log(` [UPLOAD] Processing file ${index + 1}/${files.length}:`, file.name, `(${Math.round(file.size / 1024)}KB)`);\r\n\r\n          const base64 = await processImageFile(file, {\r\n            maxSizeMB: 2,\r\n            maxWidthOrHeight: 1920,\r\n            useWebWorker: true,\r\n            fileType: 'image/jpeg',\r\n            initialQuality: 0.8,\r\n          });\r\n\r\n          if (base64 && base64.trim()) {\r\n            console.log(` [UPLOAD] Successfully processed file ${index + 1}/${files.length}:`, file.name);\r\n            return { success: true, base64, index };\r\n          } else {\r\n            const errorMsg = `Failed to convert \"${file.name}\" to base64`;\r\n            console.error(` [UPLOAD] Empty base64 result for file ${index + 1}/${files.length}:`, file.name);\r\n            return { success: false, error: errorMsg, index };\r\n          }\r\n        } catch (error: any) {\r\n          const errorMsg = `Error processing \"${file.name}\": ${error?.message || 'Unknown error'}`;\r\n          console.error(` [UPLOAD] Error processing file ${index + 1}/${files.length}:`, file.name, error);\r\n          return { success: false, error: errorMsg, index };\r\n        }\r\n      });\r\n\r\n      const results = await Promise.allSettled(filePromises);\r\n\r\n      results.forEach((result) => {\r\n        if (result.status === 'fulfilled') {\r\n          const fileResult = result.value;\r\n          if (fileResult.success && fileResult.base64) {\r\n            uploadedImages.push(fileResult.base64);\r\n          } else if (!fileResult.success && fileResult.error) {\r\n            errors.push(fileResult.error);\r\n          }\r\n        } else {\r\n          const errorMsg = `Failed to process file: ${result.reason?.message || 'Unknown error'}`;\r\n          errors.push(errorMsg);\r\n          console.error(` [UPLOAD] Promise rejected:`, result.reason);\r\n        }\r\n      });\r\n\r\n      console.log(' [UPLOAD] Upload complete. Processed:', uploadedImages.length, 'of', files.length, 'files');\r\n      if (errors.length > 0) {\r\n        console.warn(' [UPLOAD] Errors during upload:', errors);\r\n        setImageUploadError(errors.join('; '));\r\n      }\r\n\r\n      if (uploadedImages.length === 0) {\r\n        setImageUploadError(t('admin.products.add.failedToProcessImages') || 'Failed to process images');\r\n        return;\r\n      }\r\n\r\n      setImageUrls((prev) => {\r\n        const newImageUrls = [...prev, ...uploadedImages];\r\n        const newFeaturedIdx = prev.length === 0 ? 0 : featuredImageIndex;\r\n        if (prev.length === 0 && newImageUrls.length > 0) {\r\n          setFeaturedImageIndex(0);\r\n          setMainProductImage(newImageUrls[0]);\r\n        }\r\n        return newImageUrls;\r\n      });\r\n    } catch (error: any) {\r\n      console.error(' [UPLOAD] Fatal error during upload:', error);\r\n      setImageUploadError(error?.message || t('admin.products.add.failedToProcessImages'));\r\n    } finally {\r\n      setImageUploadLoading(false);\r\n      if (event.target) {\r\n        event.target.value = '';\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleUploadVariantImage = async (variantId: string, event: ChangeEvent<HTMLInputElement>) => {\r\n    const files = Array.from(event.target.files || []);\r\n    if (files.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const file = files[0];\r\n    if (!file.type.startsWith('image/')) {\r\n      setImageUploadError(`\"${file.name}\" is not an image file`);\r\n      if (event.target) {\r\n        event.target.value = '';\r\n      }\r\n      return;\r\n    }\r\n\r\n    setImageUploadLoading(true);\r\n    setImageUploadError(null);\r\n    try {\r\n      console.log(' [VARIANT IMAGE] Processing variant image:', {\r\n        variantId,\r\n        fileName: file.name,\r\n        originalSize: `${Math.round(file.size / 1024)}KB`,\r\n      });\r\n\r\n      const base64 = await processImageFile(file, {\r\n        maxSizeMB: 2,\r\n        maxWidthOrHeight: 1920,\r\n        useWebWorker: true,\r\n        fileType: 'image/jpeg',\r\n        initialQuality: 0.8,\r\n      });\r\n\r\n      setGeneratedVariants((prev) => prev.map((v) => (v.id === variantId ? { ...v, image: base64 } : v)));\r\n      console.log(' [VARIANT BUILDER] Variant image uploaded and processed for variant:', variantId);\r\n    } catch (error: any) {\r\n      console.error(' [VARIANT IMAGE] Error processing variant image:', error);\r\n      setImageUploadError(error?.message || t('admin.products.add.failedToProcessImage'));\r\n    } finally {\r\n      setImageUploadLoading(false);\r\n      if (event.target) {\r\n        event.target.value = '';\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleUploadColorImages = async (event: ChangeEvent<HTMLInputElement>) => {\r\n    const files = Array.from(event.target.files || []);\r\n    if (!files.length || !colorImageTarget) {\r\n      console.log(' [ADMIN] No files or no color target:', { filesLength: files.length, colorImageTarget });\r\n      if (event.target) {\r\n        event.target.value = '';\r\n      }\r\n      return;\r\n    }\r\n\r\n    const imageFiles = files.filter((file) => file.type.startsWith('image/'));\r\n    if (imageFiles.length === 0) {\r\n      if (event.target) {\r\n        event.target.value = '';\r\n      }\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setImageUploadLoading(true);\r\n      console.log(' [ADMIN] Starting upload for color:', colorImageTarget.colorValue, 'Files:', imageFiles.length);\r\n\r\n      const uploadedImages = await Promise.all(\r\n        imageFiles.map(async (file, index) => {\r\n          console.log(` [COLOR IMAGE] Processing image ${index + 1}/${imageFiles.length}:`, {\r\n            fileName: file.name,\r\n            originalSize: `${Math.round(file.size / 1024)}KB`,\r\n          });\r\n\r\n          const base64 = await processImageFile(file, {\r\n            maxSizeMB: 2,\r\n            maxWidthOrHeight: 1920,\r\n            useWebWorker: true,\r\n            fileType: 'image/jpeg',\r\n            initialQuality: 0.8,\r\n          });\r\n\r\n          console.log(` [COLOR IMAGE] Image ${index + 1}/${imageFiles.length} processed, base64 length:`, base64.length);\r\n          return base64;\r\n        })\r\n      );\r\n\r\n      console.log(' [ADMIN] All images processed, adding to variant:', {\r\n        variantId: colorImageTarget.variantId,\r\n        colorValue: colorImageTarget.colorValue,\r\n        imagesCount: uploadedImages.length,\r\n      });\r\n\r\n      addColorImages(colorImageTarget.variantId, colorImageTarget.colorValue, uploadedImages);\r\n      console.log(' [ADMIN] Color images added to state:', uploadedImages.length);\r\n    } catch (error: any) {\r\n      console.error(' [ADMIN] Error uploading color images:', error);\r\n      setImageUploadError(error?.message || t('admin.products.add.failedToProcessImages'));\r\n    } finally {\r\n      setImageUploadLoading(false);\r\n      if (event.target) {\r\n        event.target.value = '';\r\n      }\r\n      setColorImageTarget(null);\r\n    }\r\n  };\r\n\r\n  return {\r\n    addImageUrl,\r\n    removeImageUrl,\r\n    updateImageUrl,\r\n    setFeaturedImage,\r\n    handleUploadImages,\r\n    handleUploadVariantImage,\r\n    handleUploadColorImages,\r\n    addColorImages,\r\n  };\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4081, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/utils/productUtils.ts"],"sourcesContent":["/**\r\n * Utility functions for product management\r\n */\r\n\r\nexport const generateSlug = (title: string): string => {\r\n  return title\r\n    .toLowerCase()\r\n    .trim()\r\n    .replace(/[^\\w\\s-|]/g, '') // Allow pipe character (|) in slug\r\n    .replace(/[\\s_-]+/g, '-')\r\n    .replace(/^-+|-+$/g, '');\r\n};\r\n\r\n/**\r\n * Generate all combinations of selected attribute values\r\n */\r\nexport const generateAttributeCombinations = (attributeValueGroups: string[][]): string[][] => {\r\n  if (attributeValueGroups.length === 0) {\r\n    return [[]];\r\n  }\r\n  if (attributeValueGroups.length === 1) {\r\n    return attributeValueGroups[0].map((value) => [value]);\r\n  }\r\n  const [firstGroup, ...restGroups] = attributeValueGroups;\r\n  const restCombinations = generateAttributeCombinations(restGroups);\r\n  const result: string[][] = [];\r\n  for (const value of firstGroup) {\r\n    for (const combination of restCombinations) {\r\n      result.push([value, ...combination]);\r\n    }\r\n  }\r\n  return result;\r\n};\r\n\r\n/**\r\n * Check if a category requires sizes\r\n */\r\nexport const isClothingCategory = (primaryCategoryId: string, categories: Array<{ id: string; requiresSizes?: boolean }>): boolean => {\r\n  if (!primaryCategoryId) {\r\n    return false;\r\n  }\r\n  \r\n  const selectedCategory = categories.find((cat) => cat.id === primaryCategoryId);\r\n  if (!selectedCategory) {\r\n    return false;\r\n  }\r\n  \r\n  return selectedCategory.requiresSizes === true;\r\n};\r\n\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;;;AAEM,MAAM,eAAe,CAAC;IAC3B,OAAO,MACJ,WAAW,GACX,IAAI,GACJ,OAAO,CAAC,cAAc,IAAI,mCAAmC;KAC7D,OAAO,CAAC,YAAY,KACpB,OAAO,CAAC,YAAY;AACzB;AAKO,MAAM,gCAAgC,CAAC;IAC5C,IAAI,qBAAqB,MAAM,KAAK,GAAG;QACrC,OAAO;YAAC,EAAE;SAAC;IACb;IACA,IAAI,qBAAqB,MAAM,KAAK,GAAG;QACrC,OAAO,oBAAoB,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,QAAU;gBAAC;aAAM;IACvD;IACA,MAAM,CAAC,YAAY,GAAG,WAAW,GAAG;IACpC,MAAM,mBAAmB,8BAA8B;IACvD,MAAM,SAAqB,EAAE;IAC7B,KAAK,MAAM,SAAS,WAAY;QAC9B,KAAK,MAAM,eAAe,iBAAkB;YAC1C,OAAO,IAAI,CAAC;gBAAC;mBAAU;aAAY;QACrC;IACF;IACA,OAAO;AACT;AAKO,MAAM,qBAAqB,CAAC,mBAA2B;IAC5D,IAAI,CAAC,mBAAmB;QACtB,OAAO;IACT;IAEA,MAAM,mBAAmB,WAAW,IAAI,CAAC,CAAC,MAAQ,IAAI,EAAE,KAAK;IAC7D,IAAI,CAAC,kBAAkB;QACrB,OAAO;IACT;IAEA,OAAO,iBAAiB,aAAa,KAAK;AAC5C"}},
    {"offset": {"line": 4136, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/hooks/useVariantGeneration.ts"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect } from 'react';\r\nimport type { Attribute, GeneratedVariant } from '../types';\r\nimport { generateSlug } from '../utils/productUtils';\r\n\r\ninterface UseVariantGenerationProps {\r\n  selectedAttributesForVariants: Set<string>;\r\n  selectedAttributeValueIds: Record<string, string[]>;\r\n  attributes: Attribute[];\r\n  generatedVariants: GeneratedVariant[];\r\n  formDataSlug: string;\r\n  formDataTitle: string;\r\n  isEditMode: boolean;\r\n  productId: string | null;\r\n  setGeneratedVariants: (updater: (prev: GeneratedVariant[]) => GeneratedVariant[]) => void;\r\n}\r\n\r\nexport function useVariantGeneration({\r\n  selectedAttributesForVariants,\r\n  selectedAttributeValueIds,\r\n  attributes,\r\n  generatedVariants,\r\n  formDataSlug,\r\n  formDataTitle,\r\n  isEditMode,\r\n  productId,\r\n  setGeneratedVariants,\r\n}: UseVariantGenerationProps) {\r\n  const generateVariantsFromAttributes = () => {\r\n    console.log(' [VARIANT BUILDER] Generating single variant with all attributes...');\r\n\r\n    const selectedAttrs = Array.from(selectedAttributesForVariants);\r\n    if (selectedAttrs.length === 0) {\r\n      console.log(' [VARIANT BUILDER] No attributes selected');\r\n      setGeneratedVariants([]);\r\n      return;\r\n    }\r\n\r\n    setGeneratedVariants((prev) => {\r\n      const manuallyAddedVariants = prev.filter((v) => v.id !== 'variant-all');\r\n      const existingAutoVariant = prev.find((v) => v.id === 'variant-all');\r\n\r\n      if (manuallyAddedVariants.length > 0) {\r\n        console.log(' [VARIANT BUILDER] Manual variants exist, skipping auto-generated variant');\r\n        return manuallyAddedVariants;\r\n      }\r\n\r\n      const variantId = 'variant-all';\r\n      const allSelectedValueIds: string[] = [];\r\n      selectedAttrs.forEach((attributeId) => {\r\n        const selectedIds = selectedAttributeValueIds[attributeId] || [];\r\n        allSelectedValueIds.push(...selectedIds);\r\n      });\r\n\r\n      const baseSlug = formDataSlug || generateSlug(formDataTitle) || 'PROD';\r\n      let sku = `${baseSlug}`;\r\n\r\n      if (allSelectedValueIds.length > 0) {\r\n        const valueParts: string[] = [];\r\n        selectedAttrs.forEach((attributeId) => {\r\n          const attribute = attributes.find((a) => a.id === attributeId);\r\n          if (!attribute) return;\r\n\r\n          const selectedIds = selectedAttributeValueIds[attributeId] || [];\r\n          selectedIds.forEach((valueId) => {\r\n            const value = attribute.values.find((v) => v.id === valueId);\r\n            if (value) {\r\n              valueParts.push(value.value.toUpperCase().replace(/\\s+/g, '-'));\r\n            }\r\n          });\r\n        });\r\n\r\n        if (valueParts.length > 0) {\r\n          sku = `${baseSlug}-${valueParts.join('-')}`;\r\n        }\r\n      }\r\n\r\n      const autoVariant: GeneratedVariant = {\r\n        id: variantId,\r\n        selectedValueIds: allSelectedValueIds,\r\n        price: existingAutoVariant?.price || '',\r\n        compareAtPrice: existingAutoVariant?.compareAtPrice || '',\r\n        stock: existingAutoVariant?.stock || '',\r\n        sku: existingAutoVariant?.sku || sku,\r\n        image: existingAutoVariant?.image || null,\r\n      };\r\n\r\n      const result = [autoVariant];\r\n      console.log(' [VARIANT BUILDER] Variants updated:', {\r\n        manuallyAdded: 0,\r\n        autoGenerated: 1,\r\n        total: result.length,\r\n      });\r\n      return result;\r\n    });\r\n\r\n    console.log(' [VARIANT BUILDER] Single variant generated with', selectedAttrs.length, 'attributes');\r\n  };\r\n\r\n  const applyToAllVariants = (field: 'price' | 'compareAtPrice' | 'stock' | 'sku', value: string) => {\r\n    setGeneratedVariants((prev) =>\r\n      prev.map((variant) => ({\r\n        ...variant,\r\n        [field]: value,\r\n      }))\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isEditMode && productId && (window as any).__productVariantsToConvert) {\r\n      return;\r\n    }\r\n\r\n    if (selectedAttributesForVariants.size > 0) {\r\n      generateVariantsFromAttributes();\r\n    } else {\r\n      if (!isEditMode) {\r\n        setGeneratedVariants([]);\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [selectedAttributesForVariants, selectedAttributeValueIds, attributes, formDataSlug, formDataTitle, isEditMode, productId]);\r\n\r\n  return {\r\n    generateVariantsFromAttributes,\r\n    applyToAllVariants,\r\n  };\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAEA;AAEA;;AAJA;;;AAkBO,SAAS,qBAAqB,EACnC,6BAA6B,EAC7B,yBAAyB,EACzB,UAAU,EACV,iBAAiB,EACjB,YAAY,EACZ,aAAa,EACb,UAAU,EACV,SAAS,EACT,oBAAoB,EACM;;IAC1B,MAAM,iCAAiC;QACrC,QAAQ,GAAG,CAAC;QAEZ,MAAM,gBAAgB,MAAM,IAAI,CAAC;QACjC,IAAI,cAAc,MAAM,KAAK,GAAG;YAC9B,QAAQ,GAAG,CAAC;YACZ,qBAAqB,EAAE;YACvB;QACF;QAEA,qBAAqB,CAAC;YACpB,MAAM,wBAAwB,KAAK,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;YAC1D,MAAM,sBAAsB,KAAK,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;YAEtD,IAAI,sBAAsB,MAAM,GAAG,GAAG;gBACpC,QAAQ,GAAG,CAAC;gBACZ,OAAO;YACT;YAEA,MAAM,YAAY;YAClB,MAAM,sBAAgC,EAAE;YACxC,cAAc,OAAO,CAAC,CAAC;gBACrB,MAAM,cAAc,yBAAyB,CAAC,YAAY,IAAI,EAAE;gBAChE,oBAAoB,IAAI,IAAI;YAC9B;YAEA,MAAM,WAAW,gBAAgB,IAAA,0LAAY,EAAC,kBAAkB;YAChE,IAAI,MAAM,GAAG,UAAU;YAEvB,IAAI,oBAAoB,MAAM,GAAG,GAAG;gBAClC,MAAM,aAAuB,EAAE;gBAC/B,cAAc,OAAO,CAAC,CAAC;oBACrB,MAAM,YAAY,WAAW,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;oBAClD,IAAI,CAAC,WAAW;oBAEhB,MAAM,cAAc,yBAAyB,CAAC,YAAY,IAAI,EAAE;oBAChE,YAAY,OAAO,CAAC,CAAC;wBACnB,MAAM,QAAQ,UAAU,MAAM,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;wBACpD,IAAI,OAAO;4BACT,WAAW,IAAI,CAAC,MAAM,KAAK,CAAC,WAAW,GAAG,OAAO,CAAC,QAAQ;wBAC5D;oBACF;gBACF;gBAEA,IAAI,WAAW,MAAM,GAAG,GAAG;oBACzB,MAAM,GAAG,SAAS,CAAC,EAAE,WAAW,IAAI,CAAC,MAAM;gBAC7C;YACF;YAEA,MAAM,cAAgC;gBACpC,IAAI;gBACJ,kBAAkB;gBAClB,OAAO,qBAAqB,SAAS;gBACrC,gBAAgB,qBAAqB,kBAAkB;gBACvD,OAAO,qBAAqB,SAAS;gBACrC,KAAK,qBAAqB,OAAO;gBACjC,OAAO,qBAAqB,SAAS;YACvC;YAEA,MAAM,SAAS;gBAAC;aAAY;YAC5B,QAAQ,GAAG,CAAC,yCAAyC;gBACnD,eAAe;gBACf,eAAe;gBACf,OAAO,OAAO,MAAM;YACtB;YACA,OAAO;QACT;QAEA,QAAQ,GAAG,CAAC,qDAAqD,cAAc,MAAM,EAAE;IACzF;IAEA,MAAM,qBAAqB,CAAC,OAAqD;QAC/E,qBAAqB,CAAC,OACpB,KAAK,GAAG,CAAC,CAAC,UAAY,CAAC;oBACrB,GAAG,OAAO;oBACV,CAAC,MAAM,EAAE;gBACX,CAAC;IAEL;IAEA,IAAA,0KAAS;0CAAC;YACR,IAAI,cAAc,aAAa,AAAC,OAAe,0BAA0B,EAAE;gBACzE;YACF;YAEA,IAAI,8BAA8B,IAAI,GAAG,GAAG;gBAC1C;YACF,OAAO;gBACL,IAAI,CAAC,YAAY;oBACf,qBAAqB,EAAE;gBACzB;YACF;QACA,uDAAuD;QACzD;yCAAG;QAAC;QAA+B;QAA2B;QAAY;QAAc;QAAe;QAAY;KAAU;IAE7H,OAAO;QACL;QACA;IACF;AACF;GA9GgB"}},
    {"offset": {"line": 4251, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/white%20shop/White-Shop-templete/WhiteShop-Template/apps/web/app/admin/products/add/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect, Suspense, useRef, useMemo } from 'react';\r\nimport type { ChangeEvent, FormEvent } from 'react';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport { useAuth } from '../../../../lib/auth/AuthContext';\r\nimport { Card, Button, Input } from '@shop/ui';\r\nimport { apiClient } from '../../../../lib/api-client';\r\nimport { getColorHex } from '../../../../lib/colorMap';\r\nimport { useTranslation } from '../../../../lib/i18n-client';\r\nimport { convertPrice, CURRENCIES, type CurrencyCode } from '../../../../lib/currency';\r\nimport {\r\n  smartSplitUrls,\r\n  cleanImageUrls,\r\n  separateMainAndVariantImages,\r\n  processImageFile,\r\n} from '../../../../lib/utils/image-utils';\r\nimport type { Brand, Category, Attribute, ColorData, Variant, ProductLabel, ProductData, GeneratedVariant } from './types';\r\nimport { BasicInformation } from './components/BasicInformation';\r\nimport { ProductImages } from './components/ProductImages';\r\nimport { CategoriesBrands } from './components/CategoriesBrands';\r\nimport { SimpleProductFields } from './components/SimpleProductFields';\r\nimport { AttributesSelection } from './components/AttributesSelection';\r\nimport { VariantBuilder } from './components/VariantBuilder';\r\nimport { ProductLabels } from './components/ProductLabels';\r\nimport { ValueSelectionModal } from './components/ValueSelectionModal';\r\nimport { Publishing } from './components/Publishing';\r\nimport { FormActions } from './components/FormActions';\r\nimport { PageHeader } from './components/PageHeader';\r\nimport { useLabelManagement } from './hooks/useLabelManagement';\r\nimport { useImageHandling } from './hooks/useImageHandling';\r\nimport { useVariantGeneration } from './hooks/useVariantGeneration';\r\nimport { generateSlug, isClothingCategory as checkIsClothingCategory } from './utils/productUtils';\r\n\r\nfunction AddProductPageContent() {\r\n  const { t } = useTranslation();\r\n  const { isLoggedIn, isAdmin, isLoading } = useAuth();\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const productId = searchParams.get('id');\r\n  const isEditMode = !!productId;\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingProduct, setLoadingProduct] = useState(false);\r\n  const [brands, setBrands] = useState<Brand[]>([]);\r\n  const [categories, setCategories] = useState<Category[]>([]);\r\n  const [attributes, setAttributes] = useState<Attribute[]>([]);\r\n  const [formData, setFormData] = useState({\r\n    title: '',\r\n    slug: '',\r\n    descriptionHtml: '',\r\n    brandIds: [] as string[], // Changed to array for multi-select\r\n    primaryCategoryId: '',\r\n    categoryIds: [] as string[],\r\n    published: false,\r\n    featured: false,\r\n    imageUrls: [] as string[],\r\n    featuredImageIndex: 0,\r\n    mainProductImage: '' as string, // Main product image (base64)\r\n    variants: [] as Variant[],\r\n    labels: [] as ProductLabel[],\r\n  });\r\n  const [categoriesExpanded, setCategoriesExpanded] = useState(false);\r\n  const [brandsExpanded, setBrandsExpanded] = useState(false);\r\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\r\n  const variantImageInputRefs = useRef<Record<string, HTMLInputElement | null>>({});\r\n  const attributesDropdownRef = useRef<HTMLDivElement | null>(null);\r\n  const [attributesDropdownOpen, setAttributesDropdownOpen] = useState(false);\r\n  const [colorImageTarget, setColorImageTarget] = useState<{ variantId: string; colorValue: string } | null>(null);\r\n  const [imageUploadLoading, setImageUploadLoading] = useState(false);\r\n  const [imageUploadError, setImageUploadError] = useState<string | null>(null);\r\n  const [newBrandName, setNewBrandName] = useState('');\r\n  const [newCategoryName, setNewCategoryName] = useState('');\r\n  const [useNewBrand, setUseNewBrand] = useState(false);\r\n  const [useNewCategory, setUseNewCategory] = useState(false);\r\n  const [newColorName, setNewColorName] = useState('');\r\n  const [newSizeName, setNewSizeName] = useState('');\r\n  const [addingColor, setAddingColor] = useState(false);\r\n  const [addingSize, setAddingSize] = useState(false);\r\n  const [colorMessage, setColorMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\r\n  const [sizeMessage, setSizeMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\r\n  // Default currency from settings\r\n  const [defaultCurrency, setDefaultCurrency] = useState<CurrencyCode>('AMD');\r\n  \r\n  // Product Type: 'simple' or 'variable' (default: 'variable')\r\n  const [productType, setProductType] = useState<'simple' | 'variable'>('variable');\r\n  // Simple product fields (only used when productType === 'simple')\r\n  const [simpleProductData, setSimpleProductData] = useState({\r\n    price: '',\r\n    compareAtPrice: '',\r\n    sku: '',\r\n    quantity: '',\r\n  });\r\n  // New Multi-Attribute Variant Builder state\r\n  const [selectedAttributesForVariants, setSelectedAttributesForVariants] = useState<Set<string>>(new Set()); // Selected attribute IDs\r\n  const [selectedAttributeValueIds, setSelectedAttributeValueIds] = useState<Record<string, string[]>>({}); // Key: attributeId, Value: array of selected value IDs\r\n  // State for managing value selection modal\r\n  const [openValueModal, setOpenValueModal] = useState<{ variantId: string; attributeId: string } | null>(null);\r\n  const [generatedVariants, setGeneratedVariants] = useState<GeneratedVariant[]>([]);\r\n  // Track if we're loading variants in edit mode (to show table immediately)\r\n  const [hasVariantsToLoad, setHasVariantsToLoad] = useState(false);\r\n  useEffect(() => {\r\n    if (!isLoading) {\r\n      if (!isLoggedIn || !isAdmin) {\r\n        router.push('/admin');\r\n        return;\r\n      }\r\n    }\r\n  }, [isLoggedIn, isAdmin, isLoading, router]);\r\n\r\n  // Close attributes dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (attributesDropdownRef.current && !attributesDropdownRef.current.contains(event.target as Node)) {\r\n        setAttributesDropdownOpen(false);\r\n      }\r\n    };\r\n\r\n    if (attributesDropdownOpen) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [attributesDropdownOpen]);\r\n\r\n\r\n  // Load default currency from settings\r\n  useEffect(() => {\r\n    const loadDefaultCurrency = async () => {\r\n      try {\r\n        const settingsRes = await apiClient.get<{ defaultCurrency?: string }>('/api/v1/admin/settings');\r\n        const currency = (settingsRes.defaultCurrency || 'AMD') as CurrencyCode;\r\n        if (currency in CURRENCIES) {\r\n          setDefaultCurrency(currency);\r\n          console.log(' [ADMIN] Default currency loaded:', currency);\r\n        }\r\n      } catch (err) {\r\n        console.error(' [ADMIN] Error loading default currency:', err);\r\n        // Use AMD as default\r\n        setDefaultCurrency('AMD');\r\n      }\r\n    };\r\n    \r\n    if (isLoggedIn && isAdmin) {\r\n      loadDefaultCurrency();\r\n    }\r\n  }, [isLoggedIn, isAdmin]);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        console.log(' [ADMIN] Fetching brands, categories, and attributes...');\r\n        const [brandsRes, categoriesRes, attributesRes] = await Promise.all([\r\n          apiClient.get<{ data: Brand[] }>('/api/v1/admin/brands'),\r\n          apiClient.get<{ data: Category[] }>('/api/v1/admin/categories'),\r\n          apiClient.get<{ data: Attribute[] }>('/api/v1/admin/attributes'),\r\n        ]);\r\n        setBrands(brandsRes.data || []);\r\n        setCategories(categoriesRes.data || []);\r\n        setAttributes(attributesRes.data || []);\r\n        console.log(' [ADMIN] Data fetched:', {\r\n          brands: brandsRes.data?.length || 0,\r\n          categories: categoriesRes.data?.length || 0,\r\n          attributes: attributesRes.data?.length || 0,\r\n        });\r\n        // Debug: Log attributes details\r\n        if (attributesRes.data && attributesRes.data.length > 0) {\r\n          console.log(' [ADMIN] Attributes loaded:', attributesRes.data.map(attr => ({\r\n            id: attr.id,\r\n            key: attr.key,\r\n            name: attr.name,\r\n            valuesCount: attr.values?.length || 0,\r\n            values: attr.values?.map(v => ({ \r\n              value: v.value, \r\n              label: v.label,\r\n              colors: v.colors,\r\n              colorsType: typeof v.colors,\r\n              colorsIsArray: Array.isArray(v.colors),\r\n              colorsLength: v.colors?.length,\r\n              imageUrl: v.imageUrl \r\n            })) || []\r\n          })));\r\n          const colorAttr = attributesRes.data.find(a => a.key === 'color');\r\n          const sizeAttr = attributesRes.data.find(a => a.key === 'size');\r\n          if (!colorAttr) {\r\n            console.warn(' [ADMIN] Color attribute not found in loaded attributes!');\r\n          } else {\r\n            console.log(' [ADMIN] Color attribute found:', { id: colorAttr.id, valuesCount: colorAttr.values?.length || 0 });\r\n          }\r\n          if (!sizeAttr) {\r\n            console.warn(' [ADMIN] Size attribute not found in loaded attributes!');\r\n          } else {\r\n            console.log(' [ADMIN] Size attribute found:', { id: sizeAttr.id, valuesCount: sizeAttr.values?.length || 0 });\r\n          }\r\n        } else {\r\n          console.warn(' [ADMIN] No attributes loaded! This may cause issues with variant builder.');\r\n        }\r\n        // Debug: Log categories with requiresSizes\r\n        if (categoriesRes.data) {\r\n          console.log(' [ADMIN] Categories with requiresSizes:', \r\n            categoriesRes.data.map(cat => ({ \r\n              id: cat.id, \r\n              title: cat.title, \r\n              requiresSizes: cat.requiresSizes \r\n            }))\r\n          );\r\n        }\r\n      } catch (err: any) {\r\n        console.error(' [ADMIN] Error fetching data:', err);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, []);\r\n\r\n  // Close category dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      const target = event.target as HTMLElement;\r\n      if (categoriesExpanded && !target.closest('[data-category-dropdown]')) {\r\n        setCategoriesExpanded(false);\r\n      }\r\n    };\r\n\r\n    if (categoriesExpanded) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      return () => {\r\n        document.removeEventListener('mousedown', handleClickOutside);\r\n      };\r\n    }\r\n  }, [categoriesExpanded]);\r\n\r\n  // Close brand dropdown when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      const target = event.target as HTMLElement;\r\n      if (brandsExpanded && !target.closest('[data-brand-dropdown]')) {\r\n        setBrandsExpanded(false);\r\n      }\r\n    };\r\n\r\n    if (brandsExpanded) {\r\n      document.addEventListener('mousedown', handleClickOutside);\r\n      return () => {\r\n        document.removeEventListener('mousedown', handleClickOutside);\r\n      };\r\n    }\r\n  }, [brandsExpanded]);\r\n\r\n  // Load product data if in edit mode\r\n  useEffect(() => {\r\n    if (productId && isLoggedIn && isAdmin) {\r\n      const loadProduct = async () => {\r\n        try {\r\n          setLoadingProduct(true);\r\n          console.log(' [ADMIN] Loading product for edit:', productId);\r\n          const product = await apiClient.get<ProductData>(`/api/v1/admin/products/${productId}`);\r\n          \r\n          // Transform product data to form format\r\n          // Note: colorAttribute and sizeAttribute are available in attributes array if needed\r\n          \r\n          // Merge all variants into a single variant with colors and their sizes\r\n          //        ColorData,  sizes    color-\r\n          const colorDataMap = new Map<string, ColorData>(); // colorValue -> ColorData\r\n          let firstPrice = '';\r\n          let firstCompareAtPrice = '';\r\n          let firstSku = '';\r\n          \r\n          (product.variants || []).forEach((variant: any, index: number) => {\r\n            console.log(` [ADMIN] Processing variant ${index}:`, {\r\n              id: variant.id,\r\n              sku: variant.sku,\r\n              price: variant.price,\r\n              stock: variant.stock,\r\n              color: variant.color,\r\n              size: variant.size,\r\n              options: variant.options,\r\n              imageUrl: variant.imageUrl,\r\n            });\r\n            \r\n            // Try to get color from variant.options\r\n            let color = variant.color || '';\r\n            let size = variant.size || '';\r\n            \r\n            // If color is empty, try to get from options\r\n            if (!color && variant.options && Array.isArray(variant.options)) {\r\n              console.log(` [ADMIN] Searching for color in options:`, variant.options);\r\n              const colorOption = variant.options.find((opt: any) => {\r\n                const matches = opt.attributeKey === 'color' || opt.key === 'color' || opt.attribute === 'color';\r\n                if (matches) {\r\n                  console.log(` [ADMIN] Found color option:`, opt);\r\n                }\r\n                return matches;\r\n              });\r\n              if (colorOption) {\r\n                color = colorOption.value || '';\r\n                console.log(` [ADMIN] Found color from options:`, color);\r\n              } else {\r\n                // Try to find by attributeValue relation\r\n                const colorOptionByValue = variant.options.find((opt: any) => {\r\n                  // Check if option has attributeValue with color attribute\r\n                  if (opt.attributeValue) {\r\n                    const attrValue = opt.attributeValue;\r\n                    // Check if this attributeValue belongs to color attribute\r\n                    return attrValue.attribute?.key === 'color' || attrValue.attributeKey === 'color';\r\n                  }\r\n                  return false;\r\n                });\r\n                if (colorOptionByValue && colorOptionByValue.attributeValue) {\r\n                  color = colorOptionByValue.attributeValue.value || '';\r\n                  console.log(` [ADMIN] Found color from attributeValue:`, color);\r\n                }\r\n              }\r\n            }\r\n            \r\n            // If size is empty, try to get from options\r\n            if (!size && variant.options && Array.isArray(variant.options)) {\r\n              console.log(` [ADMIN] Searching for size in options:`, variant.options);\r\n              const sizeOption = variant.options.find((opt: any) => {\r\n                const matches = opt.attributeKey === 'size' || opt.key === 'size' || opt.attribute === 'size';\r\n                if (matches) {\r\n                  console.log(` [ADMIN] Found size option:`, opt);\r\n                }\r\n                return matches;\r\n              });\r\n              if (sizeOption) {\r\n                size = sizeOption.value || '';\r\n                console.log(` [ADMIN] Found size from options:`, size);\r\n              } else {\r\n                // Try to find by attributeValue relation\r\n                const sizeOptionByValue = variant.options.find((opt: any) => {\r\n                  // Check if option has attributeValue with size attribute\r\n                  if (opt.attributeValue) {\r\n                    const attrValue = opt.attributeValue;\r\n                    // Check if this attributeValue belongs to size attribute\r\n                    return attrValue.attribute?.key === 'size' || attrValue.attributeKey === 'size';\r\n                  }\r\n                  return false;\r\n                });\r\n                if (sizeOptionByValue && sizeOptionByValue.attributeValue) {\r\n                  size = sizeOptionByValue.attributeValue.value || '';\r\n                  console.log(` [ADMIN] Found size from attributeValue:`, size);\r\n                }\r\n              }\r\n            }\r\n            \r\n            // If still no color/size, try to extract from SKU as fallback\r\n            if (!color && variant.sku) {\r\n              const skuParts = variant.sku.split('-');\r\n              // Common patterns: \"15-blue-17.2\", \"15-red-18\"\r\n              if (skuParts.length >= 2) {\r\n                const possibleColor = skuParts[1]; // \"blue\", \"red\"\r\n                // Check if this looks like a color\r\n                if (possibleColor && possibleColor.length > 0 && !/^\\d+$/.test(possibleColor)) {\r\n                  color = possibleColor;\r\n                  console.log(` [ADMIN] Extracted color from SKU:`, color);\r\n                }\r\n              }\r\n            }\r\n            \r\n            if (!size && variant.sku) {\r\n              const skuParts = variant.sku.split('-');\r\n              // Common patterns: \"15-blue-17.2\", \"15-red-18\"\r\n              if (skuParts.length >= 3) {\r\n                const possibleSize = skuParts[2]; // \"17.2\", \"18\", \"19\"\r\n                if (possibleSize) {\r\n                  size = possibleSize;\r\n                  console.log(` [ADMIN] Extracted size from SKU:`, size);\r\n                }\r\n              }\r\n            }\r\n            \r\n            console.log(` [ADMIN] Extracted from variant ${index}:`, { color, size });\r\n            \r\n            // Convert stock to string, handling 0 correctly\r\n            const stockValue = variant.stock !== undefined && variant.stock !== null \r\n              ? String(variant.stock) \r\n              : '';\r\n            \r\n            // Collect colors with their images, sizes, and stocks\r\n            // If no color, create a default color entry for variants without colors\r\n            if (!color) {\r\n              // Create a default color entry for variants without colors\r\n              const defaultColor = 'default';\r\n              const defaultColorLabel = t('admin.products.add.defaultColor');\r\n              \r\n              if (!colorDataMap.has(defaultColor)) {\r\n                // Convert prices from USD (database) to defaultCurrency (display)\r\n                const priceInDefaultCurrency = variant.price !== undefined && variant.price !== null \r\n                  ? convertPrice(variant.price, 'USD', defaultCurrency) \r\n                  : 0;\r\n                const compareAtPriceInDefaultCurrency = variant.compareAtPrice !== undefined && variant.compareAtPrice !== null \r\n                  ? convertPrice(variant.compareAtPrice, 'USD', defaultCurrency) \r\n                  : 0;\r\n                \r\n                const colorData: ColorData = {\r\n                  colorValue: defaultColor,\r\n                  colorLabel: defaultColorLabel,\r\n                  images: smartSplitUrls(variant.imageUrl),\r\n                  stock: size ? '' : stockValue,\r\n                  price: variant.price !== undefined && variant.price !== null ? String(priceInDefaultCurrency) : '',\r\n                  compareAtPrice: variant.compareAtPrice !== undefined && variant.compareAtPrice !== null ? String(compareAtPriceInDefaultCurrency) : '',\r\n                  sizes: [],\r\n                  sizeStocks: {},\r\n                  sizePrices: {},\r\n                  sizeCompareAtPrices: {},\r\n                  sizeLabels: {},\r\n                  isFeatured: !!variant.isFeatured,\r\n                };\r\n                \r\n                if (size) {\r\n                  colorData.sizes = [size];\r\n                  colorData.sizeStocks = { [size]: stockValue };\r\n                  if (variant.price !== undefined && variant.price !== null) {\r\n                    colorData.sizePrices![size] = String(priceInDefaultCurrency);\r\n                  }\r\n                  if (variant.compareAtPrice !== undefined && variant.compareAtPrice !== null) {\r\n                    colorData.sizeCompareAtPrices![size] = String(compareAtPriceInDefaultCurrency);\r\n                  }\r\n                }\r\n                \r\n                colorDataMap.set(defaultColor, colorData);\r\n              } else {\r\n                const existingColorData = colorDataMap.get(defaultColor)!;\r\n                if (variant.imageUrl) {\r\n                  const imageUrls = smartSplitUrls(variant.imageUrl);\r\n                  imageUrls.forEach((url: string) => {\r\n                    const exists = existingColorData.images.some(existingUrl => {\r\n                      if (url.startsWith('data:') || existingUrl.startsWith('data:')) {\r\n                        return url === existingUrl;\r\n                      }\r\n                      const n1 = existingUrl.startsWith('/') ? existingUrl : `/${existingUrl}`;\r\n                      const n2 = url.startsWith('/') ? url : `/${url}`;\r\n                      return n1 === n2 || existingUrl === url;\r\n                    });\r\n                    if (url && !exists) {\r\n                      existingColorData.images.push(url);\r\n                    }\r\n                  });\r\n                }\r\n                \r\n                if (size) {\r\n                  if (!existingColorData.sizes.includes(size)) {\r\n                    existingColorData.sizes.push(size);\r\n                  }\r\n                  existingColorData.sizeStocks[size] = stockValue;\r\n                  if (!existingColorData.sizePrices) existingColorData.sizePrices = {};\r\n                  if (variant.price !== undefined && variant.price !== null) {\r\n                    const priceInDefaultCurrency = convertPrice(variant.price, 'USD', defaultCurrency);\r\n                    existingColorData.sizePrices[size] = String(priceInDefaultCurrency);\r\n                  }\r\n                  if (!existingColorData.sizeCompareAtPrices) existingColorData.sizeCompareAtPrices = {};\r\n                  if (variant.compareAtPrice !== undefined && variant.compareAtPrice !== null) {\r\n                    const compareAtPriceInDefaultCurrency = convertPrice(variant.compareAtPrice, 'USD', defaultCurrency);\r\n                    existingColorData.sizeCompareAtPrices[size] = String(compareAtPriceInDefaultCurrency);\r\n                  }\r\n                } else {\r\n                  const currentStockNum = parseInt(existingColorData.stock) || 0;\r\n                  const variantStockNum = parseInt(stockValue) || 0;\r\n                  existingColorData.stock = String(currentStockNum + variantStockNum);\r\n                }\r\n              }\r\n            } else if (color) {\r\n              if (!colorDataMap.has(color)) {\r\n                // Get color label from attributes or use color value\r\n                const colorAttribute = attributes.find((attr) => attr.key === 'color');\r\n                const colorValueObj = colorAttribute?.values.find((v) => v.value === color);\r\n                const colorLabel = colorValueObj?.label || \r\n                  (color.charAt(0).toUpperCase() + color.slice(1).replace(/-/g, ' '));\r\n                \r\n                // Initialize color data with empty sizes\r\n                // Convert prices from USD (database) to defaultCurrency (display)\r\n                const priceInDefaultCurrency = variant.price !== undefined && variant.price !== null \r\n                  ? convertPrice(variant.price, 'USD', defaultCurrency) \r\n                  : 0;\r\n                const compareAtPriceInDefaultCurrency = variant.compareAtPrice !== undefined && variant.compareAtPrice !== null \r\n                  ? convertPrice(variant.compareAtPrice, 'USD', defaultCurrency) \r\n                  : 0;\r\n                \r\n                const colorData: ColorData = {\r\n                  colorValue: color,\r\n                  colorLabel: colorLabel,\r\n                  images: smartSplitUrls(variant.imageUrl),\r\n                  stock: size ? '' : stockValue, // Base stock only if no size\r\n                  price: variant.price !== undefined && variant.price !== null ? String(priceInDefaultCurrency) : '',\r\n                  compareAtPrice: variant.compareAtPrice !== undefined && variant.compareAtPrice !== null ? String(compareAtPriceInDefaultCurrency) : '',\r\n                  sizes: [],\r\n                  sizeStocks: {},\r\n                  sizePrices: {},\r\n                  sizeCompareAtPrices: {},\r\n                  sizeLabels: {},\r\n                  isFeatured: !!variant.isFeatured,\r\n                };\r\n                \r\n                // If variant has size, add it to color's sizes\r\n                if (size) {\r\n                  colorData.sizes = [size];\r\n                  colorData.sizeStocks = { [size]: stockValue };\r\n                  // Store size-specific price (converted to defaultCurrency)\r\n                  if (variant.price !== undefined && variant.price !== null) {\r\n                    colorData.sizePrices![size] = String(priceInDefaultCurrency);\r\n                  }\r\n                  // Store size-specific compareAtPrice (converted to defaultCurrency)\r\n                  if (variant.compareAtPrice !== undefined && variant.compareAtPrice !== null) {\r\n                    colorData.sizeCompareAtPrices![size] = String(compareAtPriceInDefaultCurrency);\r\n                  }\r\n                  // Get size label if it's a custom size (not from attributes)\r\n                  if (variant.sizeLabel) {\r\n                    colorData.sizeLabels = { [size]: variant.sizeLabel };\r\n                  }\r\n                }\r\n                \r\n                colorDataMap.set(color, colorData);\r\n              } else {\r\n                // If color already exists, merge data\r\n                const existingColorData = colorDataMap.get(color)!;\r\n                \r\n                // Add images if not already present\r\n                if (variant.imageUrl) {\r\n                  const imageUrls = smartSplitUrls(variant.imageUrl);\r\n                  imageUrls.forEach((url: string) => {\r\n                    // Check for existence with normalization to prevent duplicates\r\n                    const exists = existingColorData.images.some(existingUrl => {\r\n                      if (url.startsWith('data:') || existingUrl.startsWith('data:')) {\r\n                        return url === existingUrl;\r\n                      }\r\n                      const n1 = existingUrl.startsWith('/') ? existingUrl : `/${existingUrl}`;\r\n                      const n2 = url.startsWith('/') ? url : `/${url}`;\r\n                      return n1 === n2 || existingUrl === url;\r\n                    });\r\n                    \r\n                    if (url && !exists) {\r\n                      existingColorData.images.push(url);\r\n                    }\r\n                  });\r\n                }\r\n                \r\n                // If variant has size, add it to color's sizes if not already present\r\n                if (size) {\r\n                  if (!existingColorData.sizes.includes(size)) {\r\n                    existingColorData.sizes.push(size);\r\n                  }\r\n                  // Update stock for this size\r\n                  existingColorData.sizeStocks[size] = stockValue;\r\n                  // Store size-specific price (converted to defaultCurrency)\r\n                  if (!existingColorData.sizePrices) existingColorData.sizePrices = {};\r\n                  if (variant.price !== undefined && variant.price !== null) {\r\n                    const priceInDefaultCurrency = convertPrice(variant.price, 'USD', defaultCurrency);\r\n                    existingColorData.sizePrices[size] = String(priceInDefaultCurrency);\r\n                  }\r\n                  // Store size-specific compareAtPrice (converted to defaultCurrency)\r\n                  if (!existingColorData.sizeCompareAtPrices) existingColorData.sizeCompareAtPrices = {};\r\n                  if (variant.compareAtPrice !== undefined && variant.compareAtPrice !== null) {\r\n                    const compareAtPriceInDefaultCurrency = convertPrice(variant.compareAtPrice, 'USD', defaultCurrency);\r\n                    existingColorData.sizeCompareAtPrices[size] = String(compareAtPriceInDefaultCurrency);\r\n                  }\r\n                  // Update size label if available\r\n                  if (variant.sizeLabel) {\r\n                    if (!existingColorData.sizeLabels) existingColorData.sizeLabels = {};\r\n                    existingColorData.sizeLabels[size] = variant.sizeLabel;\r\n                  }\r\n                } else {\r\n                  // If no size, update base stock (sum if multiple variants without sizes)\r\n                  const currentStockNum = parseInt(existingColorData.stock) || 0;\r\n                  const variantStockNum = parseInt(stockValue) || 0;\r\n                  existingColorData.stock = String(currentStockNum + variantStockNum);\r\n                }\r\n\r\n                // Update featured status if this variant is marked as featured\r\n                if (variant.isFeatured) {\r\n                  existingColorData.isFeatured = true;\r\n                }\r\n              }\r\n            }\r\n            \r\n            // Use first variant's price, compareAtPrice, sku as defaults (converted to defaultCurrency)\r\n            if (index === 0) {\r\n              const firstPriceUSD = variant.price !== undefined && variant.price !== null ? variant.price : 0;\r\n              const firstCompareAtPriceUSD = variant.compareAtPrice !== undefined && variant.compareAtPrice !== null ? variant.compareAtPrice : 0;\r\n              firstPrice = firstPriceUSD > 0 ? String(convertPrice(firstPriceUSD, 'USD', defaultCurrency)) : '';\r\n              firstCompareAtPrice = firstCompareAtPriceUSD > 0 ? String(convertPrice(firstCompareAtPriceUSD, 'USD', defaultCurrency)) : '';\r\n              firstSku = variant.sku || '';\r\n            }\r\n          });\r\n          \r\n          // Create a single merged variant with all colors (sizes are now in each color)\r\n          const mergedVariant: Variant = {\r\n            id: `variant-${Date.now()}-${Math.random()}`,\r\n            price: firstPrice,\r\n            compareAtPrice: firstCompareAtPrice,\r\n            sku: firstSku,\r\n            colors: Array.from(colorDataMap.values()),\r\n          };\r\n          \r\n          // Collect all images assigned to variants to filter them out from general media\r\n          // IMPORTANT: Also collect variant images directly from variant.imageUrl (new format)\r\n          const variantImages = new Set<string>();\r\n          \r\n          // Collect images from mergedVariant.colors\r\n          mergedVariant.colors.forEach(c => {\r\n            c.images.forEach(img => {\r\n              if (img) {\r\n                variantImages.add(img);\r\n                // Also add normalized version for comparison\r\n                const normalized = img.startsWith('/') ? img : `/${img}`;\r\n                variantImages.add(normalized);\r\n              }\r\n            });\r\n          });\r\n          \r\n          // Also collect images directly from variant.imageUrl (new format - for generatedVariants)\r\n          console.log(' [ADMIN] Collecting variant images from product.variants...');\r\n          (product.variants || []).forEach((variant: any, idx: number) => {\r\n            if (variant.imageUrl) {\r\n              // For base64 images, don't split by comma (base64 strings can contain commas)\r\n              // Only split if it's not a base64 string\r\n              if (typeof variant.imageUrl === 'string' && variant.imageUrl.startsWith('data:')) {\r\n                // Base64 image - use full string, don't split\r\n                variantImages.add(variant.imageUrl);\r\n                console.log(`   Added variant base64 image (length: ${variant.imageUrl.length})`);\r\n              } else {\r\n                // Regular URL - can be comma-separated\r\n                const imageUrls = typeof variant.imageUrl === 'string' \r\n                  ? variant.imageUrl.split(',').map((url: string) => url.trim()).filter(Boolean)\r\n                  : [];\r\n                imageUrls.forEach((url: string) => {\r\n                  if (url) {\r\n                    // Regular URL - normalize\r\n                    variantImages.add(url);\r\n                    const normalizedWithSlash = url.startsWith('/') ? url : `/${url}`;\r\n                    const normalizedWithoutSlash = url.startsWith('/') ? url.substring(1) : url;\r\n                    variantImages.add(normalizedWithSlash);\r\n                    variantImages.add(normalizedWithoutSlash);\r\n                    const urlWithoutQuery = url.split('?')[0];\r\n                    if (urlWithoutQuery !== url) {\r\n                      variantImages.add(urlWithoutQuery);\r\n                      const normalizedWithoutQuery = urlWithoutQuery.startsWith('/') ? urlWithoutQuery : `/${urlWithoutQuery}`;\r\n                      variantImages.add(normalizedWithoutQuery);\r\n                    }\r\n                    console.log(`   Added variant URL: ${url.substring(0, 50)}...`);\r\n                  }\r\n                });\r\n              }\r\n            } else {\r\n              console.log(` [ADMIN] Variant ${idx} has no imageUrl`);\r\n            }\r\n          });\r\n          console.log(` [ADMIN] Total variant images collected: ${variantImages.size}`);\r\n\r\n          // Helper function to normalize URL for comparison\r\n          const normalizeUrlForComparison = (url: string): string[] => {\r\n            if (!url) return [];\r\n            // For base64 images, use the full string for comparison\r\n            if (url.startsWith('data:')) {\r\n              return [url];\r\n            }\r\n            // For regular URLs, normalize them\r\n            const normalized = url.trim();\r\n            const withSlash = normalized.startsWith('/') ? normalized : `/${normalized}`;\r\n            const withoutSlash = normalized.startsWith('/') ? normalized.substring(1) : normalized;\r\n            const withoutQuery = normalized.split('?')[0];\r\n            const withoutQueryWithSlash = withoutQuery.startsWith('/') ? withoutQuery : `/${withoutQuery}`;\r\n            return [normalized, withSlash, withoutSlash, withoutQuery, withoutQueryWithSlash];\r\n          };\r\n\r\n          const mediaList = product.media || [];\r\n          console.log(' [ADMIN] Loading main media images. Total media:', mediaList.length);\r\n          \r\n          // Use unified utilities to properly separate and clean images\r\n          // In edit mode, we show main images separately from variant images\r\n          // product.media is already cleaned in findBySlug, but we ensure proper separation here\r\n          const { main } = separateMainAndVariantImages(\r\n            Array.isArray(mediaList) ? mediaList : [],\r\n            variantImages.size > 0 ? Array.from(variantImages) : []\r\n          );\r\n          \r\n          const normalizedMedia = cleanImageUrls(main);\r\n          console.log(` [ADMIN] Main media loaded: ${normalizedMedia.length} images (after separation from ${variantImages.size} variant images)`);\r\n          \r\n          // Find featured image index from original mediaList (before filtering)\r\n          const featuredIndexFromApi = Array.isArray(mediaList)\r\n            ? mediaList.findIndex((item: any) => {\r\n                const url = typeof item === 'string' ? item : item?.url || '';\r\n                if (!url) return false;\r\n                // Check if this item is marked as featured\r\n                return typeof item === 'object' && item?.isFeatured === true;\r\n              })\r\n            : -1;\r\n\r\n          // Extract main product image (first image in media that's not in variants, or from mainProductImage field)\r\n          const mainProductImage = (product as any).mainProductImage \r\n            || (normalizedMedia.length > 0 ? normalizedMedia[0] : '');\r\n\r\n          // Extract brandIds - convert single brandId to array for multi-select UI\r\n          // Note: Database currently supports single brandId, but UI allows multi-select\r\n          // We use the first brand for now, but UI is ready for future multi-brand support\r\n          const brandIds = product.brandId ? [product.brandId] : [];\r\n\r\n          setFormData({\r\n            title: product.title || '',\r\n            slug: product.slug || '',\r\n            descriptionHtml: product.descriptionHtml || '',\r\n            brandIds: brandIds,\r\n            primaryCategoryId: product.primaryCategoryId || '',\r\n            categoryIds: product.categoryIds || [],\r\n            published: product.published || false,\r\n            featured: product.featured || false,\r\n            imageUrls: normalizedMedia,\r\n            featuredImageIndex:\r\n              featuredIndexFromApi >= 0 && featuredIndexFromApi < normalizedMedia.length\r\n                ? featuredIndexFromApi\r\n                : 0,\r\n            // Sync mainProductImage with featured image from imageUrls\r\n            mainProductImage: normalizedMedia.length > 0 && normalizedMedia[featuredIndexFromApi >= 0 && featuredIndexFromApi < normalizedMedia.length ? featuredIndexFromApi : 0]\r\n              ? normalizedMedia[featuredIndexFromApi >= 0 && featuredIndexFromApi < normalizedMedia.length ? featuredIndexFromApi : 0]\r\n              : mainProductImage || '',\r\n            variants: [mergedVariant], // Single variant with all colors and sizes\r\n            labels: (product.labels || []).map((label: any) => ({\r\n              id: label.id || '',\r\n              type: label.type || 'text',\r\n              value: label.value || '',\r\n              position: label.position || 'top-left',\r\n              color: label.color || null,\r\n            })),\r\n          });\r\n          \r\n          // Reset new brand/category fields when loading existing product\r\n          setUseNewBrand(false);\r\n          setUseNewCategory(false);\r\n          setNewBrandName('');\r\n          setNewCategoryName('');\r\n          \r\n          // Store product variants temporarily to convert after attributes are loaded\r\n          // We'll convert them in a separate useEffect that waits for attributes\r\n          if (product.variants && product.variants.length > 0) {\r\n            // Store product data for later conversion\r\n            (window as any).__productVariantsToConvert = product.variants;\r\n            // Set flag to show variants table immediately\r\n            setHasVariantsToLoad(true);\r\n          }\r\n          \r\n          // Store product's attributeIds to show all attributes, not just ones used in variants\r\n          if (product.attributeIds && product.attributeIds.length > 0) {\r\n            (window as any).__productAttributeIds = product.attributeIds;\r\n            console.log(' [ADMIN] Product attributeIds loaded:', product.attributeIds);\r\n          }\r\n          \r\n          // Check if product has variants with attributes\r\n          // IMPORTANT: A product is \"simple\" if variants don't have attributes (color, size, etc.)\r\n          // Even if product has attributeIds, if variants don't use them, it's still simple\r\n          const variants = product.variants || [];\r\n          const hasVariants = variants.length > 0;\r\n          const hasVariantsWithAttributes = hasVariants && \r\n            variants.some((variant: any) => {\r\n              // Check if variant has attributes in JSONB column\r\n              if (variant.attributes && typeof variant.attributes === 'object' && Object.keys(variant.attributes).length > 0) {\r\n                return true;\r\n              }\r\n              // Check if variant has options\r\n              if (variant.options && Array.isArray(variant.options) && variant.options.length > 0) {\r\n                return true;\r\n              }\r\n              return false;\r\n            });\r\n          \r\n          // Log for debugging\r\n          console.log(' [ADMIN] Product type check:', {\r\n            hasVariants,\r\n            variantsCount: variants.length,\r\n            hasVariantsWithAttributes,\r\n            firstVariant: hasVariants && variants.length > 0 ? {\r\n              hasAttributes: !!(variants[0] && (variants[0] as any).attributes && typeof (variants[0] as any).attributes === 'object' && Object.keys((variants[0] as any).attributes).length > 0),\r\n              hasOptions: !!((variants[0] as any).options && Array.isArray((variants[0] as any).options) && (variants[0] as any).options.length > 0),\r\n              attributes: (variants[0] as any).attributes,\r\n              optionsCount: ((variants[0] as any).options?.length || 0),\r\n            } : null,\r\n          });\r\n          \r\n          // If variants don't have attributes, set to simple (even if product has attributeIds)\r\n          if (!hasVariantsWithAttributes) {\r\n            console.log(' [ADMIN] Product variants have no attributes, setting productType to \"simple\"');\r\n            setProductType('simple');\r\n            \r\n            // Also set simple product data from first variant if available\r\n            if (hasVariants && variants.length > 0) {\r\n              const firstVariant = variants[0] as any;\r\n              setSimpleProductData({\r\n                price: firstVariant.price ? String(convertPrice(typeof firstVariant.price === 'number' ? firstVariant.price : parseFloat(String(firstVariant.price || '0')), 'USD', defaultCurrency)) : '',\r\n                compareAtPrice: firstVariant.compareAtPrice ? String(convertPrice(typeof firstVariant.compareAtPrice === 'number' ? firstVariant.compareAtPrice : parseFloat(String(firstVariant.compareAtPrice || '0')), 'USD', defaultCurrency)) : '',\r\n                sku: firstVariant.sku || '',\r\n                quantity: String(firstVariant.stock || 0),\r\n              });\r\n            } else {\r\n              // No variants at all, set empty simple product data\r\n              setSimpleProductData({\r\n                price: '',\r\n                compareAtPrice: '',\r\n                sku: '',\r\n                quantity: '0',\r\n              });\r\n            }\r\n          } else {\r\n            // Variants have attributes, keep it as variable\r\n            console.log(' [ADMIN] Product variants have attributes, keeping productType as \"variable\"');\r\n            setProductType('variable');\r\n          }\r\n          \r\n          console.log(' [ADMIN] Product loaded for edit');\r\n        } catch (err: any) {\r\n          console.error(' [ADMIN] Error loading product:', err);\r\n          router.push('/admin/products');\r\n        } finally {\r\n          setLoadingProduct(false);\r\n        }\r\n      };\r\n      \r\n      loadProduct();\r\n    }\r\n  }, [productId, isLoggedIn, isAdmin, router, attributes]);\r\n\r\n  // Convert product variants to generatedVariants format after attributes are loaded\r\n  useEffect(() => {\r\n    if (productId && attributes.length > 0 && (window as any).__productVariantsToConvert) {\r\n      const productVariants = (window as any).__productVariantsToConvert;\r\n      console.log(' [ADMIN] Converting product variants to generatedVariants format:', {\r\n        variantsCount: productVariants.length,\r\n        attributesCount: attributes.length,\r\n        firstVariant: productVariants[0],\r\n      });\r\n      \r\n      // Collect all unique attribute IDs and value IDs from all variants\r\n      const attributeIdsSet = new Set<string>();\r\n      const attributeValueIdsMap: Record<string, string[]> = {};\r\n      \r\n      // First pass: collect all attributes and their values from all variants\r\n      productVariants.forEach((variant: any) => {\r\n        if (variant.options && Array.isArray(variant.options)) {\r\n          variant.options.forEach((opt: any) => {\r\n            // Try to get attributeId and valueId directly or from attributeValue relation\r\n            let attributeId = opt.attributeId;\r\n            let valueId = opt.valueId;\r\n            \r\n            // If not directly available, try to get from attributeValue relation\r\n            if (!attributeId && opt.attributeValue) {\r\n              attributeId = opt.attributeValue.attributeId || opt.attributeValue.attribute?.id;\r\n            }\r\n            if (!valueId && opt.attributeValue) {\r\n              valueId = opt.attributeValue.id;\r\n            }\r\n            \r\n            if (attributeId && valueId) {\r\n              attributeIdsSet.add(attributeId);\r\n              \r\n              if (!attributeValueIdsMap[attributeId]) {\r\n                attributeValueIdsMap[attributeId] = [];\r\n              }\r\n              if (!attributeValueIdsMap[attributeId].includes(valueId)) {\r\n                attributeValueIdsMap[attributeId].push(valueId);\r\n              }\r\n            }\r\n          });\r\n        }\r\n      });\r\n      \r\n      // Also include product's attributeIds (all attributes that the product has, not just ones used in variants)\r\n      const productAttributeIds = (window as any).__productAttributeIds || [];\r\n      if (productAttributeIds.length > 0) {\r\n        console.log(' [ADMIN] Adding product attributeIds to selected attributes:', productAttributeIds);\r\n        productAttributeIds.forEach((attrId: string) => {\r\n          attributeIdsSet.add(attrId);\r\n        });\r\n      }\r\n      \r\n      // Set selected attributes for variants (includes both variant attributes and product attributes)\r\n      if (attributeIdsSet.size > 0) {\r\n        console.log(' [ADMIN] Setting selectedAttributesForVariants with all attributes:', Array.from(attributeIdsSet));\r\n        setSelectedAttributesForVariants(attributeIdsSet);\r\n      }\r\n      \r\n      // Set selected attribute value IDs (all unique values from all variants)\r\n      // This ensures all values are available for selection in the UI\r\n      if (Object.keys(attributeValueIdsMap).length > 0) {\r\n        setSelectedAttributeValueIds(attributeValueIdsMap);\r\n      }\r\n      \r\n      // Convert each variant to generatedVariants format\r\n      // NEW LOGIC: Group variants by their attribute values, price, compareAtPrice, and stock\r\n      // This matches the Add New Product UI where one variant row shows all values\r\n      // Extract attribute values from JSONB attributes column or from options\r\n      \r\n      // First, collect all variant data with their attribute values\r\n      interface VariantData {\r\n        id: string;\r\n        selectedValueIds: string[];\r\n        price: number;\r\n        compareAtPrice: number | null;\r\n        stock: number;\r\n        sku: string;\r\n        image: string | null;\r\n        originalVariantIds: string[]; // Keep track of original variant IDs for reference\r\n      }\r\n      \r\n      const variantDataList: VariantData[] = [];\r\n      \r\n      productVariants.forEach((variant: any, variantIndex: number) => {\r\n        const selectedValueIds: string[] = [];\r\n        \r\n        // First, try to get attribute values from JSONB attributes column\r\n        if (variant.attributes && typeof variant.attributes === 'object') {\r\n          console.log(` [ADMIN] Variant ${variantIndex} has attributes JSONB:`, variant.attributes);\r\n          \r\n          // Iterate through all attributes in JSONB\r\n          Object.keys(variant.attributes).forEach((attributeKey) => {\r\n            const attribute = attributes.find(a => a.key === attributeKey);\r\n            if (!attribute) {\r\n              console.warn(` [ADMIN] Attribute not found for key: ${attributeKey}`);\r\n              return;\r\n            }\r\n            \r\n            const attributeValues = variant.attributes[attributeKey];\r\n            if (Array.isArray(attributeValues)) {\r\n              attributeValues.forEach((attrValue: any) => {\r\n                // Support both formats: {valueId, value, attributeKey} or just value string\r\n                const valueId = attrValue.valueId || attrValue.id;\r\n                const value = attrValue.value || attrValue;\r\n                \r\n                if (valueId) {\r\n                  // If we have valueId, use it directly\r\n                  if (!selectedValueIds.includes(valueId)) {\r\n                    selectedValueIds.push(valueId);\r\n                  }\r\n                } else if (value) {\r\n                  // If we only have value string, find the corresponding valueId\r\n                  const foundValue = attribute.values.find(v => \r\n                    v.value === value || v.label === value\r\n                  );\r\n                  if (foundValue && !selectedValueIds.includes(foundValue.id)) {\r\n                    selectedValueIds.push(foundValue.id);\r\n                  }\r\n                }\r\n              });\r\n            }\r\n          });\r\n        }\r\n        \r\n        // Fallback: collect valueIds from variant options if JSONB is empty\r\n        if (selectedValueIds.length === 0 && variant.options && Array.isArray(variant.options)) {\r\n          console.log(` [ADMIN] Variant ${variantIndex} using options fallback:`, variant.options);\r\n          \r\n          // Group options by attribute to collect all values for each attribute\r\n          const attributeValueMap: Record<string, Set<string>> = {};\r\n          \r\n          variant.options.forEach((opt: any) => {\r\n            // Try to get attributeId and valueId directly or from attributeValue relation\r\n            let attributeId = opt.attributeId;\r\n            let valueId = opt.valueId;\r\n            let attributeKey = opt.attributeKey;\r\n            \r\n            // If not directly available, try to get from attributeValue relation\r\n            if (!attributeId && opt.attributeValue) {\r\n              attributeId = opt.attributeValue.attributeId || opt.attributeValue.attribute?.id || opt.attributeValue.attributeId;\r\n              attributeKey = opt.attributeValue.attribute?.key || opt.attributeValue.attributeKey;\r\n            }\r\n            if (!valueId && opt.attributeValue) {\r\n              valueId = opt.attributeValue.id || opt.attributeValue.valueId;\r\n            }\r\n            \r\n            // Additional fallback: try to find attribute by key in attributes array\r\n            if (!attributeId && opt.attributeKey) {\r\n              const foundAttr = attributes.find(a => a.key === opt.attributeKey);\r\n              if (foundAttr) {\r\n                attributeId = foundAttr.id;\r\n                attributeKey = foundAttr.key;\r\n              }\r\n            }\r\n            \r\n            // Additional fallback: try to find value by value string in attributes\r\n            if (attributeId && !valueId && opt.value) {\r\n              const foundAttr = attributes.find(a => a.id === attributeId);\r\n              if (foundAttr) {\r\n                const foundValue = foundAttr.values.find(v => v.value === opt.value || v.label === opt.value);\r\n                if (foundValue) {\r\n                  valueId = foundValue.id;\r\n                }\r\n              }\r\n            }\r\n            \r\n            // Group by attribute key to collect all values for this variant\r\n            if (attributeKey && valueId) {\r\n              if (!attributeValueMap[attributeKey]) {\r\n                attributeValueMap[attributeKey] = new Set();\r\n              }\r\n              attributeValueMap[attributeKey].add(valueId);\r\n            }\r\n          });\r\n          \r\n          // Collect all valueIds from all attributes for this variant\r\n          Object.values(attributeValueMap).forEach((valueIdSet) => {\r\n            valueIdSet.forEach((valueId) => {\r\n              if (!selectedValueIds.includes(valueId)) {\r\n                selectedValueIds.push(valueId);\r\n              }\r\n            });\r\n          });\r\n        }\r\n        \r\n        // Extract image URL from variant.imageUrl (can be comma-separated)\r\n        let variantImage: string | null = null;\r\n        if (variant.imageUrl) {\r\n          // For base64 images, don't split by comma (base64 strings can contain commas)\r\n          // Only split if it's not a base64 string\r\n          if (typeof variant.imageUrl === 'string' && variant.imageUrl.startsWith('data:')) {\r\n            // Base64 image - use full string, don't split\r\n            variantImage = variant.imageUrl;\r\n            console.log(` [ADMIN] Variant ${variantIndex} base64 image length:`, variantImage?.length || 0);\r\n          } else {\r\n            // Regular URL - can be comma-separated\r\n            const imageUrls = typeof variant.imageUrl === 'string' \r\n              ? variant.imageUrl.split(',').map((url: string) => url.trim()).filter(Boolean)\r\n              : [];\r\n            variantImage = imageUrls.length > 0 ? imageUrls[0] : null;\r\n            console.log(` [ADMIN] Variant ${variantIndex} imageUrl length:`, variant.imageUrl?.length || 0, ' extracted image length:', variantImage?.length || 0);\r\n          }\r\n        } else {\r\n          console.log(` [ADMIN] Variant ${variantIndex} has no imageUrl`);\r\n        }\r\n        \r\n        // Convert prices from USD to defaultCurrency for display\r\n        const priceInDefaultCurrency = variant.price !== undefined && variant.price !== null \r\n          ? convertPrice(variant.price, 'USD', defaultCurrency)\r\n          : 0;\r\n        const compareAtPriceInDefaultCurrency = variant.compareAtPrice !== undefined && variant.compareAtPrice !== null \r\n          ? convertPrice(variant.compareAtPrice, 'USD', defaultCurrency)\r\n          : null;\r\n        \r\n        variantDataList.push({\r\n          id: variant.id || `variant-${Date.now()}-${variantIndex}-${Math.random()}`,\r\n          selectedValueIds: selectedValueIds.sort(), // Sort for consistent grouping\r\n          price: priceInDefaultCurrency,\r\n          compareAtPrice: compareAtPriceInDefaultCurrency,\r\n          stock: variant.stock !== undefined && variant.stock !== null ? variant.stock : 0,\r\n          sku: variant.sku || '',\r\n          image: variantImage,\r\n          originalVariantIds: [variant.id || `variant-${variantIndex}`],\r\n        });\r\n      });\r\n      \r\n      // Group variants by their attribute values, price, compareAtPrice, and stock\r\n      // Variants with the same combination of these should be grouped together\r\n      const variantGroups = new Map<string, VariantData[]>();\r\n      \r\n      variantDataList.forEach((variantData) => {\r\n        // Create a unique key for grouping based on:\r\n        // 1. Sorted attribute value IDs (same values = same group)\r\n        // 2. Price\r\n        // 3. CompareAtPrice\r\n        // 4. Stock (if all variants have the same stock, they can be grouped)\r\n        const valueIdsKey = variantData.selectedValueIds.join(',');\r\n        const priceKey = variantData.price.toString();\r\n        const compareAtPriceKey = variantData.compareAtPrice !== null ? variantData.compareAtPrice.toString() : 'null';\r\n        const stockKey = variantData.stock.toString();\r\n        \r\n        // Group key: combine all factors\r\n        // Note: We group by valueIds, price, and compareAtPrice\r\n        // Stock can vary per combination, so we don't include it in the group key\r\n        // Instead, we'll use the first variant's stock as the default\r\n        const groupKey = `${valueIdsKey}|${priceKey}|${compareAtPriceKey}`;\r\n        \r\n        if (!variantGroups.has(groupKey)) {\r\n          variantGroups.set(groupKey, []);\r\n        }\r\n        variantGroups.get(groupKey)!.push(variantData);\r\n      });\r\n      \r\n      // Convert grouped variants to generatedVariants format\r\n      // Each group becomes one variant row with all value IDs combined\r\n      const convertedVariants: Array<{\r\n        id: string;\r\n        selectedValueIds: string[];\r\n        price: string;\r\n        compareAtPrice: string;\r\n        stock: string;\r\n        sku: string;\r\n        image: string | null;\r\n      }> = [];\r\n      \r\n      variantGroups.forEach((group, groupKey) => {\r\n        // Combine all value IDs from all variants in this group\r\n        const allValueIds = new Set<string>();\r\n        group.forEach(variantData => {\r\n          variantData.selectedValueIds.forEach(valueId => {\r\n            allValueIds.add(valueId);\r\n          });\r\n        });\r\n        \r\n        // Use the first variant's data as the base (price, compareAtPrice, stock, sku, image)\r\n        const firstVariant = group[0];\r\n        \r\n        // For stock, if all variants in the group have the same stock, use that\r\n        // Otherwise, use the first variant's stock (or sum if needed)\r\n        const allStocksSame = group.every(v => v.stock === firstVariant.stock);\r\n        const stockValue = allStocksSame ? firstVariant.stock : firstVariant.stock;\r\n        \r\n        // Combine SKUs if multiple variants (for reference)\r\n        const combinedSku = group.length === 1 \r\n          ? firstVariant.sku \r\n          : group.map(v => v.sku).filter(Boolean).join(', ');\r\n        \r\n        // Use first variant's image, or combine if multiple\r\n        const combinedImage = firstVariant.image;\r\n        \r\n        convertedVariants.push({\r\n          id: `variant-group-${Date.now()}-${Math.random()}`, // New ID for grouped variant\r\n          selectedValueIds: Array.from(allValueIds).sort(), // All unique value IDs from the group\r\n          price: firstVariant.price.toString(),\r\n          compareAtPrice: firstVariant.compareAtPrice !== null ? firstVariant.compareAtPrice.toString() : '',\r\n          stock: stockValue.toString(),\r\n          sku: combinedSku,\r\n          image: combinedImage,\r\n        });\r\n        \r\n        console.log(` [ADMIN] Grouped ${group.length} variants into 1 row:`, {\r\n          groupKey,\r\n          valueIds: Array.from(allValueIds),\r\n          price: firstVariant.price,\r\n          stock: stockValue,\r\n          originalVariantIds: group.flatMap(v => v.originalVariantIds),\r\n        });\r\n      });\r\n      \r\n      if (convertedVariants.length > 0) {\r\n        setGeneratedVariants(convertedVariants);\r\n        console.log(' [ADMIN] Converted product variants to generatedVariants:', {\r\n          totalVariants: convertedVariants.length,\r\n          totalOriginalVariants: productVariants.length,\r\n          attributeValueIdsMap,\r\n          convertedVariants: convertedVariants.map(v => ({\r\n            id: v.id,\r\n            valueIdsCount: v.selectedValueIds.length,\r\n            price: v.price,\r\n            stock: v.stock,\r\n            sku: v.sku,\r\n          })),\r\n        });\r\n        // Clear the temporary storage and loading flag\r\n        delete (window as any).__productVariantsToConvert;\r\n        setHasVariantsToLoad(false);\r\n      } else {\r\n        console.warn(' [ADMIN] No variants converted. Check variant options structure:', {\r\n          variantsCount: productVariants.length,\r\n          firstVariantOptions: productVariants[0]?.options,\r\n        });\r\n        // Reset flag if no variants were converted\r\n        setHasVariantsToLoad(false);\r\n      }\r\n    } else if (productId && attributes.length > 0) {\r\n      console.log(' [ADMIN] Waiting for variants to convert. Attributes loaded:', attributes.length);\r\n    }\r\n  }, [productId, attributes]);\r\n\r\n  // Variant generation using hook\r\n  const { applyToAllVariants } = useVariantGeneration({\r\n    selectedAttributesForVariants,\r\n    selectedAttributeValueIds,\r\n    attributes,\r\n    generatedVariants,\r\n    formDataSlug: formData.slug,\r\n    formDataTitle: formData.title,\r\n    isEditMode,\r\n    productId,\r\n    setGeneratedVariants,\r\n  });\r\n\r\n  const handleTitleChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n    const title = e.target.value;\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      title,\r\n      slug: prev.slug || generateSlug(title),\r\n    }));\r\n  };\r\n\r\n  // Check if selected category requires sizes\r\n  const isClothingCategory = () => checkIsClothingCategory(formData.primaryCategoryId, categories);\r\n\r\n  // Image handling using hook\r\n  const {\r\n    addImageUrl,\r\n    removeImageUrl,\r\n    updateImageUrl,\r\n    setFeaturedImage,\r\n    handleUploadImages,\r\n    handleUploadVariantImage,\r\n    handleUploadColorImages,\r\n    addColorImages,\r\n  } = useImageHandling({\r\n    imageUrls: formData.imageUrls,\r\n    featuredImageIndex: formData.featuredImageIndex,\r\n    variants: formData.variants,\r\n    generatedVariants,\r\n    colorImageTarget,\r\n    setImageUrls: (updater) => setFormData((prev) => ({ ...prev, imageUrls: updater(prev.imageUrls) })),\r\n    setFeaturedImageIndex: (index) => setFormData((prev) => ({ ...prev, featuredImageIndex: index })),\r\n    setMainProductImage: (image) => setFormData((prev) => ({ ...prev, mainProductImage: image })),\r\n    setVariants: (updater) => setFormData((prev) => ({ ...prev, variants: updater(prev.variants) })),\r\n    setGeneratedVariants,\r\n    setImageUploadLoading,\r\n    setImageUploadError,\r\n    setColorImageTarget,\r\n    t,\r\n  });\r\n\r\n\r\n  // Label management using hook\r\n  const { addLabel, removeLabel, updateLabel } = useLabelManagement(\r\n    formData.labels,\r\n    (updater) => setFormData((prev) => ({ ...prev, labels: updater(prev.labels) }))\r\n  );\r\n\r\n  // Memoize color and size attributes to avoid unnecessary recalculations\r\n  const colorAttribute = useMemo(() => {\r\n    if (!attributes || attributes.length === 0) {\r\n      return undefined;\r\n    }\r\n    const colorAttr = attributes.find((attr) => attr.key === 'color');\r\n    if (!colorAttr) {\r\n      console.log(' [ADMIN] Color attribute not found. Available attributes:', attributes.map(a => ({ key: a.key, name: a.name })));\r\n    } else {\r\n      console.log(' [ADMIN] Color attribute found:', { id: colorAttr.id, key: colorAttr.key, valuesCount: colorAttr.values?.length || 0 });\r\n    }\r\n    return colorAttr;\r\n  }, [attributes]);\r\n\r\n  const sizeAttribute = useMemo(() => {\r\n    if (!attributes || attributes.length === 0) {\r\n      return undefined;\r\n    }\r\n    const sizeAttr = attributes.find((attr) => attr.key === 'size');\r\n    if (!sizeAttr) {\r\n      console.log(' [ADMIN] Size attribute not found. Available attributes:', attributes.map(a => ({ key: a.key, name: a.name })));\r\n    } else {\r\n      console.log(' [ADMIN] Size attribute found:', { id: sizeAttr.id, key: sizeAttr.key, valuesCount: sizeAttr.values?.length || 0 });\r\n    }\r\n    return sizeAttr;\r\n  }, [attributes]);\r\n\r\n  // Keep getColorAttribute and getSizeAttribute for backward compatibility\r\n  const getColorAttribute = () => colorAttribute;\r\n  const getSizeAttribute = () => sizeAttribute;\r\n\r\n  // Add new color to color attribute\r\n  const handleAddColor = async () => {\r\n    setColorMessage(null);\r\n    const colorAttribute = getColorAttribute();\r\n    if (!colorAttribute) {\r\n      setColorMessage({ type: 'error', text: t('admin.products.add.colorAttributeNotFound') });\r\n      return;\r\n    }\r\n\r\n    if (!newColorName.trim()) {\r\n      setColorMessage({ type: 'error', text: t('admin.products.add.colorNameRequired') });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setAddingColor(true);\r\n      const response = await apiClient.post<{ data: Attribute }>(`/api/v1/admin/attributes/${colorAttribute.id}/values`, {\r\n        label: newColorName.trim(),\r\n        locale: 'en',\r\n      });\r\n      \r\n      if (response.data) {\r\n        // Update attributes list\r\n        setAttributes((prev) => \r\n          prev.map((attr) => \r\n            attr.id === colorAttribute.id ? response.data : attr\r\n          )\r\n        );\r\n        setColorMessage({ type: 'success', text: t('admin.products.add.colorAddedSuccess').replace('{name}', newColorName.trim()) });\r\n        setNewColorName('');\r\n        // Clear message after 3 seconds\r\n        setTimeout(() => setColorMessage(null), 3000);\r\n      }\r\n    } catch (err: any) {\r\n      setColorMessage({ type: 'error', text: err.message || t('admin.products.add.failedToAddColor') });\r\n    } finally {\r\n      setAddingColor(false);\r\n    }\r\n  };\r\n\r\n  // Add new size to size attribute\r\n  const handleAddSize = async () => {\r\n    setSizeMessage(null);\r\n    const sizeAttribute = getSizeAttribute();\r\n    if (!sizeAttribute) {\r\n      setSizeMessage({ type: 'error', text: t('admin.products.add.sizeAttributeNotFound') });\r\n      return;\r\n    }\r\n\r\n    if (!newSizeName.trim()) {\r\n      setSizeMessage({ type: 'error', text: t('admin.products.add.sizeNameRequired') });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setAddingSize(true);\r\n      const response = await apiClient.post<{ data: Attribute }>(`/api/v1/admin/attributes/${sizeAttribute.id}/values`, {\r\n        label: newSizeName.trim(),\r\n        locale: 'en',\r\n      });\r\n      \r\n      if (response.data) {\r\n        // Update attributes list\r\n        setAttributes((prev) => \r\n          prev.map((attr) => \r\n            attr.id === sizeAttribute.id ? response.data : attr\r\n          )\r\n        );\r\n        setSizeMessage({ type: 'success', text: t('admin.products.add.sizeAddedSuccess').replace('{name}', newSizeName.trim()) });\r\n        setNewSizeName('');\r\n        // Clear message after 3 seconds\r\n        setTimeout(() => setSizeMessage(null), 3000);\r\n      }\r\n    } catch (err: any) {\r\n      setSizeMessage({ type: 'error', text: err.message || t('admin.products.add.failedToAddSize') });\r\n    } finally {\r\n      setAddingSize(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n\r\n    try {\r\n      console.log(' [ADMIN] Submitting product form:', formData);\r\n\r\n      // Collect success messages for newly created entities (brand/category)\r\n      const creationMessages: string[] = [];\r\n\r\n      // Create new brand if provided and add to brandIds\r\n      let finalBrandIds = [...formData.brandIds];\r\n      if (useNewBrand && newBrandName.trim()) {\r\n        try {\r\n          console.log(' [ADMIN] Creating new brand:', newBrandName);\r\n          const brandResponse = await apiClient.post<{ data: Brand }>('/api/v1/admin/brands', {\r\n            name: newBrandName.trim(),\r\n            locale: 'en',\r\n          });\r\n          if (brandResponse.data) {\r\n            // Add new brand to brandIds if not already present\r\n            if (!finalBrandIds.includes(brandResponse.data.id)) {\r\n              finalBrandIds.push(brandResponse.data.id);\r\n            }\r\n            // Add to brands list for future use\r\n            setBrands((prev) => [...prev, brandResponse.data]);\r\n            console.log(' [ADMIN] Brand created:', brandResponse.data.id);\r\n            creationMessages.push(t('admin.products.add.brandCreatedSuccess').replace('{name}', newBrandName.trim()));\r\n          }\r\n        } catch (err: any) {\r\n          console.error(' [ADMIN] Error creating brand:', err);\r\n          setLoading(false);\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Create new category if provided\r\n      let finalPrimaryCategoryId = formData.primaryCategoryId;\r\n      if (useNewCategory && newCategoryName.trim()) {\r\n        try {\r\n          console.log(' [ADMIN] Creating new category:', newCategoryName);\r\n          const categoryResponse = await apiClient.post<{ data: Category }>('/api/v1/admin/categories', {\r\n            title: newCategoryName.trim(),\r\n            locale: 'en',\r\n            requiresSizes: false,\r\n          });\r\n          if (categoryResponse.data) {\r\n            finalPrimaryCategoryId = categoryResponse.data.id;\r\n            // Add to categories list for future use\r\n            setCategories((prev) => [...prev, categoryResponse.data]);\r\n            console.log(' [ADMIN] Category created:', categoryResponse.data.id);\r\n            creationMessages.push(\r\n              t('admin.products.add.categoryCreatedSuccess').replace('{name}', newCategoryName.trim())\r\n            );\r\n          }\r\n        } catch (err: any) {\r\n          console.error(' [ADMIN] Error creating category:', err);\r\n          setLoading(false);\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Convert new variant builder variants to formData.variants if attributes are selected\r\n      // NEW LOGIC: Process all variants (both auto-generated and manually added)\r\n      // Skip this for simple products\r\n      if (productType === 'variable' && selectedAttributesForVariants.size > 0 && generatedVariants.length > 0) {\r\n        console.log(' [ADMIN] Converting new variant builder variants to formData format...');\r\n        console.log(' [ADMIN] Total generated variants to convert:', generatedVariants.length);\r\n        \r\n        // Process all variants, not just the first one\r\n        const allNewVariants: Variant[] = [];\r\n        const skuSetForConversion = new Set<string>();\r\n        \r\n        generatedVariants.forEach((variant, variantIndex) => {\r\n          const colorAttribute = attributes.find(a => a.key === 'color');\r\n          const sizeAttribute = attributes.find(a => a.key === 'size');\r\n          \r\n          // Get selected color and size values from variant\r\n          const selectedColorValueIds = colorAttribute \r\n            ? variant.selectedValueIds.filter(id => colorAttribute.values.some(v => v.id === id))\r\n            : [];\r\n          const selectedSizeValueIds = sizeAttribute \r\n            ? variant.selectedValueIds.filter(id => sizeAttribute.values.some(v => v.id === id))\r\n            : [];\r\n          \r\n          // Create colors from selected color values\r\n          const colors: ColorData[] = [];\r\n          \r\n          if (colorAttribute && selectedColorValueIds.length > 0) {\r\n            // Create one ColorData per selected color value\r\n            selectedColorValueIds.forEach((valueId) => {\r\n              const value = colorAttribute.values.find(v => v.id === valueId);\r\n              if (value) {\r\n                const colorData: ColorData = {\r\n                  colorValue: value.value,\r\n                  colorLabel: value.label,\r\n                  images: [],\r\n                  stock: variant.stock || '0',\r\n                  sizes: [],\r\n                  sizeStocks: {},\r\n                };\r\n                \r\n                // Add attribute value's imageUrl to color images if it exists\r\n                if (value.imageUrl) {\r\n                  colorData.images.push(value.imageUrl);\r\n                  console.log(' [ADMIN] Added attribute value imageUrl to color:', value.imageUrl);\r\n                }\r\n                \r\n                // Add price if set\r\n                if (variant.price) {\r\n                  colorData.price = variant.price;\r\n                }\r\n                if (variant.compareAtPrice) {\r\n                  colorData.compareAtPrice = variant.compareAtPrice;\r\n                }\r\n                \r\n                // Add sizes from selected size values\r\n                if (sizeAttribute && selectedSizeValueIds.length > 0) {\r\n                  selectedSizeValueIds.forEach((sizeValueId) => {\r\n                    const sizeValue = sizeAttribute.values.find(v => v.id === sizeValueId);\r\n                    if (sizeValue) {\r\n                      colorData.sizes.push(sizeValue.value);\r\n                      colorData.sizeStocks[sizeValue.value] = variant.stock || '0';\r\n                      if (!colorData.sizePrices) colorData.sizePrices = {};\r\n                      colorData.sizePrices[sizeValue.value] = variant.price || '0';\r\n                    }\r\n                  });\r\n                }\r\n                \r\n                colors.push(colorData);\r\n              }\r\n            });\r\n          } else if (sizeAttribute && selectedSizeValueIds.length > 0) {\r\n            // No color, but has size - create variant with empty colors but sizes\r\n            const colorData: ColorData = {\r\n              colorValue: '',\r\n              colorLabel: '',\r\n              images: [],\r\n              stock: variant.stock || '0',\r\n              sizes: [],\r\n              sizeStocks: {},\r\n            };\r\n            \r\n            selectedSizeValueIds.forEach((sizeValueId) => {\r\n              const sizeValue = sizeAttribute.values.find(v => v.id === sizeValueId);\r\n              if (sizeValue) {\r\n                colorData.sizes.push(sizeValue.value);\r\n                colorData.sizeStocks[sizeValue.value] = variant.stock || '0';\r\n                if (!colorData.sizePrices) colorData.sizePrices = {};\r\n                colorData.sizePrices[sizeValue.value] = variant.price || '0';\r\n                \r\n                // Add size attribute value's imageUrl if it exists\r\n                if (sizeValue.imageUrl) {\r\n                  colorData.images.push(sizeValue.imageUrl);\r\n                  console.log(' [ADMIN] Added size attribute value imageUrl:', sizeValue.imageUrl);\r\n                }\r\n              }\r\n            });\r\n            \r\n            // Add variant image if exists\r\n            if (variant.image) {\r\n              colorData.images.push(variant.image);\r\n            }\r\n            \r\n            colors.push(colorData);\r\n          } else {\r\n            // Handle non-color, non-size attributes (e.g., material)\r\n            // Collect all selected attribute values from other attributes\r\n            const otherAttributeIds = Array.from(selectedAttributesForVariants).filter(\r\n              attrId => attrId !== colorAttribute?.id && attrId !== sizeAttribute?.id\r\n            );\r\n            \r\n            if (otherAttributeIds.length > 0) {\r\n              const colorData: ColorData = {\r\n                colorValue: '',\r\n                colorLabel: '',\r\n                images: [],\r\n                stock: variant.stock || '0',\r\n                sizes: [],\r\n                sizeStocks: {},\r\n              };\r\n              \r\n              // Collect images from all selected attribute values\r\n              otherAttributeIds.forEach((attributeId) => {\r\n                const attribute = attributes.find(a => a.id === attributeId);\r\n                if (!attribute) return;\r\n                \r\n                const selectedValueIds = variant.selectedValueIds.filter(id => \r\n                  attribute.values.some(v => v.id === id)\r\n                );\r\n                \r\n                selectedValueIds.forEach((valueId) => {\r\n                  const value = attribute.values.find(v => v.id === valueId);\r\n                  if (value && value.imageUrl) {\r\n                    colorData.images.push(value.imageUrl);\r\n                    console.log(' [ADMIN] Added attribute value imageUrl from', attribute.key, ':', value.imageUrl);\r\n                  }\r\n                });\r\n              });\r\n              \r\n              // Add variant image if exists\r\n              if (variant.image) {\r\n                colorData.images.push(variant.image);\r\n              }\r\n              \r\n              if (colorData.images.length > 0 || variant.stock) {\r\n                colors.push(colorData);\r\n              }\r\n            }\r\n          }\r\n          \r\n          // Add variant image to first color's images if variant has image and not already added\r\n          if (variant.image && colors.length > 0) {\r\n            const firstColor = colors[0];\r\n            if (!firstColor.images.includes(variant.image)) {\r\n              firstColor.images.push(variant.image);\r\n            }\r\n          }\r\n          \r\n          // Generate unique SKU for this variant\r\n          let variantSku = variant.sku ? variant.sku.trim() : '';\r\n          if (!variantSku || variantSku === '') {\r\n            const baseSlug = formData.slug || 'PROD';\r\n            variantSku = `${baseSlug.toUpperCase()}-${Date.now()}-${variantIndex + 1}`;\r\n          }\r\n          \r\n          // Ensure SKU is unique\r\n          let finalSku = variantSku;\r\n          let skuCounter = 1;\r\n          while (skuSetForConversion.has(finalSku)) {\r\n            finalSku = `${variantSku}-${skuCounter}`;\r\n            skuCounter++;\r\n          }\r\n          skuSetForConversion.add(finalSku);\r\n          \r\n          // Create variant - preserve original ID if it exists (for edit mode)\r\n          allNewVariants.push({\r\n            id: variant.id || `variant-${Date.now()}-${variantIndex}-${Math.random()}`,\r\n            price: variant.price || '0',\r\n            compareAtPrice: variant.compareAtPrice || '',\r\n            sku: finalSku,\r\n            colors: colors.length > 0 ? colors : [],\r\n          });\r\n        });\r\n        \r\n        formData.variants = allNewVariants;\r\n        console.log(' [ADMIN] Converted variants:', formData.variants.length, 'with unique SKUs');\r\n      }\r\n\r\n      // Validate that at least one variant exists\r\n      console.log(' [ADMIN] Validating variants before submit:', {\r\n        variantsCount: formData.variants.length,\r\n        variants: formData.variants,\r\n        selectedAttributesCount: selectedAttributesForVariants.size,\r\n        productType: productType,\r\n      });\r\n      \r\n      // Skip variant validation for Simple products - they create variants later in the process\r\n      if (productType === 'variable' && formData.variants.length === 0) {\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Validate all variants (skip for simple products - validation is done in variant creation)\r\n      if (productType === 'variable') {\r\n      const skuSet = new Set<string>();\r\n      for (const variant of formData.variants) {\r\n        const variantIndex = formData.variants.indexOf(variant) + 1;\r\n        \r\n        // Skip base price validation as we now use color-specific prices\r\n        \r\n        // Validate SKU - must be unique within product\r\n        const variantSku = variant.sku ? variant.sku.trim() : '';\r\n        if (!variantSku || variantSku === '') {\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        \r\n        if (skuSet.has(variantSku)) {\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        skuSet.add(variantSku);\r\n        \r\n        // Validate colors, sizes, and stocks\r\n        const categoryRequiresSizes = isClothingCategory();\r\n        const colorData = variant.colors && variant.colors.length > 0 ? variant.colors : [];\r\n        \r\n        if (colorData.length > 0) {\r\n          for (const colorDataItem of colorData) {\r\n            const colorSizes = colorDataItem.sizes || [];\r\n            const colorSizeStocks = colorDataItem.sizeStocks || {};\r\n            \r\n            // Skip price validation for empty colors (non-color attributes)\r\n            // If colorValue is empty, use variant base price instead\r\n            const hasColor = colorDataItem.colorValue && colorDataItem.colorValue.trim() !== '';\r\n            \r\n            // Validate price for this color only if it has a color value\r\n            // For non-color attributes, use variant base price\r\n            if (hasColor) {\r\n              const colorPriceValue = parseFloat(colorDataItem.price || '0');\r\n              if (!colorDataItem.price || isNaN(colorPriceValue) || colorPriceValue <= 0) {\r\n                setLoading(false);\r\n                return;\r\n              }\r\n            } else {\r\n              // For non-color attributes, validate variant base price\r\n              // But only if this is the first colorDataItem (to avoid duplicate validation)\r\n              if (colorData.indexOf(colorDataItem) === 0) {\r\n                const variantPriceValue = parseFloat(variant.price || '0');\r\n                if (!variant.price || isNaN(variantPriceValue) || variantPriceValue <= 0) {\r\n                  setLoading(false);\r\n                  return;\r\n                }\r\n              }\r\n            }\r\n\r\n            // Size validation removed - attributes can work independently\r\n            // Validate stock for each size of this color (if sizes exist)\r\n            if (colorSizes.length > 0) {\r\n              for (const size of colorSizes) {\r\n                const stock = colorSizeStocks[size];\r\n                if (!stock || stock.trim() === '' || parseInt(stock) < 0) {\r\n                  setLoading(false);\r\n                  return;\r\n                }\r\n              }\r\n            } else {\r\n              // If no sizes, validate base stock for color\r\n              if (!colorDataItem.stock || colorDataItem.stock.trim() === '' || parseInt(colorDataItem.stock) < 0) {\r\n                setLoading(false);\r\n                return;\r\n              }\r\n            }\r\n          }\r\n        }\r\n        // No validation for variants without colors - attributes can work independently\r\n      }\r\n      } // End of variable products validation\r\n\r\n      // Prepare media array\r\n      // STRICT: Main media should ONLY contain formData.imageUrls (main product images)\r\n      // Color images should NOT be added to main media - they belong only in variant.imageUrl\r\n      const media = formData.imageUrls\r\n        .map((url, index) => ({\r\n          url: url.trim(),\r\n          type: 'image',\r\n          position: index,\r\n          isFeatured: index === 0, // First image is featured\r\n        }))\r\n        .filter(m => m.url);\r\n      \r\n      console.log(' [ADMIN] Main media images count:', media.length);\r\n      console.log(' [ADMIN] Main media (first 3):', media.slice(0, 3).map(m => m.url.substring(0, 50)));\r\n      console.log(' [ADMIN] Color images will be stored ONLY in variant.imageUrl, NOT in main media');\r\n\r\n      // Prepare variants array\r\n      // Use generatedVariants if available (new format with attributes JSONB)\r\n      // Otherwise fallback to formData.variants (legacy support)\r\n      const variants: any[] = [];\r\n      const variantSkuSet = new Set<string>(); // Track SKUs during variant creation\r\n      \r\n      // Handle Simple Products - create a single variant without attributes\r\n      if (productType === 'simple') {\r\n        console.log(' [ADMIN] Processing Simple Product');\r\n        \r\n        // Validate simple product fields\r\n        if (!simpleProductData.price || simpleProductData.price.trim() === '') {\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        if (!simpleProductData.sku || simpleProductData.sku.trim() === '') {\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        if (!simpleProductData.quantity || simpleProductData.quantity.trim() === '') {\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        \r\n        // Convert prices from defaultCurrency to USD\r\n        const priceUSD = convertPrice(parseFloat(simpleProductData.price), defaultCurrency, 'USD');\r\n        const compareAtPriceUSD = simpleProductData.compareAtPrice && simpleProductData.compareAtPrice.trim() !== ''\r\n          ? convertPrice(parseFloat(simpleProductData.compareAtPrice), defaultCurrency, 'USD')\r\n          : undefined;\r\n        \r\n        // Create a single variant without attributes\r\n        const simpleVariant: any = {\r\n          price: priceUSD,\r\n          stock: parseInt(simpleProductData.quantity) || 0,\r\n          sku: simpleProductData.sku.trim(),\r\n          published: true,\r\n        };\r\n        \r\n        if (compareAtPriceUSD) {\r\n          simpleVariant.compareAtPrice = compareAtPriceUSD;\r\n        }\r\n        \r\n        // No attributes for simple products - options array is empty/undefined\r\n        variants.push(simpleVariant);\r\n        variantSkuSet.add(simpleProductData.sku.trim());\r\n        \r\n        console.log(' [ADMIN] Simple product variant created:', simpleVariant);\r\n      } else {\r\n        // Variable products - process variants normally\r\n        // Check if we should use generatedVariants (new format)\r\n        const useGeneratedVariants = generatedVariants.length > 0 && selectedAttributesForVariants.size > 0;\r\n      \r\n      if (useGeneratedVariants) {\r\n        // NEW FORMAT: Create variants from generatedVariants (each variant has all attribute values)\r\n        console.log(' [ADMIN] Using generatedVariants format:', generatedVariants.length, 'variants');\r\n        console.log(' [ADMIN] Selected attributes for variants:', Array.from(selectedAttributesForVariants));\r\n        const sizeAttribute = getSizeAttribute();\r\n        console.log(' [ADMIN] Size attribute:', sizeAttribute ? { id: sizeAttribute.id, key: sizeAttribute.key } : 'not found');\r\n        \r\n        generatedVariants.forEach((genVariant, variantIndex) => {\r\n          // Convert prices from defaultCurrency to USD (database stores prices in USD)\r\n          const variantPriceUSD = convertPrice(parseFloat(genVariant.price || '0'), defaultCurrency, 'USD');\r\n          const variantCompareAtPriceUSD = genVariant.compareAtPrice \r\n            ? convertPrice(parseFloat(genVariant.compareAtPrice), defaultCurrency, 'USD')\r\n            : undefined;\r\n          \r\n          // Group valueIds by attribute\r\n          const attributeValueMap: Record<string, Array<{ valueId: string; value: string }>> = {};\r\n          \r\n          console.log(` [ADMIN] Variant ${variantIndex + 1} selectedValueIds:`, genVariant.selectedValueIds);\r\n          \r\n          genVariant.selectedValueIds.forEach((valueId) => {\r\n            // Find which attribute this valueId belongs to\r\n            const attribute = attributes.find(a => \r\n              a.values.some(v => v.id === valueId)\r\n            );\r\n            \r\n            if (attribute) {\r\n              const value = attribute.values.find(v => v.id === valueId);\r\n              if (value) {\r\n                console.log(`   Found attribute: ${attribute.key}, value: ${value.value}`);\r\n                if (!attributeValueMap[attribute.key]) {\r\n                  attributeValueMap[attribute.key] = [];\r\n                }\r\n                attributeValueMap[attribute.key].push({\r\n                  valueId: value.id,\r\n                  value: value.value,\r\n                });\r\n              }\r\n            } else {\r\n              console.warn(`   ValueId ${valueId} not found in any attribute`);\r\n            }\r\n          });\r\n          \r\n          // Generate all combinations of attribute values\r\n          // Example: If we have color: [Red, Green] and size: [S, M]\r\n          // We need to create: Red+S, Red+M, Green+S, Green+M\r\n          const attributeKeys = Object.keys(attributeValueMap);\r\n          if (attributeKeys.length === 0) {\r\n            // No attributes, create single variant\r\n            const finalSku = genVariant.sku || `${formData.slug || 'PROD'}-${Date.now()}-${variantIndex + 1}`;\r\n            let uniqueSku = finalSku;\r\n            let skuCounter = 1;\r\n            while (variantSkuSet.has(uniqueSku)) {\r\n              uniqueSku = `${finalSku}-${skuCounter}`;\r\n              skuCounter++;\r\n            }\r\n            variantSkuSet.add(uniqueSku);\r\n            \r\n            variants.push({\r\n              price: variantPriceUSD,\r\n              compareAtPrice: variantCompareAtPriceUSD,\r\n              stock: parseInt(genVariant.stock || '0') || 0,\r\n              sku: uniqueSku,\r\n              imageUrl: genVariant.image || undefined,\r\n              published: true,\r\n            });\r\n          } else {\r\n            // Generate all combinations\r\n            const attributeValueGroups = attributeKeys.map(key => \r\n              attributeValueMap[key].map(v => v.valueId)\r\n            );\r\n            \r\n            // Generate combinations using the same logic as generateAttributeCombinations\r\n            const generateCombinations = (groups: string[][]): string[][] => {\r\n              if (groups.length === 0) return [[]];\r\n              if (groups.length === 1) return groups[0].map(v => [v]);\r\n              \r\n              const [firstGroup, ...restGroups] = groups;\r\n              const restCombinations = generateCombinations(restGroups);\r\n              const result: string[][] = [];\r\n              \r\n              for (const value of firstGroup) {\r\n                for (const combination of restCombinations) {\r\n                  result.push([value, ...combination]);\r\n                }\r\n              }\r\n              \r\n              return result;\r\n            };\r\n            \r\n            const combinations = generateCombinations(attributeValueGroups);\r\n            console.log(` [ADMIN] Variant ${variantIndex + 1} will expand to ${combinations.length} combinations:`, combinations);\r\n            \r\n            // Create a variant for each combination\r\n            combinations.forEach((combination, comboIndex) => {\r\n              // Build options for this combination\r\n              const variantOptions: Array<{ attributeKey: string; value: string; valueId?: string }> = [];\r\n              \r\n              combination.forEach((valueId) => {\r\n                // Find which attribute this valueId belongs to\r\n                const attribute = attributes.find(a => \r\n                  a.values.some(v => v.id === valueId)\r\n                );\r\n                \r\n                if (attribute) {\r\n                  const value = attribute.values.find(v => v.id === valueId);\r\n                  if (value) {\r\n                    variantOptions.push({\r\n                      attributeKey: attribute.key,\r\n                      value: value.value,\r\n                      valueId: value.id,\r\n                    });\r\n                  }\r\n                }\r\n              });\r\n              \r\n              // Generate SKU for this combination\r\n              const baseSlug = formData.slug || 'PROD';\r\n              const valueParts = variantOptions.map(opt => opt.value.toUpperCase().replace(/\\s+/g, '-'));\r\n              const skuSuffix = valueParts.length > 0 ? `-${valueParts.join('-')}` : '';\r\n              const finalSku = genVariant.sku \r\n                ? `${genVariant.sku}${skuSuffix}`\r\n                : `${baseSlug.toUpperCase()}-${Date.now()}-${variantIndex + 1}-${comboIndex + 1}${skuSuffix}`;\r\n              \r\n              // Ensure SKU is unique\r\n              let uniqueSku = finalSku;\r\n              let skuCounter = 1;\r\n              while (variantSkuSet.has(uniqueSku)) {\r\n                uniqueSku = `${finalSku}-${skuCounter}`;\r\n                skuCounter++;\r\n              }\r\n              variantSkuSet.add(uniqueSku);\r\n              \r\n              console.log(`   Creating variant combination ${comboIndex + 1}/${combinations.length}:`, {\r\n                options: variantOptions.map(o => `${o.attributeKey}=${o.value}`).join(', '),\r\n                sku: uniqueSku,\r\n                price: variantPriceUSD,\r\n                stock: genVariant.stock,\r\n              });\r\n              \r\n              variants.push({\r\n                price: variantPriceUSD,\r\n                compareAtPrice: variantCompareAtPriceUSD,\r\n                stock: parseInt(genVariant.stock || '0') || 0,\r\n                sku: uniqueSku,\r\n                imageUrl: genVariant.image || undefined,\r\n                published: true,\r\n                options: variantOptions.length > 0 ? variantOptions : undefined,\r\n              });\r\n            });\r\n          }\r\n        });\r\n      } else {\r\n        // Create variants from formData.variants (legacy support)\r\n        console.log(' [ADMIN] Using formData.variants format (legacy)');\r\n        console.log(' [ADMIN] formData.variants count:', formData.variants.length);\r\n        const sizeAttribute = getSizeAttribute();\r\n        console.log(' [ADMIN] Size attribute:', sizeAttribute ? { id: sizeAttribute.id, key: sizeAttribute.key } : 'not found');\r\n        \r\n        formData.variants.forEach((variant, variantIndex) => {\r\n        // Convert prices from defaultCurrency to USD (database stores prices in USD)\r\n        const variantPriceUSD = convertPrice(parseFloat(variant.price || '0'), defaultCurrency, 'USD');\r\n        const baseVariantData: any = {\r\n          price: variantPriceUSD,\r\n          published: true,\r\n        };\r\n\r\n        if (variant.compareAtPrice) {\r\n          baseVariantData.compareAtPrice = convertPrice(parseFloat(variant.compareAtPrice), defaultCurrency, 'USD');\r\n        }\r\n\r\n        //      ColorData\r\n        const colorDataArray = variant.colors || [];\r\n\r\n        // Process each color (colors are optional now)\r\n        if (colorDataArray.length > 0) {\r\n          colorDataArray.forEach((colorData, colorIndex) => {\r\n          const colorSizes = colorData.sizes || [];\r\n          const colorSizeStocks = colorData.sizeStocks || {};\r\n\r\n          // If color has sizes - create variants for each color-size combination\r\n          if (colorSizes.length > 0) {\r\n            colorSizes.forEach((size, sizeIndex) => {\r\n              // Use stock from sizeStocks for this color-size combination\r\n              const stockForVariant = colorSizeStocks[size] || colorData.stock || '0';\r\n              \r\n              const skuSuffix = colorDataArray.length > 1 || colorSizes.length > 1 \r\n                ? `-${colorIndex + 1}-${sizeIndex + 1}` \r\n                : '';\r\n              \r\n              // Generate SKU if not provided\r\n              // First check if there's a specific SKU for this size in sizeLabels\r\n              let finalSku = colorData.sizeLabels?.[size] || undefined;\r\n              \r\n              // If no specific SKU, use variant base SKU with suffix\r\n              if (!finalSku || finalSku === '') {\r\n                finalSku = variant.sku ? `${variant.sku.trim()}${skuSuffix}` : undefined;\r\n              }\r\n              \r\n              // If still no SKU, generate one\r\n              if (!finalSku || finalSku === '') {\r\n                const baseSlug = formData.slug || 'PROD';\r\n                finalSku = `${baseSlug.toUpperCase()}-${Date.now()}-${variantIndex + 1}-${colorIndex + 1}-${sizeIndex + 1}`;\r\n              }\r\n              \r\n              // Ensure SKU is unique during creation\r\n              let uniqueSku = finalSku;\r\n              let skuCounter = 1;\r\n              while (variantSkuSet.has(uniqueSku)) {\r\n                uniqueSku = `${finalSku}-${skuCounter}`;\r\n                skuCounter++;\r\n              }\r\n              variantSkuSet.add(uniqueSku);\r\n              finalSku = uniqueSku;\r\n              \r\n              //        imageUrl\r\n              const variantImageUrl = colorData.images && colorData.images.length > 0 \r\n                ? colorData.images.join(',') \r\n                : undefined;\r\n              \r\n              //   ,  ,   ,   \r\n              // Convert from defaultCurrency to USD\r\n              const sizePrice = colorData.sizePrices?.[size];\r\n              const finalPriceRaw = sizePrice && sizePrice.trim() !== ''\r\n                ? parseFloat(sizePrice)\r\n                : (colorData.price && colorData.price.trim() !== '' \r\n                  ? parseFloat(colorData.price) \r\n                  : baseVariantData.price);\r\n              const finalPrice = convertPrice(finalPriceRaw, defaultCurrency, 'USD');\r\n              \r\n              //  compareAtPrice ,  ,  compareAtPrice ,  compareAtPrice \r\n              // Convert from defaultCurrency to USD\r\n              const sizeCompareAtPrice = colorData.sizeCompareAtPrices?.[size];\r\n              const finalCompareAtPriceRaw = sizeCompareAtPrice && sizeCompareAtPrice.trim() !== ''\r\n                ? parseFloat(sizeCompareAtPrice)\r\n                : (colorData.compareAtPrice && colorData.compareAtPrice.trim() !== ''\r\n                  ? parseFloat(colorData.compareAtPrice)\r\n                  : baseVariantData.compareAtPrice);\r\n              const finalCompareAtPrice = finalCompareAtPriceRaw ? convertPrice(finalCompareAtPriceRaw, defaultCurrency, 'USD') : undefined;\r\n              \r\n              // Collect all attribute options for this variant\r\n              const variantOptions: Array<{ attributeKey: string; value: string; valueId?: string }> = [];\r\n              \r\n              // Add color option if exists\r\n              if (colorData.colorValue && colorData.colorValue.trim() !== '') {\r\n                const colorAttr = attributes.find(a => a.key === 'color');\r\n                const colorValue = colorAttr?.values.find(v => v.value === colorData.colorValue);\r\n                if (colorValue) {\r\n                  variantOptions.push({ attributeKey: 'color', value: colorData.colorValue, valueId: colorValue.id });\r\n                } else {\r\n                  variantOptions.push({ attributeKey: 'color', value: colorData.colorValue });\r\n                }\r\n              }\r\n              \r\n              // Add size option if exists\r\n              if (size && size.trim() !== '') {\r\n                const sizeAttr = attributes.find(a => a.key === 'size');\r\n                const sizeValue = sizeAttr?.values.find(v => v.value === size);\r\n                if (sizeValue) {\r\n                  variantOptions.push({ attributeKey: 'size', value: size, valueId: sizeValue.id });\r\n                } else {\r\n                  variantOptions.push({ attributeKey: 'size', value: size });\r\n                }\r\n              }\r\n              \r\n              // Add other attribute options from selectedAttributesForVariants (excluding color and size as they're already added)\r\n              if (selectedAttributesForVariants.size > 0 && generatedVariants.length > 0) {\r\n                const variant = generatedVariants[0];\r\n                Array.from(selectedAttributesForVariants).forEach((attributeId) => {\r\n                  const attribute = attributes.find(a => a.id === attributeId);\r\n                  if (!attribute || attribute.key === 'color' || attribute.key === 'size') return;\r\n                  \r\n                  const selectedValueIds = variant.selectedValueIds.filter(id => \r\n                    attribute.values.some(v => v.id === id)\r\n                  );\r\n                  \r\n                  selectedValueIds.forEach((valueId) => {\r\n                    const value = attribute.values.find(v => v.id === valueId);\r\n                    if (value) {\r\n                      variantOptions.push({ attributeKey: attribute.key, value: value.value, valueId: value.id });\r\n                    }\r\n                  });\r\n                });\r\n              }\r\n              \r\n              variants.push({\r\n                ...baseVariantData,\r\n                price: finalPrice,\r\n                compareAtPrice: finalCompareAtPrice,\r\n                color: colorData.colorValue,\r\n                size: size,\r\n                stock: parseInt(stockForVariant) || 0,\r\n                sku: finalSku,\r\n                imageUrl: variantImageUrl,\r\n                isFeatured: !!colorData.isFeatured,\r\n                options: variantOptions.length > 0 ? variantOptions : undefined,\r\n              });\r\n            });\r\n          } \r\n          // If color has no sizes - create variant with just color\r\n          else {\r\n            const skuSuffix = colorDataArray.length > 1 ? `-${colorIndex + 1}` : '';\r\n            \r\n            // Use base color stock\r\n            const stockForVariant = colorData.stock || '0';\r\n            \r\n            // Generate SKU if not provided\r\n            let finalSku = variant.sku ? `${variant.sku.trim()}${skuSuffix}` : undefined;\r\n            if (!finalSku || finalSku === '') {\r\n              const baseSlug = formData.slug || 'PROD';\r\n              finalSku = `${baseSlug.toUpperCase()}-${Date.now()}-${variantIndex + 1}-${colorIndex + 1}`;\r\n            }\r\n            \r\n            // Ensure SKU is unique during creation\r\n            let uniqueSku = finalSku;\r\n            let skuCounter = 1;\r\n            while (variantSkuSet.has(uniqueSku)) {\r\n              uniqueSku = `${finalSku}-${skuCounter}`;\r\n              skuCounter++;\r\n            }\r\n            variantSkuSet.add(uniqueSku);\r\n            finalSku = uniqueSku;\r\n\r\n            //        imageUrl\r\n            const variantImageUrl = colorData.images && colorData.images.length > 0 \r\n              ? colorData.images.join(',') \r\n              : undefined;\r\n\r\n            //   ,  ,   \r\n            // For empty colors (non-color attributes), always use variant base price\r\n            // Convert from defaultCurrency to USD\r\n            const hasColor = colorData.colorValue && colorData.colorValue.trim() !== '';\r\n            const finalPriceRaw = hasColor && colorData.price && colorData.price.trim() !== '' \r\n              ? parseFloat(colorData.price) \r\n              : baseVariantData.price;\r\n            const finalPrice = convertPrice(finalPriceRaw, defaultCurrency, 'USD');\r\n\r\n            const finalCompareAtPriceRaw = hasColor && colorData.compareAtPrice && colorData.compareAtPrice.trim() !== ''\r\n              ? parseFloat(colorData.compareAtPrice)\r\n              : baseVariantData.compareAtPrice;\r\n            const finalCompareAtPrice = finalCompareAtPriceRaw ? convertPrice(finalCompareAtPriceRaw, defaultCurrency, 'USD') : undefined;\r\n\r\n            // Collect all attribute options for this variant\r\n            const variantOptions: Array<{ attributeKey: string; value: string; valueId?: string }> = [];\r\n            \r\n            // Add color option if exists\r\n            if (colorData.colorValue && colorData.colorValue.trim() !== '') {\r\n              const colorAttr = attributes.find(a => a.key === 'color');\r\n              const colorValue = colorAttr?.values.find(v => v.value === colorData.colorValue);\r\n              if (colorValue) {\r\n                variantOptions.push({ attributeKey: 'color', value: colorData.colorValue, valueId: colorValue.id });\r\n              } else {\r\n                variantOptions.push({ attributeKey: 'color', value: colorData.colorValue });\r\n              }\r\n            }\r\n            \r\n            // Add other attribute options from selectedAttributesForVariants\r\n            if (selectedAttributesForVariants.size > 0 && generatedVariants.length > 0) {\r\n              const variant = generatedVariants[0];\r\n              Array.from(selectedAttributesForVariants).forEach((attributeId) => {\r\n                const attribute = attributes.find(a => a.id === attributeId);\r\n                if (!attribute || attribute.key === 'color' || attribute.key === 'size') return;\r\n                \r\n                const selectedValueIds = variant.selectedValueIds.filter(id => \r\n                  attribute.values.some(v => v.id === id)\r\n                );\r\n                \r\n                selectedValueIds.forEach((valueId) => {\r\n                  const value = attribute.values.find(v => v.id === valueId);\r\n                  if (value) {\r\n                    variantOptions.push({ attributeKey: attribute.key, value: value.value, valueId: value.id });\r\n                  }\r\n                });\r\n              });\r\n            }\r\n            \r\n            variants.push({\r\n              ...baseVariantData,\r\n              price: finalPrice,\r\n              compareAtPrice: finalCompareAtPrice,\r\n              color: colorData.colorValue && colorData.colorValue.trim() !== '' ? colorData.colorValue : undefined,\r\n              stock: parseInt(stockForVariant) || 0,\r\n              sku: finalSku,\r\n              imageUrl: variantImageUrl,\r\n              isFeatured: !!colorData.isFeatured,\r\n              options: variantOptions.length > 0 ? variantOptions : undefined,\r\n            });\r\n          }\r\n        });\r\n        } else {\r\n          // No colors - create variant without color\r\n          // Check if we have sizes in variant.sizes or need to handle sizes separately\r\n          const variantSizes = variant.sizes || [];\r\n          const variantSizeStocks = variant.sizeStocks || {};\r\n          \r\n          // If variant has sizes, create variants for each size\r\n          if (variantSizes.length > 0) {\r\n            variantSizes.forEach((size, sizeIndex) => {\r\n              const stockForVariant = variantSizeStocks[size] || '0';\r\n              \r\n              const skuSuffix = variantSizes.length > 1 ? `-${sizeIndex + 1}` : '';\r\n              \r\n              // Generate SKU if not provided\r\n              let finalSku = variant.sku ? `${variant.sku.trim()}${skuSuffix}` : undefined;\r\n              if (!finalSku || finalSku === '') {\r\n                finalSku = formData.slug ? `${formData.slug.toUpperCase()}-${Date.now()}-${variantIndex + 1}-${sizeIndex + 1}` : undefined;\r\n              }\r\n              \r\n              // Ensure SKU is unique during creation\r\n              let uniqueSku = finalSku;\r\n              if (uniqueSku) {\r\n                let skuCounter = 1;\r\n                while (variantSkuSet.has(uniqueSku)) {\r\n                  uniqueSku = `${finalSku}-${skuCounter}`;\r\n                  skuCounter++;\r\n                }\r\n                variantSkuSet.add(uniqueSku);\r\n                finalSku = uniqueSku;\r\n              }\r\n              \r\n              // Convert prices from defaultCurrency to USD\r\n              const finalPrice = convertPrice(baseVariantData.price, defaultCurrency, 'USD');\r\n              const finalCompareAtPrice = baseVariantData.compareAtPrice \r\n                ? convertPrice(baseVariantData.compareAtPrice, defaultCurrency, 'USD')\r\n                : undefined;\r\n              \r\n              // Collect all attribute options for this variant\r\n              const variantOptions: Array<{ attributeKey: string; value: string; valueId?: string }> = [];\r\n              \r\n              // Add size option\r\n              if (size && size.trim() !== '') {\r\n                const sizeAttr = attributes.find(a => a.key === 'size');\r\n                const sizeValue = sizeAttr?.values.find(v => v.value === size);\r\n                if (sizeValue) {\r\n                  variantOptions.push({ attributeKey: 'size', value: size, valueId: sizeValue.id });\r\n                } else {\r\n                  variantOptions.push({ attributeKey: 'size', value: size });\r\n                }\r\n              }\r\n              \r\n              // Add other attribute options from selectedAttributesForVariants (excluding color and size)\r\n              if (selectedAttributesForVariants.size > 0 && generatedVariants.length > 0) {\r\n                const genVariant = generatedVariants[0];\r\n                Array.from(selectedAttributesForVariants).forEach((attributeId) => {\r\n                  const attribute = attributes.find(a => a.id === attributeId);\r\n                  if (!attribute || attribute.key === 'color' || attribute.key === 'size') return;\r\n                  \r\n                  const selectedValueIds = genVariant.selectedValueIds.filter(id => \r\n                    attribute.values.some(v => v.id === id)\r\n                  );\r\n                  \r\n                  selectedValueIds.forEach((valueId) => {\r\n                    const value = attribute.values.find(v => v.id === valueId);\r\n                    if (value) {\r\n                      variantOptions.push({ attributeKey: attribute.key, value: value.value, valueId: value.id });\r\n                    }\r\n                  });\r\n                });\r\n              }\r\n              \r\n              variants.push({\r\n                ...baseVariantData,\r\n                price: finalPrice,\r\n                compareAtPrice: finalCompareAtPrice,\r\n                size: size,\r\n                stock: parseInt(stockForVariant) || 0,\r\n                sku: finalSku,\r\n                options: variantOptions.length > 0 ? variantOptions : undefined,\r\n              });\r\n            });\r\n          } else {\r\n            // No colors and no sizes - create single variant without color and size\r\n            // But check if we have images from non-color attributes\r\n            let finalSku = variant.sku ? variant.sku.trim() : undefined;\r\n            if (!finalSku || finalSku === '') {\r\n              finalSku = formData.slug ? `${formData.slug.toUpperCase()}-${Date.now()}-${variantIndex + 1}` : undefined;\r\n            }\r\n            \r\n            // Ensure SKU is unique during creation\r\n            let uniqueSku = finalSku;\r\n            if (uniqueSku) {\r\n              let skuCounter = 1;\r\n              while (variantSkuSet.has(uniqueSku)) {\r\n                uniqueSku = `${finalSku}-${skuCounter}`;\r\n                skuCounter++;\r\n              }\r\n              variantSkuSet.add(uniqueSku);\r\n              finalSku = uniqueSku;\r\n            }\r\n            \r\n            const generatedSku = finalSku;\r\n            \r\n            // Check if we have any images from attribute values (for non-color, non-size attributes)\r\n            let variantImageUrl: string | undefined = undefined;\r\n            if (selectedAttributesForVariants.size > 0) {\r\n              const allAttributeImages: string[] = [];\r\n              Array.from(selectedAttributesForVariants).forEach((attributeId) => {\r\n                const attribute = attributes.find(a => a.id === attributeId);\r\n                if (!attribute || attribute.key === 'color' || attribute.key === 'size') return;\r\n                \r\n                // Get selected value IDs for this attribute from generatedVariants\r\n                // Collect images from all values of this attribute if it's selected\r\n                attribute.values.forEach((value) => {\r\n                  if (value.imageUrl) {\r\n                    allAttributeImages.push(value.imageUrl);\r\n                  }\r\n                });\r\n              });\r\n              \r\n              if (allAttributeImages.length > 0) {\r\n                variantImageUrl = allAttributeImages.join(',');\r\n                console.log(' [ADMIN] Added images from non-color attributes to variant:', variantImageUrl);\r\n              }\r\n            }\r\n            \r\n            // Collect all attribute options for this variant\r\n            const variantOptions: Array<{ attributeKey: string; value: string; valueId?: string }> = [];\r\n            \r\n            // Add all attribute options from selectedAttributesForVariants\r\n            if (selectedAttributesForVariants.size > 0 && generatedVariants.length > 0) {\r\n              const genVariant = generatedVariants[0];\r\n              Array.from(selectedAttributesForVariants).forEach((attributeId) => {\r\n                const attribute = attributes.find(a => a.id === attributeId);\r\n                if (!attribute) return;\r\n                \r\n                const selectedValueIds = genVariant.selectedValueIds.filter(id => \r\n                  attribute.values.some(v => v.id === id)\r\n                );\r\n                \r\n                selectedValueIds.forEach((valueId) => {\r\n                  const value = attribute.values.find(v => v.id === valueId);\r\n                  if (value) {\r\n                    variantOptions.push({ attributeKey: attribute.key, value: value.value, valueId: value.id });\r\n                  }\r\n                });\r\n              });\r\n            }\r\n            \r\n            variants.push({\r\n              ...baseVariantData,\r\n              color: undefined,\r\n              stock: 0,\r\n              sku: generatedSku,\r\n              imageUrl: variantImageUrl,\r\n              options: variantOptions.length > 0 ? variantOptions : undefined,\r\n            });\r\n          }\r\n        }\r\n      });\r\n      }\r\n      } // End of variable products variant processing\r\n\r\n      // Final validation - ensure all SKUs are unique\r\n      const finalSkuSet = new Set<string>();\r\n      for (let i = 0; i < variants.length; i++) {\r\n        const variant = variants[i];\r\n        if (!variant.sku || variant.sku.trim() === '') {\r\n          // Generate SKU if still missing\r\n          const baseSlug = formData.slug || 'PROD';\r\n          variant.sku = `${baseSlug.toUpperCase()}-${Date.now()}-${i + 1}`;\r\n        } else {\r\n          variant.sku = variant.sku.trim();\r\n        }\r\n        \r\n        // Ensure SKU is unique - keep generating until we find a unique one\r\n        let finalSku = variant.sku;\r\n        let skuCounter = 1;\r\n        while (finalSkuSet.has(finalSku)) {\r\n          const baseSlug = formData.slug || 'PROD';\r\n          finalSku = `${baseSlug.toUpperCase()}-${Date.now()}-${i + 1}-${skuCounter}-${Math.random().toString(36).substr(2, 4)}`;\r\n          skuCounter++;\r\n          console.log(` [ADMIN] Duplicate SKU found, generating new one: ${finalSku}`);\r\n        }\r\n        \r\n        variant.sku = finalSku;\r\n        finalSkuSet.add(finalSku);\r\n      }\r\n      \r\n      console.log(' [ADMIN] Final SKU validation complete. All SKUs are unique:', Array.from(finalSkuSet));\r\n\r\n      // Final validation - check size requirement for categories that require sizes\r\n      // Skip this validation for Simple products - they don't have size attributes\r\n      const categoryRequiresSizesFinal = isClothingCategory();\r\n      if (productType === 'variable' && categoryRequiresSizesFinal && finalPrimaryCategoryId) {\r\n        console.log(' [VALIDATION] Checking size requirement for category:', finalPrimaryCategoryId);\r\n        console.log(' [VALIDATION] Total variants to check:', variants.length);\r\n        \r\n        // Check if any variant has size in options array or size field\r\n        const variantsWithSize: any[] = [];\r\n        const variantsWithoutSize: any[] = [];\r\n        \r\n        variants.forEach((variant, index) => {\r\n          let hasSize = false;\r\n          let sizeSource = '';\r\n          \r\n          // Check variant.size field (legacy support)\r\n          if (variant.size && variant.size.trim() !== \"\") {\r\n            hasSize = true;\r\n            sizeSource = 'variant.size';\r\n          }\r\n          \r\n          // New format: check variant.options array for size attribute\r\n          if (!hasSize && variant.options && Array.isArray(variant.options)) {\r\n            const sizeOption = variant.options.find((opt: any) => {\r\n              return (opt.attributeKey === 'size' || opt.key === 'size' || opt.attribute === 'size') &&\r\n                     opt.value && opt.value.trim() !== \"\";\r\n            });\r\n            if (sizeOption) {\r\n              hasSize = true;\r\n              sizeSource = 'variant.options';\r\n            }\r\n          }\r\n          \r\n          if (hasSize) {\r\n            variantsWithSize.push({ index, variant, sizeSource });\r\n          } else {\r\n            variantsWithoutSize.push({ index, variant });\r\n          }\r\n        });\r\n        \r\n        console.log(' [VALIDATION] Variants with size:', variantsWithSize.length, variantsWithSize.map(v => ({\r\n          index: v.index,\r\n          size: v.variant.size,\r\n          options: v.variant.options,\r\n          source: v.sizeSource\r\n        })));\r\n        console.log(' [VALIDATION] Variants without size:', variantsWithoutSize.length, variantsWithoutSize.map(v => ({\r\n          index: v.index,\r\n          hasSizeField: !!v.variant.size,\r\n          hasOptions: !!v.variant.options,\r\n          options: v.variant.options\r\n        })));\r\n\r\n        if (variantsWithSize.length === 0) {\r\n          console.error(' [VALIDATION] Final size validation failed. No variants have size.');\r\n          console.error(' [VALIDATION] All variants:', JSON.stringify(variants, null, 2));\r\n          console.error(' [VALIDATION] Debug info:', {\r\n            totalVariants: variants.length,\r\n            useGeneratedVariants: productType === 'variable' && generatedVariants.length > 0 && selectedAttributesForVariants.size > 0,\r\n            selectedAttributesForVariants: Array.from(selectedAttributesForVariants),\r\n            sizeAttribute: getSizeAttribute()?.id,\r\n            generatedVariantsCount: generatedVariants.length,\r\n            formDataVariantsCount: formData.variants.length\r\n          });\r\n        \r\n          \r\n                  }\r\n        console.log(' [VALIDATION] Final size validation passed. Found', variantsWithSize.length, 'variant(s) with size.');\r\n      } else {\r\n        console.log(' [VALIDATION] Size validation skipped (category does not require sizes)');\r\n      }\r\n      \r\n      // Colors are now optional - no validation needed\r\n\r\n      // Collect attribute IDs from variants (color and size attributes)\r\n      const attributeIdsSet = new Set<string>();\r\n      const colorAttribute = getColorAttribute();\r\n      const sizeAttribute = getSizeAttribute();\r\n      if (colorAttribute) {\r\n        attributeIdsSet.add(colorAttribute.id);\r\n      }\r\n      if (sizeAttribute) {\r\n        attributeIdsSet.add(sizeAttribute.id);\r\n      }\r\n      const attributeIds = Array.from(attributeIdsSet);\r\n\r\n      // Prepare payload\r\n      // Note: Database supports single brandId, so we use the first selected brand\r\n      // For multiple brands, we would need to update the schema to support brandIds array\r\n      const payload: any = {\r\n        title: formData.title,\r\n        slug: formData.slug,\r\n        descriptionHtml: formData.descriptionHtml || undefined,\r\n        brandId: finalBrandIds.length > 0 ? finalBrandIds[0] : undefined,\r\n        primaryCategoryId: finalPrimaryCategoryId || undefined,\r\n        categoryIds: formData.categoryIds.length > 0 ? formData.categoryIds : undefined,\r\n        //       \r\n        //      \r\n        published: isEditMode ? formData.published : true,\r\n        featured: formData.featured,\r\n        locale: 'en',\r\n        variants: variants,\r\n        attributeIds: attributeIds.length > 0 ? attributeIds : undefined,\r\n      };\r\n\r\n      // Helper function to check if image is base64\r\n      const isBase64Image = (url: string): boolean => {\r\n        return url.startsWith('data:image/');\r\n      };\r\n\r\n      // Helper function to check if image is already a URL\r\n      const isUrl = (url: string): boolean => {\r\n        return url.startsWith('http://') || url.startsWith('https://');\r\n      };\r\n\r\n      // Helper function to get base64 size in bytes (approximate)\r\n      const getBase64Size = (base64: string): number => {\r\n        // Remove data:image/...;base64, prefix\r\n        const base64Data = base64.includes(',') ? base64.split(',')[1] : base64;\r\n        // Base64 is ~33% larger than binary, so we calculate approximate size\r\n        return Math.ceil(base64Data.length * 0.75);\r\n      };\r\n\r\n      // Helper function to process images - keep URLs as is, filter out large base64\r\n      const processImages = (images: string[]): { processed: string[]; skipped: number } => {\r\n        const MAX_BASE64_SIZE = 5 * 1024 * 1024; // 5MB per image max\r\n        let skippedCount = 0;\r\n        \r\n        const processed = images.filter(img => {\r\n          // If already a URL, keep as is\r\n          if (isUrl(img)) {\r\n            return true;\r\n          }\r\n          \r\n          // If base64, check size\r\n          if (isBase64Image(img)) {\r\n            const size = getBase64Size(img);\r\n            if (size > MAX_BASE64_SIZE) {\r\n              console.warn(` [ADMIN] Image too large (${Math.round(size / 1024)}KB), skipping to avoid 413 error.`);\r\n              skippedCount++;\r\n              return false; // Skip large base64 images\r\n            }\r\n            // Small base64, keep as is (will be in payload)\r\n            return true;\r\n          }\r\n          \r\n          // Unknown format, keep as is\r\n          return true;\r\n        });\r\n        \r\n        return { processed, skipped: skippedCount };\r\n      };\r\n\r\n      // Process main product images separately to maintain exact mapping\r\n      const mainImages: string[] = [];\r\n      if (formData.imageUrls.length > 0) {\r\n        mainImages.push(...formData.imageUrls.filter(Boolean));\r\n      } else if (formData.mainProductImage) {\r\n        mainImages.push(formData.mainProductImage);\r\n      }\r\n\r\n      // Process main images with position preservation\r\n      // This function processes each image individually and preserves original positions\r\n      const processMainImagesWithPositions = (images: string[]): { mapping: (string | null)[]; skipped: number } => {\r\n        const MAX_BASE64_SIZE = 5 * 1024 * 1024; // 5MB per image max\r\n        const mapping: (string | null)[] = [];\r\n        let skippedCount = 0;\r\n        \r\n        images.forEach((img) => {\r\n          // If already a URL, keep as is\r\n          if (isUrl(img)) {\r\n            mapping.push(img);\r\n            return;\r\n          }\r\n          \r\n          // If base64, check size\r\n          if (isBase64Image(img)) {\r\n            const size = getBase64Size(img);\r\n            if (size > MAX_BASE64_SIZE) {\r\n              console.warn(` [ADMIN] Main image too large (${Math.round(size / 1024)}KB), skipping to avoid 413 error.`);\r\n              skippedCount++;\r\n              mapping.push(null); // Mark as skipped\r\n              return;\r\n            }\r\n            // Small base64, keep as is\r\n            mapping.push(img);\r\n            return;\r\n          }\r\n          \r\n          // Unknown format, keep as is\r\n          mapping.push(img);\r\n        });\r\n        \r\n        return { mapping, skipped: skippedCount };\r\n      };\r\n      \r\n      const mainImagesProcessed = mainImages.length > 0 ? processMainImagesWithPositions(mainImages) : { mapping: [], skipped: 0 };\r\n      const mainImageMapping = mainImagesProcessed.mapping; // Keep nulls to preserve positions\r\n\r\n      // Collect variant images\r\n      const variantImages: string[] = [];\r\n      variants.forEach(variant => {\r\n        if (variant.imageUrl) {\r\n          // imageUrl can be comma-separated string\r\n          const imageUrls = variant.imageUrl.split(',').map((url: string) => url.trim()).filter(Boolean);\r\n          variantImages.push(...imageUrls);\r\n        }\r\n      });\r\n\r\n      // Process variant images\r\n      const variantImagesProcessed = variantImages.length > 0 ? processImages(variantImages) : { processed: [], skipped: 0 };\r\n      const processedVariantImages = variantImagesProcessed.processed;\r\n      const skippedImagesCount = mainImagesProcessed.skipped + variantImagesProcessed.skipped;\r\n      \r\n      // Warn user if images were skipped\r\n      if (skippedImagesCount > 0) {\r\n        console.warn(` [ADMIN] ${skippedImagesCount} large image(s) were skipped to avoid 413 error.`);\r\n      }\r\n\r\n      // Update variants with processed images\r\n      let variantImageIndex = 0;\r\n      variants.forEach(variant => {\r\n        if (variant.imageUrl) {\r\n          const imageUrls = variant.imageUrl.split(',').map((url: string) => url.trim()).filter(Boolean);\r\n          const processedUrls = processedVariantImages.slice(variantImageIndex, variantImageIndex + imageUrls.length);\r\n          variant.imageUrl = processedUrls.join(',');\r\n          variantImageIndex += imageUrls.length;\r\n        }\r\n      });\r\n\r\n      // Build final media array with proper order\r\n      const finalMedia: string[] = [];\r\n      \r\n      if (formData.imageUrls.length > 0) {\r\n        // Use mainImageMapping which preserves positions\r\n        // Map it back to formData.imageUrls indices\r\n        const processedImageUrls: string[] = [];\r\n        \r\n        formData.imageUrls.forEach((originalUrl, index) => {\r\n          if (!originalUrl || !originalUrl.trim()) {\r\n            return; // Skip empty URLs\r\n          }\r\n          \r\n          // Find corresponding processed image in mainImageMapping\r\n          // mainImageMapping is in the same order as mainImages (which is formData.imageUrls)\r\n          const mainImagesIndex = mainImages.indexOf(originalUrl);\r\n          if (mainImagesIndex >= 0 && mainImagesIndex < mainImageMapping.length) {\r\n            const processedImg = mainImageMapping[mainImagesIndex];\r\n            if (processedImg) {\r\n              processedImageUrls[index] = processedImg;\r\n            }\r\n            // If null, image was skipped - don't add it to finalMedia\r\n          }\r\n        });\r\n        \r\n        // Add featured image first (main image)\r\n        if (processedImageUrls[formData.featuredImageIndex]) {\r\n          finalMedia.push(processedImageUrls[formData.featuredImageIndex]);\r\n        }\r\n        // Add other images in order (skip null/undefined)\r\n        processedImageUrls.forEach((url, index) => {\r\n          if (index !== formData.featuredImageIndex && url) {\r\n            finalMedia.push(url);\r\n          }\r\n        });\r\n      } else if (formData.mainProductImage) {\r\n        // Fallback to legacy mainProductImage\r\n        const mainImgProcessed = mainImageMapping[0];\r\n        if (mainImgProcessed) {\r\n          finalMedia.push(mainImgProcessed);\r\n        }\r\n      }\r\n      \r\n      if (finalMedia.length > 0) {\r\n        payload.media = finalMedia;\r\n      }\r\n      \r\n      // Also add mainProductImage as separate field for easier access\r\n      // Use featured image from imageUrls if available\r\n      const mainImage = formData.imageUrls.length > 0 && mainImageMapping.length > formData.featuredImageIndex\r\n        ? mainImageMapping[formData.featuredImageIndex]\r\n        : (mainImageMapping.length > 0 ? mainImageMapping[0] : formData.mainProductImage);\r\n      if (mainImage) {\r\n        payload.mainProductImage = mainImage;\r\n      }\r\n\r\n      // Add labels\r\n      payload.labels = (formData.labels || [])\r\n        .filter((label) => label.value && label.value.trim() !== '')\r\n        .map((label) => ({\r\n          type: label.type,\r\n          value: label.value.trim(),\r\n          position: label.position,\r\n          color: label.color || null,\r\n        }));\r\n\r\n      console.log(' [ADMIN] Sending payload:', JSON.stringify(payload, null, 2));\r\n      \r\n      if (isEditMode && productId) {\r\n        // Update existing product\r\n        const product = await apiClient.put(`/api/v1/admin/products/${productId}`, payload);\r\n        console.log(' [ADMIN] Product updated:', product);\r\n        const baseMessage = '  !';\r\n        const extra = creationMessages.length ? `\\n\\n${creationMessages.join('\\n')}` : '';\r\n        alert(`${baseMessage}${extra}`);\r\n      } else {\r\n        // Create new product\r\n        const product = await apiClient.post('/api/v1/admin/products', payload);\r\n        console.log(' [ADMIN] Product created:', product);\r\n        const baseMessage = '  !';\r\n        const extra = creationMessages.length ? `\\n\\n${creationMessages.join('\\n')}` : '';\r\n        alert(`${baseMessage}${extra}`);\r\n      }\r\n      \r\n      router.push('/admin/products');\r\n    } catch (err: any) {\r\n      console.error(' [ADMIN] Error saving product:', err);\r\n      \r\n      // Extract error message from API response\r\n      let errorMessage = isEditMode ? '  ' : '  ';\r\n      \r\n      // Try different error response formats\r\n      if (err?.data?.detail) {\r\n        errorMessage = err.data.detail;\r\n      } else if (err?.response?.data?.detail) {\r\n        errorMessage = err.response.data.detail;\r\n      } else if (err?.message) {\r\n        // If error message contains HTML, try to extract meaningful text\r\n        if (err.message.includes('<!DOCTYPE') || err.message.includes('<html')) {\r\n          // Try to extract MongoDB error from HTML\r\n          const mongoErrorMatch = err.message.match(/MongoServerError[^<]+/);\r\n          if (mongoErrorMatch) {\r\n            errorMessage = `  : ${mongoErrorMatch[0]}`;\r\n          } else {\r\n            errorMessage = '  : SKU-      :';\r\n          }\r\n        } else {\r\n          errorMessage = err.message;\r\n        }\r\n      }\r\n      \r\n      // Error logged to console\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (isLoading || loadingProduct) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4\"></div>\r\n          <p className=\"text-gray-600\">{loadingProduct ? t('admin.products.add.loadingProduct') : t('admin.products.add.loading')}</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!isLoggedIn || !isAdmin) {\r\n    return null;\r\n  }\r\n\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 py-8\">\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        {/* Main Content */}\r\n        <div>\r\n          <PageHeader isEditMode={isEditMode} />\r\n\r\n          <Card className=\"p-6 pb-24 sm:pb-24\">\r\n          <form onSubmit={handleSubmit} className=\"space-y-14\">\r\n            {/* Basic Information */}\r\n            <BasicInformation\r\n              productType={productType}\r\n              setProductType={setProductType}\r\n              title={formData.title}\r\n              slug={formData.slug}\r\n              descriptionHtml={formData.descriptionHtml}\r\n              onTitleChange={handleTitleChange}\r\n              onSlugChange={(e) => setFormData((prev) => ({ ...prev, slug: e.target.value }))}\r\n              onDescriptionChange={(e) => setFormData((prev) => ({ ...prev, descriptionHtml: e.target.value }))}\r\n            />\r\n\r\n            {/* Product Images */}\r\n            <ProductImages\r\n              imageUrls={formData.imageUrls}\r\n              featuredImageIndex={formData.featuredImageIndex}\r\n              imageUploadLoading={imageUploadLoading}\r\n              imageUploadError={imageUploadError}\r\n              fileInputRef={fileInputRef}\r\n              onUploadImages={handleUploadImages}\r\n              onRemoveImage={removeImageUrl}\r\n              onSetFeaturedImage={setFeaturedImage}\r\n            />\r\n\r\n            {/* Categories & Brands */}\r\n            <CategoriesBrands\r\n              categories={categories}\r\n              brands={brands}\r\n              categoryIds={formData.categoryIds}\r\n              brandIds={formData.brandIds}\r\n              categoriesExpanded={categoriesExpanded}\r\n              brandsExpanded={brandsExpanded}\r\n              useNewCategory={useNewCategory}\r\n              useNewBrand={useNewBrand}\r\n              newCategoryName={newCategoryName}\r\n              newBrandName={newBrandName}\r\n              onCategoriesExpandedChange={setCategoriesExpanded}\r\n              onBrandsExpandedChange={setBrandsExpanded}\r\n              onUseNewCategoryChange={setUseNewCategory}\r\n              onUseNewBrandChange={setUseNewBrand}\r\n              onNewCategoryNameChange={setNewCategoryName}\r\n              onNewBrandNameChange={setNewBrandName}\r\n              onCategoryIdsChange={(ids) => setFormData((prev) => ({ ...prev, categoryIds: ids }))}\r\n              onBrandIdsChange={(ids) => setFormData((prev) => ({ ...prev, brandIds: ids }))}\r\n              onPrimaryCategoryIdChange={(id) => setFormData((prev) => ({ ...prev, primaryCategoryId: id }))}\r\n              isClothingCategory={isClothingCategory}\r\n              onVariantsUpdate={(updater) => setFormData((prev) => ({ ...prev, variants: updater(prev.variants) }))}\r\n            />\r\n\r\n            {/* Simple Product Fields - Only shown when productType === 'simple' */}\r\n            {productType === 'simple' && (\r\n              <SimpleProductFields\r\n                price={simpleProductData.price}\r\n                compareAtPrice={simpleProductData.compareAtPrice}\r\n                sku={simpleProductData.sku}\r\n                quantity={simpleProductData.quantity}\r\n                defaultCurrency={defaultCurrency}\r\n                onPriceChange={(value) => setSimpleProductData((prev) => ({ ...prev, price: value }))}\r\n                onCompareAtPriceChange={(value) => setSimpleProductData((prev) => ({ ...prev, compareAtPrice: value }))}\r\n                onSkuChange={(value) => setSimpleProductData((prev) => ({ ...prev, sku: value }))}\r\n                onQuantityChange={(value) => setSimpleProductData((prev) => ({ ...prev, quantity: value }))}\r\n              />\r\n            )}\r\n\r\n            {/* Select Attributes for Variants - Only shown when productType === 'variable' */}\r\n            {productType === 'variable' && (\r\n              <AttributesSelection\r\n                attributes={attributes}\r\n                selectedAttributesForVariants={selectedAttributesForVariants}\r\n                selectedAttributeValueIds={selectedAttributeValueIds}\r\n                attributesDropdownOpen={attributesDropdownOpen}\r\n                attributesDropdownRef={attributesDropdownRef}\r\n                onAttributesDropdownToggle={() => setAttributesDropdownOpen(!attributesDropdownOpen)}\r\n                onAttributeToggle={(attributeId, checked) => {\r\n                  const newSet = new Set(selectedAttributesForVariants);\r\n                  if (checked) {\r\n                    newSet.add(attributeId);\r\n                  } else {\r\n                    newSet.delete(attributeId);\r\n                    const newValueIds = { ...selectedAttributeValueIds };\r\n                    delete newValueIds[attributeId];\r\n                    setSelectedAttributeValueIds(newValueIds);\r\n                  }\r\n                  setSelectedAttributesForVariants(newSet);\r\n                }}\r\n                onAttributeRemove={(attributeId) => {\r\n                  const newSet = new Set(selectedAttributesForVariants);\r\n                  newSet.delete(attributeId);\r\n                  const newValueIds = { ...selectedAttributeValueIds };\r\n                  delete newValueIds[attributeId];\r\n                  setSelectedAttributeValueIds(newValueIds);\r\n                  setSelectedAttributesForVariants(newSet);\r\n                }}\r\n              />\r\n            )}\r\n\r\n            {/* New Multi-Attribute Variant Builder - Only shown when productType === 'variable' */}\r\n            {productType === 'variable' &&\r\n              ((isEditMode && (generatedVariants.length > 0 || hasVariantsToLoad)) ||\r\n                selectedAttributesForVariants.size > 0) && (\r\n                <VariantBuilder\r\n                  generatedVariants={generatedVariants}\r\n                  attributes={attributes}\r\n                  selectedAttributesForVariants={selectedAttributesForVariants}\r\n                  isEditMode={isEditMode}\r\n                  hasVariantsToLoad={hasVariantsToLoad}\r\n                  defaultCurrency={defaultCurrency}\r\n                  imageUploadLoading={imageUploadLoading}\r\n                  slug={formData.slug}\r\n                  title={formData.title}\r\n                  variantImageInputRefs={variantImageInputRefs}\r\n                  onVariantUpdate={setGeneratedVariants}\r\n                  onVariantDelete={(variantId) => {\r\n                    setGeneratedVariants((prev) => prev.filter((v) => v.id !== variantId));\r\n                  }}\r\n                  onVariantAdd={() => {\r\n                    const newVariant: GeneratedVariant = {\r\n                      id: `variant-${Date.now()}-${Math.random()}`,\r\n                      selectedValueIds: [],\r\n                      price: '0.00',\r\n                      compareAtPrice: '0.00',\r\n                      stock: '0',\r\n                      sku: 'PROD',\r\n                      image: null,\r\n                    };\r\n                    setGeneratedVariants((prev) => {\r\n                      const updated = [...prev, newVariant];\r\n                      console.log(' [VARIANT BUILDER] New manual variant added:', {\r\n                        newVariantId: newVariant.id,\r\n                        totalVariants: updated.length,\r\n                        manualVariants: updated.filter((v) => v.id !== 'variant-all').length,\r\n                        autoVariants: updated.filter((v) => v.id === 'variant-all').length,\r\n                      });\r\n                      return updated;\r\n                    });\r\n                  }}\r\n                  onApplyToAll={applyToAllVariants}\r\n                  onVariantImageUpload={handleUploadVariantImage}\r\n                  onOpenValueModal={setOpenValueModal}\r\n                  generateSlug={generateSlug}\r\n                />\r\n              )}\r\n\r\n            {/* Product Labels */}\r\n            <ProductLabels\r\n              labels={formData.labels}\r\n              onAddLabel={addLabel}\r\n              onRemoveLabel={removeLabel}\r\n              onUpdateLabel={updateLabel}\r\n            />\r\n\r\n            {/* Publishing */}\r\n            <Publishing\r\n              featured={formData.featured}\r\n              onFeaturedChange={(featured) => setFormData((prev) => ({ ...prev, featured }))}\r\n            />\r\n\r\n            {/* Actions - Sticky */}\r\n            <FormActions loading={loading} isEditMode={isEditMode} />\r\n          </form>\r\n        </Card>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Value Selection Modal */}\r\n      {openValueModal && (\r\n        <ValueSelectionModal\r\n          openValueModal={openValueModal}\r\n          variant={generatedVariants.find((v) => v.id === openValueModal.variantId)}\r\n          attribute={attributes.find((a) => a.id === openValueModal.attributeId)}\r\n          selectedAttributeValueIds={selectedAttributeValueIds}\r\n          onClose={() => setOpenValueModal(null)}\r\n          onVariantUpdate={setGeneratedVariants}\r\n          onAttributeValueIdsUpdate={setSelectedAttributeValueIds}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function AddProductPage() {\r\n  return (\r\n    <Suspense fallback={\r\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto mb-4\"></div>\r\n          <p className=\"text-sm text-gray-600\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    }>\r\n      <AddProductPageContent />\r\n    </Suspense>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}