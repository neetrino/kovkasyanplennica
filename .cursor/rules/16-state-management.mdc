---
description: ÕÕ«Õ³Õ¡Õ¯Õ« Õ¯Õ¡Õ¼Õ¡Õ¾Õ¡Ö€Õ´Õ¡Õ¶ Õ¯Õ¡Õ¶Õ¸Õ¶Õ¶Õ¥Ö€Ö‰ Server state, Client state, Form state, URL stateÖ‰
globs: ["**/*.tsx", "**/hooks/**", "**/store/**", "**/features/**"]
alwaysApply: false
---

# ÕÔ»ÕƒÔ±Ô¿Ô» Ô¿Ô±ÕŒÔ±ÕÔ±ÕÕ„Ô±Õ† Ô¿Ô±Õ†ÕˆÕ†Õ†ÔµÕ

> ÕƒÕ«Õ·Õ¿ Õ¾Õ«Õ³Õ¡Õ¯ Õ³Õ«Õ·Õ¿ Õ¿Õ¥Õ²Õ¸Ö‚Õ´Ö‰ Ô±Õ´Õ¥Õ¶ Õ«Õ¶Õ¹ ÕºÕ¥Õ¿Ö„ Õ¹Õ§ ÕºÕ¡Õ°Õ¥Õ¬ Õ£Õ¬Õ¸Õ¢Õ¡Õ¬ store-Õ¸Ö‚Õ´Ö‰

---

## ğŸ¯ Õ€Ô»Õ„Õ†Ô±Ô¿Ô±Õ† ÕÔ¿Ô¶Ô²ÕˆÕ’Õ†Õ”Õ†ÔµÕ

1. **Õ†Õ¾Õ¡Õ¦Õ¡Õ£Õ¸Ö‚ÕµÕ¶ Õ¾Õ«Õ³Õ¡Õ¯** â€” derive Õ¥Ö€Õ¢ Õ°Õ¶Õ¡Ö€Õ¡Õ¾Õ¸Ö€ Õ§
2. **Colocation** â€” Õ¾Õ«Õ³Õ¡Õ¯Õ¨ Õ´Õ¸Õ¿ Ö…Õ£Õ¿Õ¡Õ£Õ¸Ö€Õ®Õ´Õ¡Õ¶Õ¨
3. **ÕÕ«ÕºÕ¥Ö€Õ« Õ¢Õ¡ÕªÕ¡Õ¶Õ¸Ö‚Õ´** â€” server state â‰  client state
4. **Single Source of Truth** â€” Õ´Õ¥Õ¯ Õ³Õ·Õ´Õ¡Ö€Õ¿Õ¸Ö‚Õ©ÕµÕ¡Õ¶ Õ¡Õ²Õ¢ÕµÕ¸Ö‚Ö€

---

## ğŸ“Š ÕÔ»ÕƒÔ±Ô¿Ô» ÕÔ»ÕŠÔµÕ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ÕÔ»ÕƒÔ±Ô¿Ô» ÕÔ»ÕŠÔµÕ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SERVER STATE   â”‚  CLIENT STATE   â”‚     FORM STATE          â”‚
â”‚                 â”‚                 â”‚                         â”‚
â”‚  API-Õ«Ö Õ¿Õ¾ÕµÕ¡Õ¬Õ¶Õ¥Ö€â”‚  UI Õ¾Õ«Õ³Õ¡Õ¯       â”‚  ÕÖ‡Õ« Õ¿Õ¾ÕµÕ¡Õ¬Õ¶Õ¥Ö€          â”‚
â”‚  React Query    â”‚  Zustand        â”‚  React Hook Form        â”‚
â”‚  SWR            â”‚  Context        â”‚  Formik                 â”‚
â”‚                 â”‚  useState       â”‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       URL STATE                             â”‚
â”‚                                                             â”‚
â”‚  Õ–Õ«Õ¬Õ¿Ö€Õ¥Ö€, ÕºÕ¡Õ£Õ«Õ¶Õ¡ÖÕ«Õ¡, Õ´Õ¸Õ¤Õ¡Õ¬ ÕºÕ¡Õ¿Õ¸Ö‚Õ°Õ¡Õ¶Õ¶Õ¥Ö€                    â”‚
â”‚  useSearchParams, nuqs                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ SERVER STATE (React Query)

### ÔµÖ€Õ¢ Ö…Õ£Õ¿Õ¡Õ£Õ¸Ö€Õ®Õ¥Õ¬

- API/backend-Õ«Ö Õ¿Õ¾ÕµÕ¡Õ¬Õ¶Õ¥Ö€
- ÕÕ¾ÕµÕ¡Õ¬Õ¶Õ¥Ö€, Õ¸Ö€Õ¸Õ¶Ö„ ÕºÕ¥Õ¿Ö„ Õ§ cache Õ¡Õ¶Õ¥Õ¬
- ÕÕ¾ÕµÕ¡Õ¬Õ¶Õ¥Ö€, Õ¸Ö€Õ¸Õ¶Ö„ Õ½Õ«Õ¶Õ­Ö€Õ¸Õ¶Õ¡ÖÕ¾Õ¸Ö‚Õ´ Õ¥Õ¶ tab-Õ¥Ö€Õ« Õ´Õ«Õ»Ö‡

### Õ€Õ«Õ´Õ¶Õ¡Õ¯Õ¡Õ¶ Õ¯Õ¡Ö€Õ£Õ¡Õ¾Õ¸Ö€Õ¸Ö‚Õ´

```typescript
// lib/query-client.ts
import { QueryClient } from '@tanstack/react-query';

export const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 1000 * 60,        // 1 Ö€Õ¸ÕºÕ¥ â€” Õ¿Õ¾ÕµÕ¡Õ¬Õ¶Õ¥Ö€Õ¨ Õ©Õ¡Ö€Õ´
      gcTime: 1000 * 60 * 5,       // 5 Ö€Õ¸ÕºÕ¥ â€” ÕºÕ¡Õ°Õ¥Õ¬ cache-Õ¸Ö‚Õ´
      retry: 1,                    // 1 retry Õ½Õ­Õ¡Õ¬Õ« Õ¤Õ¥ÕºÖ„Õ¸Ö‚Õ´
      refetchOnWindowFocus: false, // Õ–Õ¸Õ¯Õ¸Ö‚Õ½Õ« Õ¤Õ¥ÕºÖ„Õ¸Ö‚Õ´ refetch Õ¹Õ¡Õ¶Õ¥Õ¬
    },
    mutations: {
      retry: 0,
    },
  },
});
```

### Query Hooks

```typescript
// features/products/hooks/useProducts.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';
import { productApi } from '../api/productApi';
import type { ProductFilters, CreateProductDTO } from '../types';

// Query Keys â€” Õ¯Õ¥Õ¶Õ¿Ö€Õ¸Õ¶Õ¡ÖÕ¾Õ¡Õ®
export const productKeys = {
  all: ['products'] as const,
  lists: () => [...productKeys.all, 'list'] as const,
  list: (filters: ProductFilters) => [...productKeys.lists(), filters] as const,
  details: () => [...productKeys.all, 'detail'] as const,
  detail: (id: string) => [...productKeys.details(), id] as const,
};

// Õ‘Õ¡Õ¶Õ¯Õ« Õ½Õ¿Õ¡ÖÕ¸Ö‚Õ´
export function useProducts(filters: ProductFilters) {
  return useQuery({
    queryKey: productKeys.list(filters),
    queryFn: () => productApi.getList(filters),
    // Placeholder Õ´Õ«Õ¶Õ¹Ö‡ Õ¢Õ¥Õ¼Õ¶Õ¸Ö‚Õ´Õ¨
    placeholderData: (previousData) => previousData,
  });
}

// Õ„Õ¥Õ¯ Õ¡ÕºÖ€Õ¡Õ¶Ö„Õ« Õ½Õ¿Õ¡ÖÕ¸Ö‚Õ´
export function useProduct(id: string) {
  return useQuery({
    queryKey: productKeys.detail(id),
    queryFn: () => productApi.getById(id),
    enabled: !!id, // Õ‰Õ£Õ¸Ö€Õ®Õ¡Ö€Õ¯Õ¥Õ¬, Õ¥Õ©Õ¥ id Õ¹Õ¯Õ¡
  });
}

// Ô±ÕºÖ€Õ¡Õ¶Ö„Õ« Õ½Õ¿Õ¥Õ²Õ®Õ¸Ö‚Õ´
export function useCreateProduct() {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: (data: CreateProductDTO) => productApi.create(data),
    onSuccess: () => {
      // Ô»Õ¶Õ¾Õ¡Õ¬Õ«Õ¤Õ¡ÖÕ¶Õ¸Ö‚Õ´ Õ¥Õ¶Ö„ ÖÕ¡Õ¶Õ¯Õ¥Ö€Õ¨
      queryClient.invalidateQueries({ queryKey: productKeys.lists() });
    },
  });
}

// Ô±ÕºÖ€Õ¡Õ¶Ö„Õ« Õ©Õ¡Ö€Õ´Õ¡ÖÕ¸Ö‚Õ´
export function useUpdateProduct() {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: ({ id, data }: { id: string; data: UpdateProductDTO }) => 
      productApi.update(id, data),
    onSuccess: (updatedProduct) => {
      // Ô¹Õ¡Ö€Õ´Õ¡ÖÕ¶Õ¸Ö‚Õ´ Õ¥Õ¶Ö„ Õ¤Õ¥Õ¿Õ¡Õ¬ Õ§Õ»Õ« cache-Õ¨
      queryClient.setQueryData(
        productKeys.detail(updatedProduct.id),
        updatedProduct
      );
      // Ô»Õ¶Õ¾Õ¡Õ¬Õ«Õ¤Õ¡ÖÕ¶Õ¸Ö‚Õ´ Õ¥Õ¶Ö„ ÖÕ¡Õ¶Õ¯Õ¥Ö€Õ¨
      queryClient.invalidateQueries({ queryKey: productKeys.lists() });
    },
  });
}

// Õ‹Õ¶Õ»Õ¸Ö‚Õ´
export function useDeleteProduct() {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: (id: string) => productApi.delete(id),
    onSuccess: (_, deletedId) => {
      // Õ‹Õ¶Õ»Õ¸Ö‚Õ´ cache-Õ«Ö
      queryClient.removeQueries({ queryKey: productKeys.detail(deletedId) });
      // Ô»Õ¶Õ¾Õ¡Õ¬Õ«Õ¤Õ¡ÖÕ¶Õ¸Ö‚Õ´ Õ¥Õ¶Ö„ ÖÕ¡Õ¶Õ¯Õ¥Ö€Õ¨
      queryClient.invalidateQueries({ queryKey: productKeys.lists() });
    },
  });
}
```

### Optimistic Updates

```typescript
export function useToggleFavorite() {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: (productId: string) => productApi.toggleFavorite(productId),
    
    // Optimistic update
    onMutate: async (productId) => {
      // Õ‰Õ¥Õ²Õ¡Ö€Õ¯Õ¸Ö‚Õ´ Õ¥Õ¶Ö„ Õ¨Õ¶Õ©Õ¡ÖÕ«Õ¯ Õ°Õ¡Ö€ÖÕ¸Ö‚Õ´Õ¶Õ¥Ö€Õ¨
      await queryClient.cancelQueries({ queryKey: productKeys.detail(productId) });
      
      // ÕŠÕ¡Õ°ÕºÕ¡Õ¶Õ¸Ö‚Õ´ Õ¥Õ¶Ö„ Õ¶Õ¡Õ­Õ¸Ö€Õ¤ Õ¡Ö€ÕªÕ¥Ö„Õ¨
      const previousProduct = queryClient.getQueryData(
        productKeys.detail(productId)
      );
      
      // Õ•ÕºÕ¿Õ«Õ´Õ«Õ½Õ¿Õ«Õ¯ Õ©Õ¡Ö€Õ´Õ¡ÖÕ¸Ö‚Õ´
      queryClient.setQueryData(
        productKeys.detail(productId),
        (old: Product) => ({
          ...old,
          isFavorite: !old.isFavorite,
        })
      );
      
      return { previousProduct };
    },
    
    // Õ€Õ¥Õ¿Õ¡Ö€Õ¯Õ¸Ö‚Õ´ Õ½Õ­Õ¡Õ¬Õ« Õ¤Õ¥ÕºÖ„Õ¸Ö‚Õ´
    onError: (err, productId, context) => {
      queryClient.setQueryData(
        productKeys.detail(productId),
        context?.previousProduct
      );
    },
    
    // ÕÕ«Õ¶Õ­Ö€Õ¸Õ¶Õ¡ÖÕ¸Ö‚Õ´ mutation-Õ«Ö Õ°Õ¥Õ¿Õ¸
    onSettled: (_, __, productId) => {
      queryClient.invalidateQueries({ queryKey: productKeys.detail(productId) });
    },
  });
}
```

---

## ğŸ  CLIENT STATE (Zustand)

### ÔµÖ€Õ¢ Ö…Õ£Õ¿Õ¡Õ£Õ¸Ö€Õ®Õ¥Õ¬

- UI Õ¾Õ«Õ³Õ¡Õ¯ (Õ©Õ¥Õ´Õ¡, sidebar Õ¢Õ¡Ö)
- Ô³Õ¶Õ´Õ¡Õ¶ Õ¦Õ¡Õ´Õ¢ÕµÕ¸Ö‚Õ²
- Ô±Õ¸Ö‚Õ¿Õ¸Ö€Õ«Õ¦Õ¡ÖÕ¾Õ¡Õ® Ö…Õ£Õ¿Õ¡Õ¿Õ«Ö€Õ¸Õ» Õ¿Õ¾ÕµÕ¡Õ¬Õ¶Õ¥Ö€
- ÕÕ«Õ³Õ¡Õ¯, Õ¸Ö€Õ¨ Õ½Õ¥Ö€Õ¾Õ¥Ö€Õ«Ö Õ‰Ô·

### Õ€Õ«Õ´Õ¶Õ¡Õ¯Õ¡Õ¶ store

```typescript
// store/useCartStore.ts
import { create } from 'zustand';
import { persist, createJSONStorage } from 'zustand/middleware';
import { immer } from 'zustand/middleware/immer';

interface CartItem {
  productId: string;
  name: string;
  price: number;
  quantity: number;
}

interface CartState {
  items: CartItem[];
  isOpen: boolean;
}

interface CartActions {
  addItem: (item: Omit<CartItem, 'quantity'>) => void;
  removeItem: (productId: string) => void;
  updateQuantity: (productId: string, quantity: number) => void;
  clearCart: () => void;
  toggleCart: () => void;
}

export const useCartStore = create<CartState & CartActions>()(
  persist(
    immer((set) => ({
      // State
      items: [],
      isOpen: false,

      // Actions
      addItem: (item) =>
        set((state) => {
          const existingItem = state.items.find(
            (i) => i.productId === item.productId
          );
          
          if (existingItem) {
            existingItem.quantity += 1;
          } else {
            state.items.push({ ...item, quantity: 1 });
          }
        }),

      removeItem: (productId) =>
        set((state) => {
          state.items = state.items.filter((i) => i.productId !== productId);
        }),

      updateQuantity: (productId, quantity) =>
        set((state) => {
          const item = state.items.find((i) => i.productId === productId);
          if (item) {
            if (quantity <= 0) {
              state.items = state.items.filter((i) => i.productId !== productId);
            } else {
              item.quantity = quantity;
            }
          }
        }),

      clearCart: () =>
        set((state) => {
          state.items = [];
        }),

      toggleCart: () =>
        set((state) => {
          state.isOpen = !state.isOpen;
        }),
    })),
    {
      name: 'cart-storage',
      storage: createJSONStorage(() => localStorage),
      partialize: (state) => ({ items: state.items }), // Õ„Õ«Õ¡ÕµÕ¶ items storage-Õ¸Ö‚Õ´
    }
  )
);

// ÕÕ¥Õ¬Õ¥Õ¯Õ¿Õ¸Ö€Õ¶Õ¥Ö€ (Õ°Õ¡Õ·Õ¾Õ¡Ö€Õ¯Õ¾Õ¡Õ® Õ¡Ö€ÕªÕ¥Ö„Õ¶Õ¥Ö€)
export const useCartTotal = () =>
  useCartStore((state) =>
    state.items.reduce((sum, item) => sum + item.price * item.quantity, 0)
  );

export const useCartItemCount = () =>
  useCartStore((state) =>
    state.items.reduce((sum, item) => sum + item.quantity, 0)
  );
```

### Õ•Õ£Õ¿Õ¡Õ£Õ¸Ö€Õ®Õ¸Ö‚Õ´

```tsx
// components/CartButton.tsx
'use client';

import { useCartStore, useCartItemCount } from '@/store/useCartStore';

export function CartButton() {
  const toggleCart = useCartStore((state) => state.toggleCart);
  const itemCount = useCartItemCount();

  return (
    <button onClick={toggleCart} className="relative">
      <ShoppingCartIcon />
      {itemCount > 0 && (
        <span className="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5">
          {itemCount}
        </span>
      )}
    </button>
  );
}
```

### Store UI Õ¾Õ«Õ³Õ¡Õ¯Õ« Õ°Õ¡Õ´Õ¡Ö€

```typescript
// store/useUIStore.ts
import { create } from 'zustand';

interface UIState {
  sidebarOpen: boolean;
  theme: 'light' | 'dark' | 'system';
  modalStack: string[];
}

interface UIActions {
  toggleSidebar: () => void;
  setTheme: (theme: UIState['theme']) => void;
  openModal: (modalId: string) => void;
  closeModal: (modalId?: string) => void;
}

export const useUIStore = create<UIState & UIActions>((set) => ({
  sidebarOpen: true,
  theme: 'system',
  modalStack: [],

  toggleSidebar: () =>
    set((state) => ({ sidebarOpen: !state.sidebarOpen })),

  setTheme: (theme) => set({ theme }),

  openModal: (modalId) =>
    set((state) => ({ modalStack: [...state.modalStack, modalId] })),

  closeModal: (modalId) =>
    set((state) => ({
      modalStack: modalId
        ? state.modalStack.filter((id) => id !== modalId)
        : state.modalStack.slice(0, -1),
    })),
}));
```

---

## ğŸ“ FORM STATE (React Hook Form)

### ÔµÖ€Õ¢ Ö…Õ£Õ¿Õ¡Õ£Õ¸Ö€Õ®Õ¥Õ¬

- Õ‘Õ¡Õ¶Õ¯Õ¡ÖÕ¡Õ® Õ±Ö‡
- ÕÕ¡Õ¬Õ«Õ¤Õ¡ÖÕ«Õ¡
- ÕÖ‡Õ¥Ö€Õ« Õ¢Õ¡Ö€Õ¤ Õ¬Õ¸Õ£Õ«Õ¯Õ¡

### Õ€Õ«Õ´Õ¶Õ¡Õ¯Õ¡Õ¶ Õ±Ö‡

```tsx
// components/ProductForm.tsx
'use client';

import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';

const productSchema = z.object({
  name: z.string().min(1, 'Ô±Õ¶Õ¸Ö‚Õ¶Õ¨ ÕºÕ¡Ö€Õ¿Õ¡Õ¤Õ«Ö€ Õ§').max(255),
  description: z.string().max(5000).optional(),
  price: z.number().min(0, 'Ô³Õ«Õ¶Õ¨ Õ¹Õ« Õ¯Õ¡Ö€Õ¸Õ² Õ¢Õ¡ÖÕ¡Õ½Õ¡Õ¯Õ¡Õ¶ Õ¬Õ«Õ¶Õ¥Õ¬'),
  categoryId: z.string().uuid('Ô¸Õ¶Õ¿Ö€Õ«Õ›Ö€ Õ¯Õ¡Õ¿Õ¥Õ£Õ¸Ö€Õ«Õ¡'),
  isActive: z.boolean().default(true),
});

type ProductFormData = z.infer<typeof productSchema>;

interface Props {
  defaultValues?: Partial<ProductFormData>;
  onSubmit: (data: ProductFormData) => Promise<void>;
}

export function ProductForm({ defaultValues, onSubmit }: Props) {
  const {
    register,
    handleSubmit,
    formState: { errors, isSubmitting },
    reset,
  } = useForm<ProductFormData>({
    resolver: zodResolver(productSchema),
    defaultValues: {
      name: '',
      description: '',
      price: 0,
      isActive: true,
      ...defaultValues,
    },
  });

  const onSubmitHandler = async (data: ProductFormData) => {
    try {
      await onSubmit(data);
      reset();
    } catch (error) {
      // ÕÕ­Õ¡Õ¬Õ¨ Õ´Õ·Õ¡Õ¯Õ¾Õ¸Ö‚Õ´ Õ§ Õ¾Õ¥Ö€Ö‡Õ¸Ö‚Õ´
    }
  };

  return (
    <form onSubmit={handleSubmit(onSubmitHandler)} className="space-y-4">
      <div>
        <label htmlFor="name" className="block text-sm font-medium">
          Ô±Õ¶Õ¸Ö‚Õ¶
        </label>
        <input
          {...register('name')}
          id="name"
          className="mt-1 block w-full rounded-md border p-2"
        />
        {errors.name && (
          <p className="mt-1 text-sm text-red-600">{errors.name.message}</p>
        )}
      </div>

      <div>
        <label htmlFor="price" className="block text-sm font-medium">
          Ô³Õ«Õ¶
        </label>
        <input
          {...register('price', { valueAsNumber: true })}
          id="price"
          type="number"
          className="mt-1 block w-full rounded-md border p-2"
        />
        {errors.price && (
          <p className="mt-1 text-sm text-red-600">{errors.price.message}</p>
        )}
      </div>

      <button
        type="submit"
        disabled={isSubmitting}
        className="w-full rounded-md bg-primary-600 py-2 text-white disabled:opacity-50"
      >
        {isSubmitting ? 'ÕŠÕ¡Õ°ÕºÕ¡Õ¶Õ¾Õ¸Ö‚Õ´ Õ§...' : 'ÕŠÕ¡Õ°ÕºÕ¡Õ¶Õ¥Õ¬'}
      </button>
    </form>
  );
}
```

### Form Ñ React Query

```tsx
// ÕÖ‡Õ« Õ«Õ¶Õ¿Õ¥Õ£Ö€Õ¡ÖÕ«Õ¡ mutation-Õ« Õ°Õ¥Õ¿
export function CreateProductForm() {
  const createProduct = useCreateProduct();
  
  const handleSubmit = async (data: ProductFormData) => {
    await createProduct.mutateAsync(data);
  };
  
  return (
    <ProductForm 
      onSubmit={handleSubmit}
      // Õ‘Õ¸Ö‚ÖÕ¡Õ¤Ö€Õ¸Ö‚Õ´ Õ¥Õ¶Ö„ Õ½Õ¥Ö€Õ¾Õ¥Ö€Õ«Ö Õ½Õ­Õ¡Õ¬Õ¨
      serverError={createProduct.error?.message}
    />
  );
}
```

---

## ğŸ”— URL STATE

### ÔµÖ€Õ¢ Ö…Õ£Õ¿Õ¡Õ£Õ¸Ö€Õ®Õ¥Õ¬

- Õ–Õ«Õ¬Õ¿Ö€Õ¥Ö€ Ö‡ Õ½Õ¸Ö€Õ¿Õ¡Õ¾Õ¸Ö€Õ¸Ö‚Õ´
- ÕŠÕ¡Õ£Õ«Õ¶Õ¡ÖÕ«Õ¡
- ÕÕ«Õ³Õ¡Õ¯, Õ¸Ö€Õ¨ ÕºÕ¥Õ¿Ö„ Õ§ URL-Õ¸Ö‚Õ´ ÕºÕ¡Õ°ÕºÕ¡Õ¶Õ¾Õ«
- Shareable Õ¾Õ«Õ³Õ¡Õ¯

### useSearchParams (Next.js)

```tsx
// features/products/components/ProductFilters.tsx
'use client';

import { useRouter, useSearchParams, usePathname } from 'next/navigation';
import { useCallback } from 'react';

export function ProductFilters() {
  const router = useRouter();
  const pathname = usePathname();
  const searchParams = useSearchParams();
  
  // Ô¸Õ¶Õ©Õ¡ÖÕ«Õ¯ Õ¡Ö€ÕªÕ¥Ö„Õ¶Õ¥Ö€ URL-Õ«Ö
  const category = searchParams.get('category') ?? '';
  const sort = searchParams.get('sort') ?? 'createdAt';
  const page = Number(searchParams.get('page')) || 1;

  // URL-Õ« Õ©Õ¡Ö€Õ´Õ¡ÖÕ¸Ö‚Õ´
  const updateFilters = useCallback(
    (updates: Record<string, string | number | null>) => {
      const params = new URLSearchParams(searchParams.toString());
      
      Object.entries(updates).forEach(([key, value]) => {
        if (value === null || value === '') {
          params.delete(key);
        } else {
          params.set(key, String(value));
        }
      });
      
      // Ô¹Õ¡Ö€Õ´Õ¡ÖÕ¶Õ¸Ö‚Õ´ Õ¥Õ¶Ö„ Õ§Õ»Õ¨ Ö†Õ«Õ¬Õ¿Ö€Õ¥Ö€Õ« ÖƒÕ¸ÖƒÕ¸Õ­Õ¸Ö‚Õ©ÕµÕ¡Õ¶ Õ¤Õ¥ÕºÖ„Õ¸Ö‚Õ´
      if (!('page' in updates)) {
        params.delete('page');
      }
      
      router.push(`${pathname}?${params.toString()}`);
    },
    [router, pathname, searchParams]
  );

  return (
    <div className="flex gap-4">
      <select
        value={category}
        onChange={(e) => updateFilters({ category: e.target.value })}
      >
        <option value="">Ô²Õ¸Õ¬Õ¸Ö€ Õ¯Õ¡Õ¿Õ¥Õ£Õ¸Ö€Õ«Õ¡Õ¶Õ¥Ö€Õ¨</option>
        <option value="electronics">Ô·Õ¬Õ¥Õ¯Õ¿Ö€Õ¸Õ¶Õ«Õ¯Õ¡</option>
        <option value="clothing">Õ€Õ¡Õ£Õ¸Ö‚Õ½Õ¿</option>
      </select>

      <select
        value={sort}
        onChange={(e) => updateFilters({ sort: e.target.value })}
      >
        <option value="createdAt">Ô¸Õ½Õ¿ Õ¡Õ´Õ½Õ¡Õ©Õ¾Õ«</option>
        <option value="price">Ô¸Õ½Õ¿ Õ£Õ¶Õ«</option>
        <option value="name">Ô¸Õ½Õ¿ Õ¡Õ¶Õ¾Õ¡Õ¶</option>
      </select>
    </div>
  );
}
```

### nuqs (Type-safe URL state)

```tsx
// nuqs-Õ¸Õ¾ Õ¡Õ¾Õ¥Õ¬Õ« Õ°Õ¡Ö€Õ´Õ¡Ö€ Õ¥Õ²Õ¡Õ¶Õ¡Õ¯
import { useQueryState, parseAsInteger, parseAsString } from 'nuqs';

export function ProductFilters() {
  const [category, setCategory] = useQueryState('category');
  const [sort, setSort] = useQueryState('sort', parseAsString.withDefault('createdAt'));
  const [page, setPage] = useQueryState('page', parseAsInteger.withDefault(1));

  return (
    <div className="flex gap-4">
      <select
        value={category ?? ''}
        onChange={(e) => setCategory(e.target.value || null)}
      >
        <option value="">Ô²Õ¸Õ¬Õ¸Ö€ Õ¯Õ¡Õ¿Õ¥Õ£Õ¸Ö€Õ«Õ¡Õ¶Õ¥Ö€Õ¨</option>
        <option value="electronics">Ô·Õ¬Õ¥Õ¯Õ¿Ö€Õ¸Õ¶Õ«Õ¯Õ¡</option>
      </select>
      
      <Pagination
        currentPage={page}
        onPageChange={setPage}
      />
    </div>
  );
}
```

---

## ğŸš« Ô±Õ†ÕÔ»ÕŠÔ±Ô¹ÔµÕÕ†ÔµÕ

### âŒ Õ„Õ« Õ¡Ö€Õ¡

```tsx
// âŒ Server data Õ£Õ¬Õ¸Õ¢Õ¡Õ¬ store-Õ¸Ö‚Õ´
const useStore = create((set) => ({
  products: [],
  fetchProducts: async () => {
    const products = await api.getProducts();
    set({ products });
  },
}));

// âŒ ÕÕ«Õ³Õ¡Õ¯Õ« Õ¯Ö€Õ¯Õ¶Ö…Ö€Õ«Õ¶Õ¡Õ¯Õ¸Ö‚Õ´
const [localUser, setLocalUser] = useState(user); // user Õ¡Ö€Õ¤Õ¥Õ¶ Õ¯Õ¡Ö‰

// âŒ Derived state useState-Õ¸Ö‚Õ´
const [total, setTotal] = useState(0);
useEffect(() => {
  setTotal(items.reduce((sum, i) => sum + i.price, 0));
}, [items]);

// âŒ Õ‰Õ¡ÖƒÕ«Ö Õ·Õ¡Õ¿ Õ£Õ¬Õ¸Õ¢Õ¡Õ¬ store-Õ¸Ö‚Õ´
const useStore = create((set) => ({
  user: null,
  products: [],
  orders: [],
  cart: [],
  notifications: [],
  // ... Õ¡Õ´Õ¥Õ¶ Õ«Õ¶Õ¹ Õ´Õ« Õ¿Õ¥Õ²Õ¸Ö‚Õ´
}));
```

### âœ… Ô±Ö€Õ¡

```tsx
// âœ… Server data React Query-Õ¸Õ¾
const { data: products } = useProducts();

// âœ… Õ•Õ£Õ¿Õ¡Õ£Õ¸Ö€Õ®Õ«Õ›Ö€ Õ¡Õ²Õ¢ÕµÕ¸Ö‚Ö€Õ« Õ¿Õ¾ÕµÕ¡Õ¬Õ¶Õ¥Ö€Õ¨
<UserProfile user={user} />

// âœ… Derive state
const total = items.reduce((sum, i) => sum + i.price, 0);

// âœ… Ô²Õ¡ÕªÕ¡Õ¶Õ«Õ›Ö€ store-Õ¥Ö€Õ¨ Õ¨Õ½Õ¿ Õ¤Õ¸Õ´Õ¥Õ¶Õ¶Õ¥Ö€Õ«
const useCartStore = create(...);
const useUIStore = create(...);
const useAuthStore = create(...);
```

---

## ğŸ“‹ ÕÔ»ÕƒÔ±Ô¿Ô» ÕÔ»ÕŠÔ» Ô¸Õ†ÕÕÕˆÕ’Ô¹Õ…ÕˆÕ’Õ†

```markdown
## ÕˆÖ€Õ¸Õ·Õ¸Ö‚Õ´Õ¶Õ¥Ö€Õ« Õ®Õ¡Õ¼

ÕÕ¾ÕµÕ¡Õ¬Õ¶Õ¥Ö€ Õ½Õ¥Ö€Õ¾Õ¥Ö€Õ«ÖÕ
â”œâ”€â”€ Ô±ÕµÕ¸ â†’ React Query / SWR
â””â”€â”€ ÕˆÕ¹
    â””â”€â”€ URL-Õ¸Ö‚Õ´ ÕºÕ¥ÕÕ¿Ö„ Õ§
        â”œâ”€â”€ Ô±ÕµÕ¸ â†’ useSearchParams / nuqs
        â””â”€â”€ ÕˆÕ¹
            â””â”€â”€ Ô³Õ¬Õ¸Õ¢Õ¡Õ¬Õ
                â”œâ”€â”€ Ô±ÕµÕ¸ â†’ Zustand
                â””â”€â”€ ÕˆÕ¹
                    â””â”€â”€ ÕÖ‡Õ« Õ¿Õ¾ÕµÕ¡Õ¬Õ¶Õ¥ÕÖ€
                        â”œâ”€â”€ Ô±ÕµÕ¸ â†’ React Hook Form
                        â””â”€â”€ ÕˆÕ¹ â†’ useState
```

---

## ğŸ“‹ CHECKLIST

### Ô¸Õ¶Õ¤Õ°Õ¡Õ¶Õ¸Ö‚Ö€ Õ¯Õ¡Õ¶Õ¸Õ¶Õ¶Õ¥Ö€

- [ ] Server state React Query-Õ¸Ö‚Õ´
- [ ] Client state Zustand-Õ¸Ö‚Õ´ (Õ¥Õ©Õ¥ Õ£Õ¬Õ¸Õ¢Õ¡Õ¬ Õ§ ÕºÕ¥Õ¿Ö„)
- [ ] Form state React Hook Form-Õ¸Ö‚Õ´
- [ ] URL state Ö†Õ«Õ¬Õ¿Ö€Õ¥Ö€/ÕºÕ¡Õ£Õ«Õ¶Õ¡ÖÕ«Õ¡ÕµÕ« Õ°Õ¡Õ´Õ¡Ö€
- [ ] Derive state Õ¯Ö€Õ¯Õ¶Ö…Ö€Õ«Õ¶Õ¡Õ¯Õ´Õ¡Õ¶ ÖƒÕ¸Õ­Õ¡Ö€Õ¥Õ¶
- [ ] ÕÕ¥Õ¬Õ¥Õ¯Õ¿Õ¸Ö€Õ¶Õ¥Ö€ rerender-Õ¶Õ¥Ö€Õ« Ö…ÕºÕ¿Õ«Õ´Õ«Õ¦Õ¡ÖÕ«Õ¡ÕµÕ« Õ°Õ¡Õ´Õ¡Ö€

### React Query

- [ ] Query Keys-Õ¨ Õ¯Õ¥Õ¶Õ¿Ö€Õ¸Õ¶Õ¡ÖÕ¾Õ¡Õ® Õ¥Õ¶
- [ ] staleTime/gcTime Õ¯Õ¡Ö€Õ£Õ¡Õ¾Õ¸Ö€Õ¾Õ¡Õ® Õ¥Õ¶
- [ ] Optimistic updates Õ¸Ö€Õ¿Õ¥Õ² Õ¡Õ¶Õ°Ö€Õ¡ÕªÕ¥Õ·Õ¿ Õ§
- [ ] Error handling Õ¯Õ¡Ö€Õ£Õ¡Õ¾Õ¸Ö€Õ¾Õ¡Õ® Õ§

### Zustand

- [ ] Store-Õ¥Ö€Õ¨ Õ¢Õ¡ÕªÕ¡Õ¶Õ¾Õ¡Õ® Õ¥Õ¶ Õ¨Õ½Õ¿ Õ¤Õ¸Õ´Õ¥Õ¶Õ¶Õ¥Ö€Õ«
- [ ] persist Õ¡Õ¶Õ°Ö€Õ¡ÕªÕ¥Õ·Õ¿ Õ¿Õ¾ÕµÕ¡Õ¬Õ¶Õ¥Ö€Õ« Õ°Õ¡Õ´Õ¡Ö€
- [ ] ÕÕ¥Õ¬Õ¥Õ¯Õ¿Õ¸Ö€Õ¶Õ¥Ö€ granular update-Õ¶Õ¥Ö€Õ« Õ°Õ¡Õ´Õ¡Ö€

---

**ÕÕ¡Ö€Õ¢Õ¥Ö€Õ¡Õ¯.** 1.0
**Ô±Õ´Õ½Õ¡Õ©Õ«Õ¾.** 2026-02-12
